!function(e){t.exports=e()}(function(){return function t(e,i,o){function r(s,l){if(!i[s]){if(!e[s]){var u="function"==typeof n&&n;if(!l&&u)return n(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=i[s]={exports:{}};e[s][0].call(f.exports,function(t){var n=e[s][1][t];return r(n||t)},f,f.exports,t,e,i,o)}return i[s].exports}for(var a="function"==typeof n&&n,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(t,n,i){(function(t){"use strict";function e(){c=!0;for(var t,e,n=f.length;n;){for(e=f,f=[],t=-1;++t<n;)e[t]();n=f.length}c=!1}function i(t){1!==f.push(t)||c||o()}var o,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var a=0,s=new r(e),l=t.document.createTextNode("");s.observe(l,{characterData:!0}),o=function(){l.data=a=++a%2}}else if(t.setImmediate||void 0===t.MessageChannel)o="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var n=t.document.createElement("script");n.onreadystatechange=function(){e(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},t.document.documentElement.appendChild(n)}:function(){setTimeout(e,0)};else{var u=new t.MessageChannel;u.port1.onmessage=e,o=function(){u.port2.postMessage(0)}}var c,f=[];n.exports=i}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";function i(){}function o(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,t!==i&&l(this,t)}function r(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(t,e,n){v(function(){var i;try{i=e(n)}catch(e){return p.reject(t,e)}i===t?p.reject(t,new TypeError("Cannot resolve promise with itself")):p.resolve(t,i)})}function s(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function l(t,e){function n(e){r||(r=!0,p.reject(t,e))}function i(e){r||(r=!0,p.resolve(t,e))}function o(){e(i,n)}var r=!1,a=u(o);"error"===a.status&&n(a.value)}function u(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}function c(t){return t instanceof this?t:p.resolve(new this(i),t)}function f(t){var e=new this(i);return p.reject(e,t)}function d(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,o=!1;if(!n)return this.resolve([]);for(var r=new Array(n),a=0,s=-1,l=new this(i);++s<n;)!function(t,i){function s(t){r[i]=t,++a!==n||o||(o=!0,p.resolve(l,r))}e.resolve(t).then(s,function(t){o||(o=!0,p.reject(l,t))})}(t[s],s);return l}function h(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,o=!1;if(!n)return this.resolve([]);for(var r=-1,a=new this(i);++r<n;)!function(t){e.resolve(t).then(function(t){o||(o=!0,p.resolve(a,t))},function(t){o||(o=!0,p.reject(a,t))})}(t[r]);return a}var v=t(1),p={},_=["REJECTED"],m=["FULFILLED"],g=["PENDING"];e.exports=o,o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){if("function"!=typeof t&&this.state===m||"function"!=typeof e&&this.state===_)return this;var n=new this.constructor(i);if(this.state!==g){a(n,this.state===m?t:e,this.outcome)}else this.queue.push(new r(n,t,e));return n},r.prototype.callFulfilled=function(t){p.resolve(this.promise,t)},r.prototype.otherCallFulfilled=function(t){a(this.promise,this.onFulfilled,t)},r.prototype.callRejected=function(t){p.reject(this.promise,t)},r.prototype.otherCallRejected=function(t){a(this.promise,this.onRejected,t)},p.resolve=function(t,e){var n=u(s,e);if("error"===n.status)return p.reject(t,n.value);var i=n.value;if(i)l(t,i);else{t.state=m,t.outcome=e;for(var o=-1,r=t.queue.length;++o<r;)t.queue[o].callFulfilled(e)}return t},p.reject=function(t,e){t.state=_,t.outcome=e;for(var n=-1,i=t.queue.length;++n<i;)t.queue[n].callRejected(e);return t},o.resolve=c,o.reject=f,o.all=d,o.race=h},{1:1}],3:[function(t,n,i){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(r){if("TypeError"!==r.name)throw r;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,i=new n,o=0;o<t.length;o+=1)i.append(t[o]);return i.getBlob(e.type)}}function r(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function a(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function s(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function l(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function u(t){for(var e=t.length,n=new ArrayBuffer(e),i=new Uint8Array(n),o=0;o<e;o++)i[o]=t.charCodeAt(o);return n}function c(t){return new mt(function(e){var n=t.transaction(gt,wt),i=o([""]);n.objectStore(gt).put(i,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}function f(t){return"boolean"==typeof yt?mt.resolve(yt):c(t).then(function(t){return yt=t})}function d(t){var e=xt[t.name],n={};n.promise=new mt(function(t,e){n.resolve=t,n.reject=e}),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then(function(){return n.promise}):e.dbReady=n.promise}function h(t){var e=xt[t.name],n=e.deferredOperations.pop();if(n)return n.resolve(),n.promise}function v(t,e){var n=xt[t.name],i=n.deferredOperations.pop();if(i)return i.reject(e),i.promise}function p(t,e){return new mt(function(n,i){if(xt[t.name]=xt[t.name]||T(),t.db){if(!e)return n(t.db);d(t),t.db.close()}var o=[t.name];e&&o.push(t.version);var r=_t.open.apply(_t,o);e&&(r.onupgradeneeded=function(e){var n=r.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(gt)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),r.onerror=function(t){t.preventDefault(),i(r.error)},r.onsuccess=function(){n(r.result),h(t)}})}function _(t){return p(t,!1)}function m(t){return p(t,!0)}function g(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),i=t.version<t.db.version,o=t.version>t.db.version;if(i&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),o||n){if(n){var r=t.db.version+1;r>t.version&&(t.version=r)}return!0}return!1}function y(t){return new mt(function(e,n){var i=new FileReader;i.onerror=n,i.onloadend=function(n){var i=btoa(n.target.result||"");e({__local_forage_encoded_blob:!0,data:i,type:t.type})},i.readAsBinaryString(t)})}function x(t){return o([u(atob(t.data))],{type:t.type})}function b(t){return t&&t.__local_forage_encoded_blob}function S(t){var e=this,n=e._initReady().then(function(){var t=xt[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return a(n,t,t),n}function w(t){d(t);for(var e=xt[t.name],n=e.forages,i=0;i<n.length;i++){var o=n[i];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return t.db=null,_(t).then(function(e){return t.db=e,g(t)?m(t):e}).then(function(i){t.db=e.db=i;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=i}).catch(function(e){throw v(t,e),e})}function E(t,e,n,i){void 0===i&&(i=1);try{var o=t.db.transaction(t.storeName,e);n(null,o)}catch(o){if(i>0&&(!t.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return mt.resolve().then(function(){if(!t.db||"NotFoundError"===o.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),m(t)}).then(function(){return w(t).then(function(){E(t,e,n,i-1)})}).catch(n);n(o)}}function T(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function A(t){function e(){return mt.resolve()}var n=this,i={db:null};if(t)for(var o in t)i[o]=t[o];var r=xt[i.name];r||(r=T(),xt[i.name]=r),r.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=S);for(var a=[],s=0;s<r.forages.length;s++){var l=r.forages[s];l!==n&&a.push(l._initReady().catch(e))}var u=r.forages.slice(0);return mt.all(a).then(function(){return i.db=r.db,_(i)}).then(function(t){return i.db=t,g(i,n._defaultConfig.version)?m(i):t}).then(function(t){i.db=r.db=t,n._dbInfo=i;for(var e=0;e<u.length;e++){var o=u[e];o!==n&&(o._dbInfo.db=i.db,o._dbInfo.version=i.version)}})}function P(t,e){var n=this;t=s(t);var i=new mt(function(e,i){n.ready().then(function(){E(n._dbInfo,St,function(o,r){if(o)return i(o);try{var a=r.objectStore(n._dbInfo.storeName),s=a.get(t);s.onsuccess=function(){var t=s.result;void 0===t&&(t=null),b(t)&&(t=x(t)),e(t)},s.onerror=function(){i(s.error)}}catch(t){i(t)}})}).catch(i)});return r(i,e),i}function I(t,e){var n=this,i=new mt(function(e,i){n.ready().then(function(){E(n._dbInfo,St,function(o,r){if(o)return i(o);try{var a=r.objectStore(n._dbInfo.storeName),s=a.openCursor(),l=1;s.onsuccess=function(){var n=s.result;if(n){var i=n.value;b(i)&&(i=x(i));var o=t(i,n.key,l++);void 0!==o?e(o):n.continue()}else e()},s.onerror=function(){i(s.error)}}catch(t){i(t)}})}).catch(i)});return r(i,e),i}function k(t,e,n){var i=this;t=s(t);var o=new mt(function(n,o){var r;i.ready().then(function(){return r=i._dbInfo,"[object Blob]"===bt.call(e)?f(r.db).then(function(t){return t?e:y(e)}):e}).then(function(e){E(i._dbInfo,wt,function(r,a){if(r)return o(r);try{var s=a.objectStore(i._dbInfo.storeName);null===e&&(e=void 0);var l=s.put(e,t);a.oncomplete=function(){void 0===e&&(e=null),n(e)},a.onabort=a.onerror=function(){var t=l.error?l.error:l.transaction.error;o(t)}}catch(t){o(t)}})}).catch(o)});return r(o,n),o}function L(t,e){var n=this;t=s(t);var i=new mt(function(e,i){n.ready().then(function(){E(n._dbInfo,wt,function(o,r){if(o)return i(o);try{var a=r.objectStore(n._dbInfo.storeName),s=a.delete(t);r.oncomplete=function(){e()},r.onerror=function(){i(s.error)},r.onabort=function(){var t=s.error?s.error:s.transaction.error;i(t)}}catch(t){i(t)}})}).catch(i)});return r(i,e),i}function M(t){var e=this,n=new mt(function(t,n){e.ready().then(function(){E(e._dbInfo,wt,function(i,o){if(i)return n(i);try{var r=o.objectStore(e._dbInfo.storeName),a=r.clear();o.oncomplete=function(){t()},o.onabort=o.onerror=function(){var t=a.error?a.error:a.transaction.error;n(t)}}catch(t){n(t)}})}).catch(n)});return r(n,t),n}function C(t){var e=this,n=new mt(function(t,n){e.ready().then(function(){E(e._dbInfo,St,function(i,o){if(i)return n(i);try{var r=o.objectStore(e._dbInfo.storeName),a=r.count();a.onsuccess=function(){t(a.result)},a.onerror=function(){n(a.error)}}catch(t){n(t)}})}).catch(n)});return r(n,t),n}function R(t,e){var n=this,i=new mt(function(e,i){if(t<0)return void e(null);n.ready().then(function(){E(n._dbInfo,St,function(o,r){if(o)return i(o);try{var a=r.objectStore(n._dbInfo.storeName),s=!1,l=a.openCursor();l.onsuccess=function(){var n=l.result;if(!n)return void e(null);0===t?e(n.key):s?e(n.key):(s=!0,n.advance(t))},l.onerror=function(){i(l.error)}}catch(t){i(t)}})}).catch(i)});return r(i,e),i}function B(t){var e=this,n=new mt(function(t,n){e.ready().then(function(){E(e._dbInfo,St,function(i,o){if(i)return n(i);try{var r=o.objectStore(e._dbInfo.storeName),a=r.openCursor(),s=[];a.onsuccess=function(){var e=a.result;if(!e)return void t(s);s.push(e.key),e.continue()},a.onerror=function(){n(a.error)}}catch(t){n(t)}})}).catch(n)});return r(n,t),n}function N(t,e){e=l.apply(this,arguments);var n=this.config();t="function"!=typeof t&&t||{},t.name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var i,o=this;if(t.name){var a=t.name===n.name&&o._dbInfo.db,s=a?mt.resolve(o._dbInfo.db):_(t).then(function(e){var n=xt[t.name],i=n.forages;n.db=e;for(var o=0;o<i.length;o++)i[o]._dbInfo.db=e;return e});i=t.storeName?s.then(function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;d(t);var i=xt[t.name],o=i.forages;e.close();for(var r=0;r<o.length;r++){var a=o[r];a._dbInfo.db=null,a._dbInfo.version=n}return new mt(function(e,i){var o=_t.open(t.name,n);o.onerror=function(t){o.result.close(),i(t)},o.onupgradeneeded=function(){o.result.deleteObjectStore(t.storeName)},o.onsuccess=function(){var t=o.result;t.close(),e(t)}}).then(function(t){i.db=t;for(var e=0;e<o.length;e++){var n=o[e];n._dbInfo.db=t,h(n._dbInfo)}}).catch(function(e){throw(v(t,e)||mt.resolve()).catch(function(){}),e})}}):s.then(function(e){d(t);var n=xt[t.name],i=n.forages;e.close();for(var o=0;o<i.length;o++){i[o]._dbInfo.db=null}return new mt(function(e,n){var i=_t.deleteDatabase(t.name);i.onerror=i.onblocked=function(t){var e=i.result;e&&e.close(),n(t)},i.onsuccess=function(){var t=i.result;t&&t.close(),e(t)}}).then(function(t){n.db=t;for(var e=0;e<i.length;e++)h(i[e]._dbInfo)}).catch(function(e){throw(v(t,e)||mt.resolve()).catch(function(){}),e})})}else i=mt.reject("Invalid arguments");return r(i,e),i}function O(t){var e,n,i,o,r,a=.75*t.length,s=t.length,l=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),c=new Uint8Array(u);for(e=0;e<s;e+=4)n=Tt.indexOf(t[e]),i=Tt.indexOf(t[e+1]),o=Tt.indexOf(t[e+2]),r=Tt.indexOf(t[e+3]),c[l++]=n<<2|i>>4,c[l++]=(15&i)<<4|o>>2,c[l++]=(3&o)<<6|63&r;return u}function D(t){var e,n=new Uint8Array(t),i="";for(e=0;e<n.length;e+=3)i+=Tt[n[e]>>2],i+=Tt[(3&n[e])<<4|n[e+1]>>4],i+=Tt[(15&n[e+1])<<2|n[e+2]>>6],i+=Tt[63&n[e+2]];return n.length%3==2?i=i.substring(0,i.length-1)+"=":n.length%3==1&&(i=i.substring(0,i.length-2)+"=="),i}function z(t,e){var n="";if(t&&(n=Ut.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===Ut.call(t.buffer))){var i,o=It;t instanceof ArrayBuffer?(i=t,o+=Lt):(i=t.buffer,"[object Int8Array]"===n?o+=Ct:"[object Uint8Array]"===n?o+=Rt:"[object Uint8ClampedArray]"===n?o+=Bt:"[object Int16Array]"===n?o+=Nt:"[object Uint16Array]"===n?o+=Dt:"[object Int32Array]"===n?o+=Ot:"[object Uint32Array]"===n?o+=zt:"[object Float32Array]"===n?o+=Ft:"[object Float64Array]"===n?o+=Vt:e(new Error("Failed to get type for BinaryArray"))),e(o+D(i))}else if("[object Blob]"===n){var r=new FileReader;r.onload=function(){var n=At+t.type+"~"+D(this.result);e(It+Mt+n)},r.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}}function F(t){if(t.substring(0,kt)!==It)return JSON.parse(t);var e,n=t.substring(Yt),i=t.substring(kt,Yt);if(i===Mt&&Pt.test(n)){var r=n.match(Pt);e=r[1],n=n.substring(r[0].length)}var a=O(n);switch(i){case Lt:return a;case Mt:return o([a],{type:e});case Ct:return new Int8Array(a);case Rt:return new Uint8Array(a);case Bt:return new Uint8ClampedArray(a);case Nt:return new Int16Array(a);case Dt:return new Uint16Array(a);case Ot:return new Int32Array(a);case zt:return new Uint32Array(a);case Ft:return new Float32Array(a);case Vt:return new Float64Array(a);default:throw new Error("Unkown type: "+i)}}function V(t,e,n,i){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,i)}function Y(t){var e=this,n={db:null};if(t)for(var i in t)n[i]="string"!=typeof t[i]?t[i].toString():t[i];var o=new mt(function(t,i){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return i(t)}n.db.transaction(function(o){V(o,n,function(){e._dbInfo=n,t()},function(t,e){i(e)})},i)});return n.serializer=jt,o}function U(t,e,n,i,o,r){t.executeSql(n,i,o,function(t,a){a.code===a.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(t,s){s.rows.length?r(t,a):V(t,e,function(){t.executeSql(n,i,o,r)},r)},r):r(t,a)},r)}function j(t,e){var n=this;t=s(t);var i=new mt(function(e,i){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){U(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var i=n.rows.length?n.rows.item(0).value:null;i&&(i=o.serializer.deserialize(i)),e(i)},function(t,e){i(e)})})}).catch(i)});return r(i,e),i}function G(t,e){var n=this,i=new mt(function(e,i){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){U(n,o,"SELECT * FROM "+o.storeName,[],function(n,i){for(var r=i.rows,a=r.length,s=0;s<a;s++){var l=r.item(s),u=l.value;if(u&&(u=o.serializer.deserialize(u)),void 0!==(u=t(u,l.key,s+1)))return void e(u)}e()},function(t,e){i(e)})})}).catch(i)});return r(i,e),i}function Z(t,e,n,i){var o=this;t=s(t);var a=new mt(function(r,a){o.ready().then(function(){void 0===e&&(e=null);var s=e,l=o._dbInfo;l.serializer.serialize(e,function(e,u){u?a(u):l.db.transaction(function(n){U(n,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[t,e],function(){r(s)},function(t,e){a(e)})},function(e){if(e.code===e.QUOTA_ERR){if(i>0)return void r(Z.apply(o,[t,s,n,i-1]));a(e)}})})}).catch(a)});return r(a,n),a}function H(t,e,n){return Z.apply(this,[t,e,n,1])}function W(t,e){var n=this;t=s(t);var i=new mt(function(e,i){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){U(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){i(e)})})}).catch(i)});return r(i,e),i}function X(t){var e=this,n=new mt(function(t,n){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(e){U(e,i,"DELETE FROM "+i.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return r(n,t),n}function Q(t){var e=this,n=new mt(function(t,n){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(e){U(e,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],function(e,n){var i=n.rows.item(0).c;t(i)},function(t,e){n(e)})})}).catch(n)});return r(n,t),n}function q(t,e){var n=this,i=new mt(function(e,i){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){U(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var i=n.rows.length?n.rows.item(0).key:null;e(i)},function(t,e){i(e)})})}).catch(i)});return r(i,e),i}function K(t){var e=this,n=new mt(function(t,n){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(e){U(e,i,"SELECT key FROM "+i.storeName,[],function(e,n){for(var i=[],o=0;o<n.rows.length;o++)i.push(n.rows.item(o).key);t(i)},function(t,e){n(e)})})}).catch(n)});return r(n,t),n}function J(t){return new mt(function(e,n){t.transaction(function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,i){for(var o=[],r=0;r<i.rows.length;r++)o.push(i.rows.item(r).name);e({db:t,storeNames:o})},function(t,e){n(e)})},function(t){n(t)})})}function $(t,e){e=l.apply(this,arguments);var n=this.config();t="function"!=typeof t&&t||{},t.name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var i,o=this;return i=t.name?new mt(function(e){var i;i=t.name===n.name?o._dbInfo.db:openDatabase(t.name,"","",0),e(t.storeName?{db:i,storeNames:[t.storeName]}:J(i))}).then(function(t){return new mt(function(e,n){t.db.transaction(function(i){for(var o=[],r=0,a=t.storeNames.length;r<a;r++)o.push(function(t){return new mt(function(e,n){i.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(t,e){n(e)})})}(t.storeNames[r]));mt.all(o).then(function(){e()}).catch(function(t){n(t)})},function(t){n(t)})})}):mt.reject("Invalid arguments"),r(i,e),i}function tt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function et(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(t){return!0}}function nt(){return!et()||localStorage.length>0}function it(t){var e=this,n={};if(t)for(var i in t)n[i]=t[i];return n.keyPrefix=tt(t,e._defaultConfig),nt()?(e._dbInfo=n,n.serializer=jt,mt.resolve()):mt.reject()}function ot(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var i=localStorage.key(n);0===i.indexOf(t)&&localStorage.removeItem(i)}});return r(n,t),n}function rt(t,e){var n=this;t=s(t);var i=n.ready().then(function(){var e=n._dbInfo,i=localStorage.getItem(e.keyPrefix+t);return i&&(i=e.serializer.deserialize(i)),i});return r(i,e),i}function at(t,e){var n=this,i=n.ready().then(function(){for(var e=n._dbInfo,i=e.keyPrefix,o=i.length,r=localStorage.length,a=1,s=0;s<r;s++){var l=localStorage.key(s);if(0===l.indexOf(i)){var u=localStorage.getItem(l);if(u&&(u=e.serializer.deserialize(u)),void 0!==(u=t(u,l.substring(o),a++)))return u}}});return r(i,e),i}function st(t,e){var n=this,i=n.ready().then(function(){var e,i=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(i.keyPrefix.length)),e});return r(i,e),i}function lt(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=localStorage.length,i=[],o=0;o<n;o++){var r=localStorage.key(o);0===r.indexOf(t.keyPrefix)&&i.push(r.substring(t.keyPrefix.length))}return i});return r(n,t),n}function ut(t){var e=this,n=e.keys().then(function(t){return t.length});return r(n,t),n}function ct(t,e){var n=this;t=s(t);var i=n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return r(i,e),i}function ft(t,e,n){var i=this;t=s(t);var o=i.ready().then(function(){void 0===e&&(e=null);var n=e;return new mt(function(o,r){var a=i._dbInfo;a.serializer.serialize(e,function(e,i){if(i)r(i);else try{localStorage.setItem(a.keyPrefix+t,e),o(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||r(t),r(t)}})})});return r(o,n),o}function dt(t,e){if(e=l.apply(this,arguments),t="function"!=typeof t&&t||{},!t.name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var i,o=this;return i=t.name?new mt(function(e){e(t.storeName?tt(t,o._defaultConfig):t.name+"/")}).then(function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}}):mt.reject("Invalid arguments"),r(i,e),i}function ht(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function vt(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(Xt(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();"undefined"==typeof Promise&&t(3);var mt=Promise,gt="local-forage-detect-blob-support",yt=void 0,xt={},bt=Object.prototype.toString,St="readonly",wt="readwrite",Et={_driver:"asyncStorage",_initStorage:A,_support:function(){try{if(!_t)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:I,getItem:P,setItem:k,removeItem:L,clear:M,length:C,key:R,keys:B,dropInstance:N},Tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",At="~~local_forage_type~",Pt=/^~~local_forage_type~([^~]+)~/,It="__lfsc__:",kt=It.length,Lt="arbf",Mt="blob",Ct="si08",Rt="ui08",Bt="uic8",Nt="si16",Ot="si32",Dt="ur16",zt="ui32",Ft="fl32",Vt="fl64",Yt=kt+Lt.length,Ut=Object.prototype.toString,jt={serialize:z,deserialize:F,stringToBuffer:O,bufferToString:D},Gt={_driver:"webSQLStorage",_initStorage:Y,_support:function(){return"function"==typeof openDatabase}(),iterate:G,getItem:j,setItem:H,removeItem:W,clear:X,length:Q,key:q,keys:K,dropInstance:$},Zt={_driver:"localStorageWrapper",_initStorage:it,_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:at,getItem:rt,setItem:ft,removeItem:ct,clear:ot,length:ut,key:st,keys:lt,dropInstance:dt},Ht=function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)},Wt=function(t,e){for(var n=t.length,i=0;i<n;){if(Ht(t[i],e))return!0;i++}return!1},Xt=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Qt={},qt={},Kt={INDEXEDDB:Et,WEBSQL:Gt,LOCALSTORAGE:Zt},Jt=[Kt.INDEXEDDB._driver,Kt.WEBSQL._driver,Kt.LOCALSTORAGE._driver],$t=["dropInstance"],te=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat($t),ee={description:"",driver:Jt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},ne=function(){function t(e){i(this,t);for(var n in Kt)if(Kt.hasOwnProperty(n)){var o=Kt[n],r=o._driver;this[n]=r,Qt[r]||this.defineDriver(o)}this._defaultConfig=vt({},ee),this._config=vt({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":pt(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var i=new mt(function(e,n){try{var i=t._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(o);for(var a=te.concat("_initStorage"),s=0,l=a.length;s<l;s++){var u=a[s];if((!Wt($t,u)||t[u])&&"function"!=typeof t[u])return void n(o)}!function(){for(var e=0,n=$t.length;e<n;e++){var i=$t[e];t[i]||(t[i]=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=mt.reject(e);return r(n,arguments[arguments.length-1]),n}}(i))}}();var c=function(n){Qt[i]&&console.info("Redefining LocalForage driver: "+i),Qt[i]=t,qt[i]=n,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(c,n):c(!!t._support):c(!0)}catch(t){n(t)}});return a(i,e,n),i},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var i=Qt[t]?mt.resolve(Qt[t]):mt.reject(new Error("Driver not found."));return a(i,e,n),i},t.prototype.getSerializer=function(t){var e=mt.resolve(jt);return a(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return a(n,t,t),n},t.prototype.setDriver=function(t,e,n){function i(){s._config.driver=s.driver()}function o(t){return s._extend(t),i(),s._ready=s._initStorage(s._config),s._ready}function r(t){return function(){function e(){for(;n<t.length;){var r=t[n];return n++,s._dbInfo=null,s._ready=null,s.getDriver(r).then(o).catch(e)}i();var a=new Error("No available storage method found.");return s._driverSet=mt.reject(a),s._driverSet}var n=0;return e()}}var s=this;Xt(t)||(t=[t]);var l=this._getSupportedDrivers(t),u=null!==this._driverSet?this._driverSet.catch(function(){return mt.resolve()}):mt.resolve();return this._driverSet=u.then(function(){var t=l[0];return s._dbInfo=null,s._ready=null,s.getDriver(t).then(function(t){s._driver=t._driver,i(),s._wrapLibraryMethodsWithReady(),s._initDriver=r(l)})}).catch(function(){i();var t=new Error("No available storage method found.");return s._driverSet=mt.reject(t),s._driverSet}),a(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!qt[t]},t.prototype._extend=function(t){vt(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,i=t.length;n<i;n++){var o=t[n];this.supports(o)&&e.push(o)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=te.length;t<e;t++)ht(this,te[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),ie=new ne;e.exports=ie},{3:3}]},{},[4])(4)})}).call(e,n(142))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(0),r=i(o),a=n(1),s=i(a),l=n(29),u=n(47),c=function(){function t(e,n){return(0,r.default)(this,t),!e||e instanceof u?!n||n instanceof u?void(e&&(n?((e.getLat()>n.getLat()||e.getLng()>n.getLng())&&console.error("LatLngBounds中sw 的经纬度必须小于ne的经纬度，实际传入sw为：",e,"ne 为：",n),this.setSouthWest(e).setNorthEast(n)):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):2===e.length&&this.setSouthWest(e[0]).setNorthEast(e[1]))):void new l.BaseTypeError("LatLngBounds.ne","LatLng",n).error():void new l.BaseTypeError("LatLngBounds.sw","LatLng",e).error()}return(0,s.default)(t,[{key:"setNorthEast",value:function(t){return this._ne=u.convert(t),this}},{key:"setSouthWest",value:function(t){return this._sw=u.convert(t),this}},{key:"getCenter",value:function(){return new u((this._sw.lat+this._ne.lat)/2,(this._sw.lng+this._ne.lng)/2,0,!0)}},{key:"getSouthWest",value:function(){return this._sw}},{key:"getNorthEast",value:function(){return this._ne}},{key:"extend",value:function(e){var n=this._sw,i=this._ne,o=void 0,r=void 0;if(e instanceof u)o=e,r=e;else{if(!(e instanceof t))return Array.isArray(e)?e.every(Array.isArray)?this.extend(t.convert(e)):this.extend(u.convert(e)):this;if(o=e._sw,r=e._ne,!o||!r)return this}return n||i?(this._sw=new u(Math.min(o.lat,n.lat),Math.min(o.lng,n.lng),0,!0),this._ne=new u(Math.max(r.lat,i.lat),Math.max(r.lng,i.lng),0,!0)):(this._sw=new u(o.lat,o.lng,0,!0),this._ne=new u(r.lat,r.lng,0,!0)),this}},{key:"union",value:function(t){return this.extend(t)}},{key:"equals",value:function(t){var e=this._sw,n=this._ne,i=t.getSouthWest(),o=t.getNorthEast();return e.equals(i)&&n.equals(o)}},{key:"intersects",value:function(t){var e=this._sw,n=this._ne,i=t.getSouthWest(),o=t.getNorthEast();return!(i.lat>n.lat||o.lat<e.lat||i.lng>n.lng||o.lng<e.lng)}},{key:"covers",value:function(t){var e=t.getSouthWest(),n=t.getNorthEast(),i=t.getSouthEast(),o=t.getNorthWest();return this.contains(e)&&this.contains(n)&&this.contains(i)&&this.contains(o)}},{key:"isEmpty",value:function(){return!this._sw||!this._ne||this._sw.lat===this._ne.lat||this._sw.lng===this._ne.lng}},{key:"contains",value:function(t){return this._sw.lat<=t.lat&&this._sw.lng<=t.lng&&this._ne.lat>=t.lat&&this._ne.lng>=t.lng}},{key:"getNorthWest",value:function(){return new u(this.getNorth(),this.getWest(),0,!0)}},{key:"getSouthEast",value:function(){return new u(this.getSouth(),this.getEast(),0,!0)}},{key:"getWest",value:function(){return this._sw.lng}},{key:"getSouth",value:function(){return this._sw.lat}},{key:"getEast",value:function(){return this._ne.lng}},{key:"getNorth",value:function(){return this._ne.lat}},{key:"toString",value:function(){return"LatLngBounds("+this._sw.toString()+", "+this._ne.toString()+")"}}]),t}();c.convert=function(t){return!t||t instanceof c?t:new c(t)},c._convertFromWorker=function(t){return t._sw&&t._ne?new c(u.convert(t._sw),u.convert(t._ne)):t},t.exports=c},function(t,e,n){"use strict";function i(t,e,n){var i=window.document.createElement(t);return e&&(i.className=e),n&&n.appendChild(i),i}function o(t){for(var e=0;e<t.length;e++)if(t[e]in w)return t[e];return t[0]}function r(){E&&(T=w[E],w[E]="none")}function a(){E&&(w[E]=T)}function s(t,e){t.style[A]=e}function l(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",l,!0)}function u(){window.addEventListener("click",l,!0),window.setTimeout(function(){window.removeEventListener("click",l,!0)},0)}function c(t,e){var n=t.getBoundingClientRect();return e=e.touches?("touchend"===e.type?e.changedTouches:e.touches)[0]:e,d(t,new S(e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop))}function f(t,e){for(var n=t.getBoundingClientRect(),i=[],o="touchend"===e.type?e.changedTouches:e.touches,r=0;r<o.length;r++){var a=new S(o[r].clientX-n.left-t.clientLeft,o[r].clientY-n.top-t.clientTop),s=d(t,a);i.push(s)}return i}function d(t,e){var n=null,i=getComputedStyle(t),o=i.width,r=i.height,a=i.transform;for(o=o.replace("px",""),r=r.replace("px","");null!==t;){if(!a){a=getComputedStyle(t).transform}if("none"!==a){var s=a.match(/\(([^)]*)\)/),l=(0,x.default)(s,2),u=l[1],c=u.split(","),f=new b.Matrix4;f.elements[0]=parseFloat(c[0].trim()),f.elements[1]=parseFloat(c[1].trim()),f.elements[4]=parseFloat(c[2].trim()),f.elements[5]=parseFloat(c[3].trim()),n=n?f.multiply(n):f}t=t.parentElement,a=null}if(!n)return e;var d=new b.Vector3([o,0,0]),h=new b.Vector3([0,r,0]),v=new b.Vector3([o,r,0]),p=n.multiplyVector3(d),_=n.multiplyVector3(h),m=n.multiplyVector3(v),g=Math.min.apply(null,[0,p.elements[0],_.elements[0],m.elements[0]]),y=Math.min.apply(null,[0,p.elements[1],_.elements[1],m.elements[1]]),w=n.invert(),E=new b.Vector3([e.x+g,e.y+y,0]),T=w.multiplyVector3(E);return new S(T.elements[0],T.elements[1])}function h(t){t.parentNode&&t.parentNode.removeChild(t)}function v(t){var e=document.createElement("div");e.innerHTML=t;var n=document.createDocumentFragment();return Array.prototype.slice.apply(e.childNodes).forEach(function(t){n.appendChild(t)}),n}function p(t){if("pageX"in t&&"pageY"in t)return{x:t.pageX,y:t.pageY};if("touches"in t&&t.touches.length>0){var e=t.touches[0];return{x:e.pageX,y:e.pageY}}if("changedTouches"in t&&t.changedTouches.length>0){var n=t.changedTouches[0];return{x:n.pageX,y:n.pageY}}}function _(t,e){t&&(Array.isArray(e)||(e=[e]),e.forEach(function(e){g(t,e)||(t.className+=" "+e)}))}function m(t,e){t&&(Array.isArray(e)||(e=[e]),e.forEach(function(e){g(t,e)&&(t.className=t.className.replace(" "+e,""))}))}function g(t,e){if(t){var n=" "+e+" ";return(" "+t.className+" ").includes(n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.TRANSITIONTIMINGFUNCTION=e.TRANSITIONDURATION=e.TRANSITIONEND=e.TRANSITION=e.TRANSFORM=e.TRANSFORMORIGIN=void 0;var y=n(32),x=function(t){return t&&t.__esModule?t:{default:t}}(y);e.create=i,e.disableDrag=r,e.enableDrag=a,e.setTransform=s,e.suppressClick=u,e.mousePos=c,e.touchPos=f,e.remove=h,e.toDom=v,e.getPointerXY=p,e.addClass=_,e.removeClass=m,e.hasClass=g;var b=n(107),S=n(74),w=window.document.documentElement.style,E=o(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),T=void 0,A=(e.TRANSFORMORIGIN=o(["TRANSFORMORIGIN","WebkitTransformOrigin","OTransformOrigin","MozTransformOrigin","msTransformOrigin"]),e.TRANSFORM=o(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])),P=e.TRANSITION=o(["transition","webkitTransition","OTransition","MozTransition","msTransition"]);e.TRANSITIONEND="transition"===P?P+"end":P+"End",e.TRANSITIONDURATION=P+"Duration",e.TRANSITIONTIMINGFUNCTION=P+"TimingFunction"},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(16),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(212),f=i(c),d=n(784),h=i(d),v=void 0,p={},_=function(){function t(e){(0,s.default)(this,t),this.gl=e.gl,this.location={},this.store=null,this.shaderSource=null,this.shaderParams=null}return(0,u.default)(t,[{key:"preDraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.programId;e!==v&&(v=e,this.enableProgram(t.updated)),this.loadTexture(t),this.applyLight(t.lightUniforms,t.shadowTexture)}},{key:"afterDraw",value:function(){if(this.enableLight){var t=this.gl;t.activeTexture(t.TEXTURE3),t.bindTexture(t.TEXTURE_2D,null)}}},{key:"loadTexture",value:function(){}},{key:"applyLight",value:function(t,e){if(t&&this.enableLight){var n=this.gl,i=t.lighting_uBase,o=t.lighting_uToneMapping,r=t.lighting_uAmbientColor,a=t.lighting_uDirDirection,s=t.lighting_uDirColor,l=t.lighting_uDirCount,u=t.lighting_uPointPosition,c=t.lighting_uPointAtt,f=t.lighting_uPointColor,d=t.lighting_uPointCount,h=t.lighting_uShadow,v=t.lighting_uViewPos,p=t.lighting_uShadowLightPVMatrix;e&&e.bind(n,{textureIndex:3}),n.uniform4f(this.lighting_uBase,i[0],i[1],i[2],i[3]),n.uniform4f(this.lighting_uAdvanced,o[0],o[1],h[0],h[1]),n.uniform3f(this.lighting_uAmbientColor,r[0],r[1],r[2]),n.uniform3fv(this.lighting_uDirDirection,a),n.uniform3fv(this.lighting_uDirColor,s),n.uniform3fv(this.lighting_uPointPosition,u),n.uniform3fv(this.lighting_uPointAtt,c),n.uniform3fv(this.lighting_uPointColor,f),n.uniform2f(this.lighting_uLightCount,l,d),n.uniform3f(this.lighting_uViewPos,v[0],v[1],v[2]),n.uniformMatrix4fv(this.lighting_uShadowLightPVMatrix,!1,p),e&&n.uniform1i(this.lighting_uShadowSampler,3)}}},{key:"createBuffer",value:function(t,e,n,i){var o=this.gl,r={};return e&&(r.vertices=new f.default(o,{data:e,usage:o.DYNAMIC_DRAW})),n&&(r.indices=new f.default(o,{target:o.ELEMENT_ARRAY_BUFFER,data:n,usage:o.DYNAMIC_DRAW}),r.length=n.byteLength/n.BYTES_PER_ELEMENT),i&&(r.fillCoordinates=new f.default(o,{data:i,usage:o.DYNAMIC_DRAW})),r}},{key:"bindVertexBuffer",value:function(t,e){var n=this.gl,i=t.attributes,o=void 0;e?e.bind():e=new f.default(n,{data:t.arrayBuffer,usage:n.DYNAMIC_DRAW});for(var r=0,a=i.length;r<a;r++){o=i[r],o.name in this.location||(this.location[o.name]=n.getAttribLocation(n.program,o.name));var s=this.location[o.name];s<0||e.pointToAttrib({location:s,size:o.components,type:n[o.type],stride:t.bytesPerElement,offset:o.offset})}return e}},{key:"unbindVertexBuffer",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=this.gl;n.forEach(function(t){t.name in e.location||(e.location[t.name]=i.getAttribLocation(i.program,t.name));var n=e.location[t.name];n<0||e.gl.disableVertexAttribArray(n)}),t.unbind()}},{key:"bindElementBuffer",value:function(t,e){var n=this.gl;return e?e.bind():e=new f.default(n,{target:n.ELEMENT_ARRAY_BUFFER,data:t.arrayBuffer,usage:n.DYNAMIC_DRAW}),e}},{key:"getVariableLocations",value:function(t){var e=(0,r.default)({},this.shaderParams);if(this.enableLight){var n;(n=e.uniforms).push.apply(n,["lighting_uBase","lighting_uAdvanced","lighting_uAmbientColor","lighting_uDirDirection","lighting_uDirColor","lighting_uPointPosition","lighting_uPointAtt","lighting_uPointColor","lighting_uLightCount","lighting_uViewPos","lighting_uShadowLightPVMatrix","lighting_uShadowSampler"])}return(0,r.default)({},t.getLocations("attributes",e.attributes),t.getLocations("uniforms",e.uniforms))}},{key:"enableProgram",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.gl,n=this.programId,i=this.shaderSource,o=p[n];o?t&&(o.attachShader(i.v,i.f,t),o.locations=this.getVariableLocations(o),p[n]=o):(o=new h.default(e,{vShader:i.v,fShader:i.f}),o.locations=this.getVariableLocations(o),p[n]=o),o.enable(),(0,r.default)(this,o.locations)}},{key:"clearStore",value:function(){this.store&&this.store.clear()}},{key:"destroy",value:function(){this.store&&(this.store.clear(),this.store=null);var t=this.shaderSource.name+this.gl.id;p[t]&&(p[t].delete(),delete p[t]),this.shaderParams=null,this.shaderSource=null,this.location=null,this.gl=null}},{key:"isBufferChanged",value:function(t,e){if(t&&e){for(var n in t)if(t.hasOwnProperty(n)&&e[n]&&t[n].data!==e[n])return!0;return!1}}},{key:"programId",get:function(){return this.shaderSource.name+this.gl.id}}]),t}();e.default=_},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(280),p=i(v),_=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.default)(this,e),(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t,n))}return(0,h.default)(e,t),(0,u.default)(e,[{key:"_onCreate",value:function(){return this.gl.createBuffer()}},{key:"_onDelete",value:function(){this.unbind(),this.gl.deleteBuffer(this._object),this.gl.disableVertexAttribArray(this.location)}},{key:"_initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.target=t.target||this.gl.ARRAY_BUFFER,t.data&&(this.bind(),this.bufferData(t.data,t))}},{key:"bind",value:function(t,e){t=t||this.gl,e=e||this.target,t.bindBuffer(e,this._object)}},{key:"unbind",value:function(t,e){t=t||this.gl,e=e||this.target,t.bindBuffer(e,null)}},{key:"bufferData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl.bufferData(this.target,t,e.usage||this.gl.STATIC_DRAW)}},{key:"bufferSubData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl.bufferSubData(this.target,e.offset||0,t)}},{key:"pointToAttrib",value:function(t){var e=t.location,n=t.size,i=t.type,o=t.normalized,r=void 0!==o&&o,a=t.stride,s=void 0===a?0:a,l=t.offset,u=void 0===l?0:l,c=t.enable,f=void 0===c||c;this.location=e,this.gl.vertexAttribPointer(e,n,i,r,s,u),f&&this.gl.enableVertexAttribArray(e)}},{key:"buffer",get:function(){return this._object}}]),e}(p.default);e.default=_},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(280),p=i(v),_=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,s.default)(this,e);var i=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t,n));return i._initialize(n),i}return(0,h.default)(e,t),(0,u.default)(e,[{key:"_onCreate",value:function(){return this.gl.createTexture()}},{key:"_onDelete",value:function(){this.unbind(),this.gl.deleteTexture(this._object)}},{key:"_initialize",value:function(t){var e=t.pixels,n=t.originalWidth,i=t.originalHeight,o=t.width,r=t.height,a=t.internalformat,s=t.type,l=void 0===s?"UNSIGNED_BYTE":s,u=t.format,c=void 0===u?"RGBA":u,f=t.target,d=void 0===f?"TEXTURE_2D":f,h=e&&e.width,v=e&&e.height;this.pixels=e||null,this.originalWidth=n||h,this.originalHeight=i||v,this.width=o||h,this.height=r||v,this.type=l,this.format=c,this.internalformat=a||c,this.target=d,this._uploaded=!1}},{key:"bind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=t||this.gl;var n=this.target,i=this._object,o=t.TEXTURE0+(e.textureIndex||0);t.activeTexture(o),t.bindTexture(t[n],i)}},{key:"unbind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=t||this.gl;var n=this.target,i=t.TEXTURE0+(e.textureIndex||0);t.activeTexture(i),t.bindTexture(this.gl[n],null)}},{key:"resize",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.width=t,this.height=e;var i=this.gl,o=this.target;i&&(this.bind(null,n),this._preSet(n),i.texImage2D(i[o],0,i[this.internalformat],t,e,0,i[this.format],i[this.type],this.pixels))}},{key:"update",value:function(t,e){t&&(this.originalWidth=t.width,this.width=t.width||e.width,this.height=t.height||e.height,this.originalHeight=t.height,this.pixels=t||null,this._uploaded=!1,this.upload(e))}},{key:"updateSub",value:function(t,e){if(t){this.bind(null,e),this._preSet(e);var n=this.gl,i=this.target,o=this.format,r=this.type,a=e.xOffset,s=e.yOffset;n.texSubImage2D(n[i],0,a,s,n[o],n[r],t)}}},{key:"upload",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.gl||console.error("Texture donnot have gl, unable upload to GPU!");var e=this.gl,n=this.target;this.bind(null,t),this._preSet(t),this._uploaded||(e.isWebGL2?e.texImage2D(e[n],0,e[this.internalformat],this.width,this.height,0,e[this.format],e[this.type],this.pixels):e.texImage2D(e[n],0,e[this.internalformat],e[this.format],e[this.type],this.pixels),t.useMipmap&&e.generateMipmap(e[n])),this._uploaded=!0}},{key:"copy",value:function(t){var e=this.gl,n=this.width,i=this.height,o=this.target;e||console.error("Texture donnot have gl, unable upload to GPU!"),this.bind(null,t),this._preSet(t),e.copyTexImage2D(e[o],0,e[this.internalformat],0,0,n,i,0)}},{key:"destroy",value:function(){this.gl&&this.delete()}},{key:"_preSet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.gl,n=this.target;t.flipY&&e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),t.premultiply&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texParameteri(e[n],e.TEXTURE_MIN_FILTER,t.minFilter||e.LINEAR),e.texParameteri(e[n],e.TEXTURE_MAG_FILTER,t.magFilter||e.LINEAR),e.texParameteri(e[n],e.TEXTURE_WRAP_S,t.wrapS||e.CLAMP_TO_EDGE),e.texParameteri(e[n],e.TEXTURE_WRAP_T,t.wrapT||e.CLAMP_TO_EDGE)}},{key:"texture",get:function(){return this._object}}]),e}(p.default);e.default=_},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(104),o=n(268);t.exports=n(103)?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(321),o=n(245);t.exports=function(t){return i(o(t))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.UNIFORM_PART="\n    uniform mat4 uMatrix;\n    uniform vec4 uCenter;\n    uniform float uZoom;\n\n    uniform vec3 uPixelsPerMeter;\n\n    uniform vec2 uResolution;\n    uniform vec3 uProject_uCommonUnitsPerWorldUnit;\n    uniform vec3 uProject_uCommonUnitsPerWorldUnit2;\n",e.PROJECTION_PART="\n    float PI = 3.141592653589793;\n\n    float degreeToRadian(float deg) {\n      \treturn deg * PI / 180.;\n\t}\n\tconst float THRESHOLD_ZOOM = 9.0;\n\tfloat radianToDegree(float rad) {\n\t\treturn rad / PI * 180.;\n\t}\n\t\n\t\n\tvec2 fromPointToLatLng(vec2 point) {\n\t\tvec2 c = vec2(128.0, 128.0);\n\t\tfloat lng = (point.x - c.x) / 256. * 360.;\n\t\tfloat a = - (point.y - c.y) / 256. * 2. * PI;\n\t\tfloat lat = radianToDegree(2. * atan(exp(a)) - PI / 2.);\n\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\treturn vec2(lng, lat);\n\t}\n\n\n    vec2 fromLatLngToPoint(vec2 latlng) {\n      \tvec2 c = vec2(0.0, 0.0);\n      \tvec2 d = vec2(128.0, 128.0);\n      \tc.x = d.x + latlng.x * (256. / 360.);\n      \tfloat e = clamp(sin(degreeToRadian(latlng.y)), -(1. - 1E-15), 1. - 1E-15);\n      \tc.y = d.y + 0.5 * log((1. + e) / (1. - e)) * -(256. / (2. * PI));\n      \treturn c;\n    }\n\n\n\n    vec2 project_position(vec2 latlng, float mapzoom) {\n      \tvec2 tileCoord = fromLatLngToPoint(latlng);\n      \tfloat dimension = pow(2., mapzoom);\n      \ttileCoord.xy *= dimension;\n\n      \treturn tileCoord;\n    }\n\n\n    vec2 project_view_local_position(vec2 latlng) {\n      \tvec2 centerCoord = project_position(uCenter.xy, uZoom);\n      \tvec2 p = project_position(latlng.xy, uZoom);\n\n      \t\n      \treturn vec2(p.x - centerCoord.x, centerCoord.y - p.y);\n    }\n\n    vec3 project_offset(vec3 offset) {\n      \tfloat dy = offset.y;\n\t\t\n      \tdy = clamp(dy, -1., 1.);\n      \tvec3 commonUnitsPerWorldUnit = uProject_uCommonUnitsPerWorldUnit + uProject_uCommonUnitsPerWorldUnit2 * dy;\n\t\t\n      \treturn vec3(offset.xyz * commonUnitsPerWorldUnit.xyz);\n    }\n    \n\n\tvec3 project_view_local_position_precision(vec3 latlngHigh, vec2 latlngLow) {\n\t\t\n\n\t\t\n\t\tvec3 temp_latlng_high = vec3(latlngHigh.x ,latlngHigh.y, latlngHigh.z);\n\t\t\n\t\tif (uCenter.x > 0.0) {\n\t\t\ttemp_latlng_high = vec3(latlngHigh.x ,latlngHigh.y, latlngHigh.z);\n\t\t} else {\n\t\t\ttemp_latlng_high = vec3(latlngHigh.x ,latlngHigh.y, latlngHigh.z);\n\t\t}\n\n\t\tvec2 high = temp_latlng_high.xy - uCenter.xy;\n\t\tvec2 low = latlngLow.xy - uCenter.zw;\n\n\t\treturn mix(\n\t\t\tvec3(project_view_local_position(temp_latlng_high.xy), uProject_uCommonUnitsPerWorldUnit.z * temp_latlng_high.z),\n\t\t\tproject_offset(vec3(high + low, temp_latlng_high.z)),\n\t\t\tstep(9.0, uZoom)\n\t\t);\n\t}\n\n\n    vec2 project_view_local_position_precision(vec2 latlngHigh, vec2 latlngLow) {\n      \tvec3 result = project_view_local_position_precision(vec3(latlngHigh.xy, 0.0), latlngLow);\n\n      \treturn result.xy;\n\t}\n\t\n  vec2 centerPositiveCross0( vec3 startTemp, vec3 endTemp,vec3 latlngHigh,vec3 endLatlngHigh,float startLng,float endLng,float centerLng, float halfPixelDegree){\n    startTemp.x = mix(latlngHigh.x ,latlngHigh.x + 360.0, step(halfPixelDegree, centerLng - startLng) * step( halfPixelDegree, centerLng - endLng));\n    endTemp.x = mix(endLatlngHigh.x ,endLatlngHigh.x + 360.0, step(halfPixelDegree, centerLng - startLng) * step( halfPixelDegree, centerLng - endLng));\n    return vec2(startTemp.x, endTemp.x);\n  }\n\n  vec2 centerPositiveCross180( vec3 startTemp, vec3 endTemp,vec3 latlngHigh,vec3 endLatlngHigh,float startLng,float endLng,float centerLng, float halfPixelDegree){\n    float transit = 1.0;\n\n    startTemp.x = mix(latlngHigh.x , latlngHigh.x + 360.0, step( halfPixelDegree,centerLng -startLng));\n\n    endTemp.x = mix(endLatlngHigh.x , endLatlngHigh.x + 360.0, step( halfPixelDegree, centerLng -endLng));\n    transit = step(halfPixelDegree,centerLng -startLng) * step(halfPixelDegree, centerLng -endLng);\n\n\n\n    endTemp.x = mix(\n      endTemp.x,\n      mix(endLatlngHigh.x , endLatlngHigh.x + 360.0, step(startLng - endLng,180.0)),\n      transit\n    );\n\n    startTemp.x = mix(\n      startTemp.x,\n      mix(latlngHigh.x , latlngHigh.x + 360.0, step( endLng - startLng ,180.0)),\n      transit\n    );\n     return vec2(startTemp.x, endTemp.x);\n  }\n\n  vec2 centerNegativeCross0( vec3 startTemp, vec3 endTemp,vec3 latlngHigh,vec3 endLatlngHigh,float startLng,float endLng,float centerLng, float halfPixelDegree){\n    startTemp.x = mix(latlngHigh.x , latlngHigh.x - 360.0, step(halfPixelDegree, startLng - centerLng ) * step( halfPixelDegree, endLng - centerLng));\n    endTemp.x = mix(endLatlngHigh.x , endLatlngHigh.x - 360.0, step(halfPixelDegree, startLng - centerLng ) * step( halfPixelDegree, endLng - centerLng));\n    return vec2(startTemp.x, endTemp.x);\n  }\n\n  vec2 centerNegativeCross180( vec3 startTemp, vec3 endTemp,vec3 latlngHigh,vec3 endLatlngHigh,float startLng,float endLng,float centerLng, float halfPixelDegree){\n    float transit = 1.0;\n    startTemp.x = mix(latlngHigh.x , latlngHigh.x - 360.0, step( halfPixelDegree, startLng - centerLng));\n    endTemp.x = mix(endLatlngHigh.x , endLatlngHigh.x - 360.0, step( halfPixelDegree, endLng - centerLng));\n\n    transit = step(halfPixelDegree,centerLng -startLng) * step(halfPixelDegree, centerLng -endLng);\n    startTemp.x = mix(\n      startTemp.x,\n      mix(latlngHigh.x , latlngHigh.x - 360.0, step( startLng - endLng  ,180.0)),\n      transit\n    );\n    endTemp.x = mix(\n      endTemp.x,\n      mix(endLatlngHigh.x , endLatlngHigh.x - 360.0, step(endLng - startLng ,180.0)),\n      transit\n    );\n    return vec2(startTemp.x, endTemp.x);\n  }\n\n\tvoid geodesic_project_view_local_precision(vec3 latlngHigh, vec2 latlngLow,vec3 endLatlngHigh, vec2 endLatlngLow, inout vec3 geodesic_Position_Start, inout vec3 geodesic_Position_End, vec2 uProject_uDegreePerPixels) {\n\t\t\n    float halfPixelDegree = uResolution.x * uProject_uDegreePerPixels.x / 2.0;\n\t\tvec3 startTemp = latlngHigh;\n\t\tvec3 endTemp = endLatlngHigh;\n\t\tfloat startLng = latlngHigh.x + latlngLow.x;\n    float endLng = endLatlngHigh.x + endLatlngLow.x;\n    float centerLng = uCenter.x + uCenter.z;\n    vec2 startEndLngCross0 = mix(\n      centerNegativeCross0(startTemp,endTemp,latlngHigh,endLatlngHigh,startLng,endLng,centerLng, halfPixelDegree),\n      centerPositiveCross0(startTemp,endTemp,latlngHigh,endLatlngHigh,startLng,endLng,centerLng, halfPixelDegree),\n      step(0.0, uCenter.x)\n    );\n    vec2 startEndLngCross180 = mix(\n      centerNegativeCross180(startTemp,endTemp,latlngHigh,endLatlngHigh,startLng,endLng,centerLng, halfPixelDegree),\n      centerPositiveCross180(startTemp,endTemp,latlngHigh,endLatlngHigh,startLng,endLng,centerLng, halfPixelDegree),\n      step(0.0, uCenter.x)\n    );\n    startTemp.x = mix(\n      startEndLngCross180.x,\n      startEndLngCross0.x,\n      step(abs(startLng - endLng), 180.0));\n    endTemp.x = mix(\n      startEndLngCross180.y,\n      startEndLngCross0.y,\n      step(abs(startLng - endLng), 180.0));\n  \n\t\tvec3 startNew = project_view_local_position_precision(startTemp, latlngLow);\n\t\tvec3 endNew = project_view_local_position_precision(endTemp, endLatlngLow);\n\t\tgeodesic_Position_Start = startNew;\n\t\tgeodesic_Position_End = endNew;\n\t}\n\tvec3 latlng_to_cartesian(vec2 latlng) {\n\t\t\n\t\tvec2 spherical = vec2(degreeToRadian(latlng.x), degreeToRadian(latlng.y));\n\t\t\n\t\t\n\t\tvec3 cartesian = vec3(\n\t\t\tcos(spherical.y) * sin(spherical.x),\n\t\t\tsin(spherical.y),\n\t\t\tcos(spherical.y) * cos(spherical.x)\n\t\t);\n\n\t\treturn cartesian;\n\t}\n\t\n\t\n\tvec4 project_view_sphere_position(vec2 latlng) {\n\t\tvec3 cartesian = latlng_to_cartesian(latlng);\n\n\t\t\n\t\tfloat rotateY = - degreeToRadian(uCenter.x);\n\t\tfloat rotateX = degreeToRadian(uCenter.y);\n\t\tfloat r = 256. * pow(2., uZoom) / (2. * PI);\n\t\tmat4 rotate1 = mat4(\n\t\t\tcos(rotateY), 0., -sin(rotateY), 0.,\n\t\t\t0., 1., 0., 0.,\n\t\t\tsin(rotateY), 0., cos(rotateY), 0.,\n\t\t\t0., 0., 0., 1.\n\t\t);\n\t\tmat4 rotate2 = mat4(\n\t\t\t1., 0., 0., 0.,\n\t\t\t0., cos(rotateX), sin(rotateX), 0.,\n\t\t\t0., -sin(rotateX), cos(rotateX), 0.,\n\t\t\t0., 0., 0., 1.\n\t\t);\n\t\tmat4 scaleAndTrans = mat4(\n\t\t\tr, 0., 0., 0.,\n\t\t\t0., r, 0., 0.,\n\t\t\t0., 0., r, 0.,\n\t\t\t0., 0., -r, 1.\n\t\t);\n\t\tvec4 position = scaleAndTrans * rotate2 * rotate1 * vec4(cartesian, 1.0);\n\t\treturn position;\n\t}\n\n\n    vec2 proj_position_to_screen(vec4 device) {\n\t\tvec3 device_normal = device.xyz / device.w;\n\t\tvec2 clip_pos = (device_normal * 0.5 + 0.5).xy;\n\t\treturn clip_pos * uResolution;\n    }\n    \n\n\tvec4 screen_to_proj_position(vec2 screen, float z, float w) {\n\t    vec2 clip_pos = screen / uResolution;\n\t    vec2 device_normal = clip_pos * 2.0 - 1.0;\n\t    return vec4(device_normal * w, z, w);\n\t}\n\n    vec3 project_scale(vec3 meters) {\n      \treturn meters * uPixelsPerMeter;\n    }\n\n    vec2 rotate_by_angle_onScreen(vec2 vertex, float angle) {\n      \tfloat angle_radian = angle * PI / 180.0;\n      \tfloat cos_angle = cos(angle_radian);\n      \tfloat sin_angle = sin(angle_radian);\n      \tmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n      \treturn rotationMatrix * vertex;\n    }\n",e.SDF_PART="\n\t\n\tfloat distance = texture2D(u_sampler, vTextureCoords).a;\n\n\t\n\tfloat finalAlpha = smoothstep(usedBuff - vGamma, usedBuff + vGamma, distance);\n\n\t\n\tfloat outlineFactor = smoothstep(u_buffer - vGamma, u_buffer + vGamma, distance);\n\n\t\n\tvec4 color = mix(vStrokeColor, vColor, outlineFactor) * finalAlpha;\n"},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.EllipseStyle=e.RectangleStyle=e.CircleStyle=e.ExtrudablePolygonStyle=e.PolygonStyle=void 0;var o=n(3),r=i(o),a=n(5),s=i(a),l=n(4),u=i(l),c=n(0),f=i(c),d=n(10),h={color:"rgba(55,119,255,0.16)",borderColor:"#3777FF",showBorder:!0,borderWidth:2,borderDashArray:[0,0],extrudeHeight:1},v=e.PolygonStyle=function t(e){(0,f.default)(this,t),e=(0,d.extend)({},h,e),this.color=e.color,this.borderColor=e.borderColor,this.showBorder=!0===e.showBorder,this.borderWidth=e.borderWidth,this.borderDashArray=e.borderDashArray};e.ExtrudablePolygonStyle=function t(e){(0,f.default)(this,t),e=(0,d.extend)({},h,e),this.color=e.color,this.borderColor=e.borderColor,this.showBorder=!0===e.showBorder,this.extrudeHeight=e.extrudeHeight},e.CircleStyle=function(t){function e(t){return(0,f.default)(this,e),(0,s.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t))}return(0,u.default)(e,t),e}(v),e.RectangleStyle=function(t){function e(t){return(0,f.default)(this,e),(0,s.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t))}return(0,u.default)(e,t),e}(v),e.EllipseStyle=function(t){function e(t){return(0,f.default)(this,e),(0,s.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t))}return(0,u.default)(e,t),e}(v)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.deleteInstanceCacllback=function(t){t.data&&(t.data=null),t.buffer&&t.buffer.delete()},e.deleteBuffersCallback=function(t){t.vertices&&t.vertices.delete(),t.indeices&&t.indeices.delete()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.GEOMETRY_TYPES={POINT:"POINT",POLYLINE:"POLYLINE",POLYGON:"POLYGON",LABEL:"LABEL",CIRCLE:"CIRCLE",RECTANGLE:"RECTANGLE",ELLIPSE:"ELLIPSE",MASK:"MASK",HIGHLIGHT:"HIGHLIGHT"}},function(t,e,n){t.exports={default:n(309),__esModule:!0}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(75),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(t,e,n){return e in t?(0,o.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(16),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=o.default||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}},function(t,e,n){n(225),t.exports=n(2).Number.isNaN},function(t,e,n){var i=n(6);i(i.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){"use strict";var i=n(61);t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){if(4===t.length){for(var e="#",n=1;n<4;n+=1)e+=t.slice(n,n+1).concat(t.slice(n,n+1));t=e}var i=t.slice(1);return{r:parseInt(i.slice(0,2),16),g:parseInt(i.slice(2,4),16),b:parseInt(i.slice(4),16)}}function r(t){return t=t.replace(/rgb/,"rgba").replace(")",",")+"1)",a(t)}function a(t){return t=t.replace(/rgba\(/,"").replace(")","").split(","),{r:parseInt(t[0]),g:parseInt(t[1]),b:parseInt(t[2]),a:parseFloat(t[3])}}Object.defineProperty(e,"__esModule",{value:!0});var s=n(0),l=i(s),u=n(1),c=i(u),f=n(41),d=i(f),h=n(398),v=d.default.isString,p=d.default.isArray,_=d.default.isUndefined,m=function(){function t(e,n){if((0,l.default)(this,t),this.r=1,this.g=1,this.b=1,this.a=1,n&&n.defaultColor&&this.turnStr2Rgba(n.defaultColor),v(e))this.turnStr2Rgba(e);else if(p(e)){var i=n&&n.max||255;this.r=e[0]/i,this.g=e[1]/i,this.b=e[2]/i,this.a=_(e[3])?1:e[3]}}return(0,c.default)(t,[{key:"turnStr2Rgba",value:function(t){t=t.toLowerCase();var e=h.HEX_REG,n=h.RGB_REG,i=h.RGBA_REG,s=null;e.test(t)?s=o(t):n.test(t)?s=r(t):i.test(t)&&(s=a(t)),s&&(this.r=s.r/255,this.g=s.g/255,this.b=s.b/255,this.a=_(s.a)?1:s.a)}},{key:"toArray",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"toUpArray",value:function(){return this.toArray().map(function(t){return 255*t})}},{key:"toString",value:function(){return"rgba("+[""+Math.round(255*this.r),""+Math.round(255*this.g),""+Math.round(255*this.b),""+this.a].join(",")+")"}}]),t}();e.default=m},function(t,e,n){"use strict";var i=n(12),o=n(34),r=n(76),a=n(45),s=n(31),l=n(80),u=Object.assign;t.exports=!u||n(30)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=i})?function(t,e){for(var n=s(t),u=arguments.length,c=1,f=r.f,d=a.f;u>c;)for(var h,v=l(arguments[c++]),p=f?o(v).concat(f(v)):o(v),_=p.length,m=0;_>m;)h=p[m++],i&&!d.call(v,h)||(n[h]=v[h]);return n}:u},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(231),o=n(321),r=n(136),a=n(88),s=n(522);t.exports=function(t,e){var n=1==t,l=2==t,u=3==t,c=4==t,f=6==t,d=5==t||f,h=e||s;return function(e,s,v){for(var p,_,m=r(e),g=o(m),y=i(s,v,3),x=a(g.length),b=0,S=n?h(e,x):l?h(e,0):void 0;x>b;b++)if((d||b in g)&&(p=g[b],_=y(p,b,m),t))if(n)S[b]=_;else if(_)switch(t){case 3:return!0;case 5:return p;case 6:return b;case 2:S.push(p)}else if(c)return!1;return f?-1:u||c?c:S}}},function(t,e,n){var i=n(229);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var i=n(322),o=n(268),r=n(216),a=n(254),s=n(214),l=n(526),u=Object.getOwnPropertyDescriptor;e.f=n(103)?u:function(t,e){if(t=r(t),e=a(e,!0),l)try{return u(t,e)}catch(t){}if(s(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e,n){var i=n(11),o=n(102),r=n(61);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*r(function(){n(1)}),"Object",a)}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},,,function(t,e,n){"use strict";function i(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.result,o=void 0===n?[]:n,r=e.dimensions,a=void 0===r?3:r,s=0;s<t.length;){var l=t[s];Array.isArray(l)||ArrayBuffer.isView(l)?i(l,{result:o,dimensions:a}):o.push(l.lng,l.lat),s+=1}return o}function o(t,e){var n=t.getBounds();return n.covers(e)||n.intersects(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.isInFrustum=o,e.default={to3DVertices:function(t,e){e=e||0;for(var n=[],i=0,o=t.length/2;i<o;i++)n.push(t[2*i],t[2*i+1],e,1);return n},mixCoords:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=[];if(i=i||0,n)for(var a=0,s=t.length/2;a<s;a++)r.push([t[2*a]*o+i,-1*t[2*a+1]*o+i].concat(n));else for(var l=0,u=t.length/2;l<u;l++)r.push([t[2*l]*o+i,-1*t[2*l+1]*o+i,0,1]);return"polygon"===e&&r.push(r[0]),r},flattenVertices:i,fillArray:function(t){for(var e=t.target,n=t.source,i=t.start,o=void 0===i?0:i,r=t.count,a=void 0===r?1:r,s=n.length,l=a*s,u=0,c=o;u<s;u++)e[c]=n[u],c+=1;for(;u<l;)u<l-u?(e.copyWithin(o+u,o,o+u),u*=2):(e.copyWithin(o+u,o,o+l-u),u=l);return e}}},,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?[t+1&255,t+1>>8&255,t+1>>8>>8&255,255]:[t+1&255,t+1>>8&255,t+1>>8>>8&255]}function r(t){var e=(0,h.default)(t,3);return e[0]+256*e[1]+65536*e[2]-1}function a(t){for(var e=new f.default,n=[],i=0;i<t.length;i+=4)if(255===t[i+3]){var o=r([t[i],t[i+1],t[i+2]]),a=s(o);a&&a.id&&!e.has(a.id)&&(e.add(a.id),n.push(a))}return n}function s(t){var e=void 0;return(0,u.default)(v.styleNameConfig).forEach(function(n){(0,u.default)(v.styleNameConfig[n]).forEach(function(i){if(v.styleNameConfig[n][i].includes(t))return void(e={type:n,id:t,tag:i})})}),e}Object.defineProperty(e,"__esModule",{value:!0});var l=n(17),u=i(l),c=n(241),f=i(c),d=n(32),h=i(d);e.encodePickingColor=o,e.decodePickingColor=r,e.decodeStylePickingColor=a;var v=n(386)},function(t,e,n){t.exports={default:n(412),__esModule:!0}},function(t,e,n){n(243),t.exports=n(2).Object.assign},function(t,e,n){var i=n(6);i(i.S+i.F,"Object",{assign:n(228)})},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){"use strict";if(n(103)){var i=n(263),o=n(62),r=n(61),a=n(11),s=n(354),l=n(441),u=n(231),c=n(284),f=n(268),d=n(215),h=n(286),v=n(234),p=n(88),_=n(545),m=n(269),g=n(254),y=n(214),x=n(320),b=n(63),S=n(136),w=n(428),E=n(264),T=n(266),A=n(265).f,P=n(443),I=n(270),k=n(78),L=n(230),M=n(344),C=n(323),R=n(444),B=n(285),N=n(350),O=n(287),D=n(421),z=n(520),F=n(104),V=n(232),Y=F.f,U=V.f,j=o.RangeError,G=o.TypeError,Z=o.Uint8Array,H=Array.prototype,W=l.ArrayBuffer,X=l.DataView,Q=L(0),q=L(2),K=L(3),J=L(4),$=L(5),tt=L(6),et=M(!0),nt=M(!1),it=R.values,ot=R.keys,rt=R.entries,at=H.lastIndexOf,st=H.reduce,lt=H.reduceRight,ut=H.join,ct=H.sort,ft=H.slice,dt=H.toString,ht=H.toLocaleString,vt=k("iterator"),pt=k("toStringTag"),_t=I("typed_constructor"),mt=I("def_constructor"),gt=s.CONSTR,yt=s.TYPED,xt=s.VIEW,bt=L(1,function(t,e){return At(C(t,t[mt]),e)}),St=r(function(){return 1===new Z(new Uint16Array([1]).buffer)[0]}),wt=!!Z&&!!Z.prototype.set&&r(function(){new Z(1).set({})}),Et=function(t,e){var n=v(t);if(n<0||n%e)throw j("Wrong offset!");return n},Tt=function(t){if(b(t)&&yt in t)return t;throw G(t+" is not a typed array!")},At=function(t,e){if(!(b(t)&&_t in t))throw G("It is not a typed array constructor!");return new t(e)},Pt=function(t,e){return It(C(t,t[mt]),e)},It=function(t,e){for(var n=0,i=e.length,o=At(t,i);i>n;)o[n]=e[n++];return o},kt=function(t,e,n){Y(t,e,{get:function(){return this._d[n]}})},Lt=function(t){var e,n,i,o,r,a,s=S(t),l=arguments.length,c=l>1?arguments[1]:void 0,f=void 0!==c,d=P(s);if(void 0!=d&&!w(d)){for(a=d.call(s),i=[],e=0;!(r=a.next()).done;e++)i.push(r.value);s=i}for(f&&l>2&&(c=u(c,arguments[2],2)),e=0,n=p(s.length),o=At(this,n);n>e;e++)o[e]=f?c(s[e],e):s[e];return o},Mt=function(){for(var t=0,e=arguments.length,n=At(this,e);e>t;)n[t]=arguments[t++];return n},Ct=!!Z&&r(function(){ht.call(new Z(1))}),Rt=function(){return ht.apply(Ct?ft.call(Tt(this)):Tt(this),arguments)},Bt={copyWithin:function(t,e){return z.call(Tt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return J(Tt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return D.apply(Tt(this),arguments)},filter:function(t){return Pt(this,q(Tt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return $(Tt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(Tt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Q(Tt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(Tt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(Tt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ut.apply(Tt(this),arguments)},lastIndexOf:function(t){return at.apply(Tt(this),arguments)},map:function(t){return bt(Tt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(Tt(this),arguments)},reduceRight:function(t){return lt.apply(Tt(this),arguments)},reverse:function(){for(var t,e=this,n=Tt(e).length,i=Math.floor(n/2),o=0;o<i;)t=e[o],e[o++]=e[--n],e[n]=t;return e},some:function(t){return K(Tt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ct.call(Tt(this),t)},subarray:function(t,e){var n=Tt(this),i=n.length,o=m(t,i);return new(C(n,n[mt]))(n.buffer,n.byteOffset+o*n.BYTES_PER_ELEMENT,p((void 0===e?i:m(e,i))-o))}},Nt=function(t,e){return Pt(this,ft.call(Tt(this),t,e))},Ot=function(t){Tt(this);var e=Et(arguments[1],1),n=this.length,i=S(t),o=p(i.length),r=0;if(o+e>n)throw j("Wrong length!");for(;r<o;)this[e+r]=i[r++]},Dt={entries:function(){return rt.call(Tt(this))},keys:function(){return ot.call(Tt(this))},values:function(){return it.call(Tt(this))}},zt=function(t,e){return b(t)&&t[yt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Ft=function(t,e){return zt(t,e=g(e,!0))?f(2,t[e]):U(t,e)},Vt=function(t,e,n){return!(zt(t,e=g(e,!0))&&b(n)&&y(n,"value"))||y(n,"get")||y(n,"set")||n.configurable||y(n,"writable")&&!n.writable||y(n,"enumerable")&&!n.enumerable?Y(t,e,n):(t[e]=n.value,t)};gt||(V.f=Ft,F.f=Vt),a(a.S+a.F*!gt,"Object",{getOwnPropertyDescriptor:Ft,defineProperty:Vt}),r(function(){dt.call({})})&&(dt=ht=function(){return ut.call(this)});var Yt=h({},Bt);h(Yt,Dt),d(Yt,vt,Dt.values),h(Yt,{slice:Nt,set:Ot,constructor:function(){},toString:dt,toLocaleString:Rt}),kt(Yt,"buffer","b"),kt(Yt,"byteOffset","o"),kt(Yt,"byteLength","l"),kt(Yt,"length","e"),Y(Yt,pt,{get:function(){return this[yt]}}),t.exports=function(t,e,n,l){l=!!l;var u=t+(l?"Clamped":"")+"Array",f="get"+t,h="set"+t,v=o[u],m=v||{},g=v&&T(v),y=!v||!s.ABV,S={},w=v&&v.prototype,P=function(t,n){var i=t._d;return i.v[f](n*e+i.o,St)},I=function(t,n,i){var o=t._d;l&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),o.v[h](n*e+o.o,i,St)},k=function(t,e){Y(t,e,{get:function(){return P(this,e)},set:function(t){return I(this,e,t)},enumerable:!0})};y?(v=n(function(t,n,i,o){c(t,v,u,"_d");var r,a,s,l,f=0,h=0;if(b(n)){if(!(n instanceof W||"ArrayBuffer"==(l=x(n))||"SharedArrayBuffer"==l))return yt in n?It(v,n):Lt.call(v,n);r=n,h=Et(i,e);var m=n.byteLength;if(void 0===o){if(m%e)throw j("Wrong length!");if((a=m-h)<0)throw j("Wrong length!")}else if((a=p(o)*e)+h>m)throw j("Wrong length!");s=a/e}else s=_(n),a=s*e,r=new W(a);for(d(t,"_d",{b:r,o:h,l:a,e:s,v:new X(r)});f<s;)k(t,f++)}),w=v.prototype=E(Yt),d(w,"constructor",v)):r(function(){v(1)})&&r(function(){new v(-1)})&&N(function(t){new v,new v(null),new v(1.5),new v(t)},!0)||(v=n(function(t,n,i,o){c(t,v,u);var r;return b(n)?n instanceof W||"ArrayBuffer"==(r=x(n))||"SharedArrayBuffer"==r?void 0!==o?new m(n,Et(i,e),o):void 0!==i?new m(n,Et(i,e)):new m(n):yt in n?It(v,n):Lt.call(v,n):new m(_(n))}),Q(g!==Function.prototype?A(m).concat(A(g)):A(m),function(t){t in v||d(v,t,m[t])}),v.prototype=w,i||(w.constructor=v));var L=w[vt],M=!!L&&("values"==L.name||void 0==L.name),C=Dt.values;d(v,_t,!0),d(w,yt,u),d(w,xt,!0),d(w,mt,v),(l?new v(1)[pt]==u:pt in w)||Y(w,pt,{get:function(){return u}}),S[u]=v,a(a.G+a.W+a.F*(v!=m),S),a(a.S,u,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*r(function(){m.of.call(v,1)}),u,{from:Lt,of:Mt}),"BYTES_PER_ELEMENT"in w||d(w,"BYTES_PER_ELEMENT",e),a(a.P,u,Bt),O(u),a(a.P+a.F*wt,u,{set:Ot}),a(a.P+a.F*!M,u,Dt),i||w.toString==dt||(w.toString=dt),a(a.P+a.F*r(function(){new v(1).slice()}),u,{slice:Nt}),a(a.P+a.F*(r(function(){return[1,2].toLocaleString()!=new v([1,2]).toLocaleString()})||!r(function(){w.toLocaleString.call([1,2])})),u,{toLocaleString:Rt}),B[u]=M?L:C,i||M||d(w,vt,C)}}else t.exports=function(){}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(122),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=o.default[1]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONTROL_POSITION_STYLE=e.CONTROL_POSITION=e.MAP_APPROVAL_NUMBER=e.LOGO_URL=e.DEFAULT_CONTROL_ID=void 0;var i=n(221),o=function(t){return t&&t.__esModule?t:{default:t}}(i),r=(e.DEFAULT_CONTROL_ID={SCALE:"scale",ZOOM:"zoom",FLOOR:"floor",ROTATION:"rotation"},e.LOGO_URL={DEFAULT_LOGO:"https://mapapi.qq.com/web/jsapi/logo/logo_def.png",GRAY_LOGO:"https://mapapi.qq.com/web/jsapi/logo/logo_gray.png"},e.MAP_APPROVAL_NUMBER={satellite:"GS(2022)1087",vector:"GS(2022)2224"},e.CONTROL_POSITION={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,CENTER_LEFT:3,CENTER:4,CENTER_RIGHT:5,BOTTOM_LEFT:6,BOTTOM_CENTER:7,BOTTOM_RIGHT:8});e.CONTROL_POSITION_STYLE=function(){var t={};return(0,o.default)(r).forEach(function(e){var n=e%3,i=Math.floor(e/3),o="position: absolute;";switch(i){case 0:o+="top:0px;";break;case 1:o+="top:50%;";break;case 2:o+="bottom:0px;"}switch(n){case 0:o+="left:0px;";break;case 1:o+="left:50%;";break;case 2:o+="right:0px;"}o+="transform: translate("+(1===n?"-50%":"0")+", "+(1===i?"-50%":"0")+");",t[e]=o}),t}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.TILE_STATE=void 0;var o=n(16),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(10),f=e.TILE_STATE={unloaded:"tile_unloaded",loading:"tile_loading",loaded:"tile_loaded",errored:"tile_errored",reloading:"tile_reloading",expired:"tile_expired"},d=function(){function t(e,n){(0,s.default)(this,t),this.coord=e,this.uid=c.uniqueId(),this.tileSize=n,this.state=f.loading,this.visible=!0}return(0,u.default)(t,[{key:"show",value:function(){this.visible=!0}},{key:"hide",value:function(){this.visible=!1}},{key:"setData",value:function(t){if(t&&!t.baseData&&(this.state=f.loaded),t&&t.incrementData)return void(this._data=(0,r.default)({},this._data,t));this._data=t}},{key:"updateData",value:function(t){this.setData(t)}},{key:"getData",value:function(){return this._data}},{key:"getQueryData",value:function(t){return this._data&&this.visible?t&&""!==t?this._data[t]:this._data:null}},{key:"hasData",value:function(){return this.state===f.loaded||this.state===f.reloading||this.state===f.expired}},{key:"isLoading",value:function(){return this.state===f.loading||this.state===f.reloading}},{key:"isLoaded",value:function(){return this.state===f.loaded||this.state===f.errored||this.state===f.expired}},{key:"clear",value:function(){this.unloadData()}},{key:"unloadData",value:function(){this._data=null,this.state=f.unloaded}}]),t}();e.default=d},function(t,e,n){"use strict";var i=n(8),o=n(6),r=n(40),a=n(30),s=n(19),l=n(99),u=n(71),c=n(91),f=n(7),d=n(42),h=n(14).f,v=n(259)(0),p=n(12);t.exports=function(t,e,n,_,m,g){var y=i[t],x=y,b=m?"set":"add",S=x&&x.prototype,w={};return p&&"function"==typeof x&&(g||S.forEach&&!a(function(){(new x).entries().next()}))?(x=e(function(e,n){c(e,x,t,"_c"),e._c=new y,void 0!=n&&u(n,m,e[b],e)}),v("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in S&&(!g||"clear"!=t)&&s(x.prototype,t,function(n,i){if(c(this,x,t),!e&&g&&!f(n))return"get"==t&&void 0;var o=this._c[t](0===n?0:n,i);return e?this:o})}),g||h(x.prototype,"size",{get:function(){return this._c.size}})):(x=_.getConstructor(e,t,m,b),l(x.prototype,n),r.NEED=!0),d(x,t),w[t]=x,o(o.G+o.W+o.F,w),g||_.setStrong(x,t,m),x}},function(t,e,n){"use strict";var i=n(6),o=n(44),r=n(22),a=n(71);t.exports=function(t){i(i.S,t,{from:function(t){var e,n,i,s,l=arguments[1];return o(this),e=void 0!==l,e&&o(l),void 0==t?new this:(n=[],e?(i=0,s=r(l,arguments[2],2),a(t,!1,function(t){n.push(s(t,i++))})):a(t,!1,n.push,n),new this(n))}})}},function(t,e,n){"use strict";var i=n(6);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){var i=n(270)("meta"),o=n(63),r=n(214),a=n(104).f,s=0,l=Object.isExtensible||function(){return!0},u=!n(61)(function(){return l(Object.preventExtensions({}))}),c=function(t){a(t,i,{value:{i:"O"+ ++s,w:{}}})},f=function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,i)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[i].i},d=function(t,e){if(!r(t,i)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[i].w},h=function(t){return u&&v.NEED&&l(t)&&!r(t,i)&&c(t),t},v=t.exports={KEY:i,NEED:!1,fastKey:f,getWeak:d,onFreeze:h}},function(t,e,n){var i=n(63);t.exports=function(t,e){if(!i(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!i(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!i(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!i(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var o="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var o in n)i(n,o)&&(t[o]=n[o])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,n,i,o){if(e.subarray&&t.subarray)return void t.set(e.subarray(n,n+i),o);for(var r=0;r<i;r++)t[o+r]=e[n+r]},flattenChunks:function(t){var e,n,i,o,r,a;for(i=0,e=0,n=t.length;e<n;e++)i+=t[e].length;for(a=new Uint8Array(i),o=0,e=0,n=t.length;e<n;e++)r=t[e],a.set(r,o),o+=r.length;return a}},a={arraySet:function(t,e,n,i,o){for(var r=0;r<i;r++)t[o+r]=e[n+r]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(o)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(106),p=i(v),_=n(248),m=n(10),g=n(41),y=i(g),x=y.default.isNumber,b={},S=function(t){function e(t){(0,s.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this));n.options=t;var i=t.id;return n.id=y.default.isUndefined(i)?(0,m.uniqueId)():i,n.init(t),n}return(0,h.default)(e,t),(0,u.default)(e,[{key:"init",value:function(t){this.onInit(t),this.dom=this.createDOM(t)}},{key:"setPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_.CONTROL_POSITION.TOP_LEFT;return t!==this.position&&(this.appendToContainer(t),this.position=t),this}},{key:"setClassName",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.dom&&(this.dom.className=t),this.className=t,this}},{key:"getDomPositionContainer",value:function(t){var e=t.id,n=this.options,i=n.position,o=n.className;return this.setPosition(i),this.setClassName(o),b[e][i]}},{key:"appendToContainer",value:function(t){if(!this.map||!this.map.id)return void console.error("当前没有添加该控件，请先添加控件再设置位置！");var e=this.map.id;if(b[e]||(b[e]={}),!b[e][t]){b[e][t]=document.createElement("div");var n=b[e][t];n.style.right="auto",n.style.left="auto",n.style.top="auto",n.style.bottom="auto",n.style.cssText+=_.CONTROL_POSITION_STYLE[t],_.CONTROL_POSITION.BOTTOM_LEFT,this.dom.parentNode&&this.dom.parentNode.parentNode&&this.dom.parentNode.parentNode.appendChild(n)}return b[e][t].firstChild?b[e][t].insertBefore(this.dom,b[e][t].firstChild):b[e][t].appendChild(this.dom),b[e][t]}},{key:"createDOM",value:function(){}},{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onAdd",value:function(){}},{key:"onRemove",value:function(){}},{key:"addTo",value:function(t,e){this.map=t;var n=this.getDomPositionContainer(t);e.appendChild(n),this.onAdd()}},{key:"remove",value:function(){var t=this.map&&this.map.id;if(this.dom){var e=this.dom.parentNode;this.dom.remove(),e&&!e.firstChild&&(e.remove(),e=null,x(this.position)&&t&&delete b[t][this.position]),this.position=null,this.onRemove(),this.map=null}}},{key:"destroy",value:function(){this.remove(),this.onDestroy(),this.removeAllListeners(),this.dom=null,this.className=null,this.position=null,this.id=null}}]),e}(p.default);e.default=S},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(337),p=i(v),_=n(29),m=n(41),g=i(m),y=n(143),x=n(23),b=n(106),S=n(10),w=g.default.isNumber,E=g.default.isUndefined,T=function(t){function e(t){(0,s.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this));return n.id=t.id||S.uniqueId(),n.type=t.type||null,n.sourceId=t.sourceId||null,n.setZoomRange(t.minZoom,t.maxZoom),n.setDataZoomRange(t.minDataZoom||t.minZoom,t.maxDataZoom||t.maxZoom),n.visible=!!E(t.visible)||Boolean(t.visible),n.setLevel(t.level||y.LAYER_LEVEL.GROUND),n.setZIndex(t.zIndex||0),n.setOpacity(t.opacity),n._childLayers={},n._initialize(t),t.map&&n.setMap(t.map),n}return(0,h.default)(e,t),(0,u.default)(e,[{key:"getId",value:function(){return this.id}},{key:"setVisible",value:function(t){return t=Boolean(t),this._forEachChild(function(e,n){n.setVisible(t)}),this.visible===t?this:(this.visible=t,this._fire("layer",{}),this)}},{key:"setZIndex",value:function(t){return w(t)||(new _.BaseTypeError("Layer.zIndex","number",t).error(),t=0),this._forEachChild(function(e,n){n.setZIndex(t)}),this.zIndex=t,this.setRank((0,y.getRank)(this.level,this.zIndex)),this}},{key:"setLevel",value:function(t){this.level=t,this.setRank((0,y.getRank)(this.level,this.zIndex))}},{key:"setRank",value:function(t){this.rank=t,this._forEachChild(function(e,n){n.setRank(t)}),this.emit("rank_changed")}},{key:"getRank",value:function(){return this.rank}},{key:"setMap",value:function(t){return t instanceof p.default||null===t?this.map===t?this:(this.map&&(this.map.removeLayer(this.id),this._removeSource(),this.map=null),t&&(this.map=t,t.addLayer(this),this._addSource()),this):(console.error("传入的map参数并非TMap.Map实例"),this)}},{key:"getMap",value:function(){return this.map}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"setZoomRange",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.minZoom,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x.maxZoom;return w(t)||(new _.BaseTypeError("Layer.minZoom","number",t).error(),t=x.minZoom),w(e)||(new _.BaseTypeError("Layer.maxZoom","number",e).error(),e=x.maxZoom),this._forEachChild(function(n,i){i.setZoomRange(t,e)}),this.minZoom=t,this.maxZoom=e,this}},{key:"setDataZoomRange",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.minZoom,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x.maxZoom;return w(t)||(new _.BaseTypeError("Layer.minDataZoom","number",t).error(),t=x.minZoom),w(e)||(new _.BaseTypeError("Layer.maxDataZoom","number",e).error(),e=x.maxZoom),this._forEachChild(function(n,i){i.setDataZoomRange(t,e)}),this.minDataZoom=t,this.maxDataZoom=e,this}},{key:"setOpacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return w(t)||(new _.BaseTypeError("Layer.opacity","number",t).error(),t=1),(t<0||t>1)&&(console.error("Layer.opacity 传入参数值范围应当在0~1之间！"),t=S.clamp(t,0,1)),this.opacity=t,this}},{key:"_removeSource",value:function(){}},{key:"_addSource",value:function(){}},{key:"_initialize",value:function(){}},{key:"isHidden",value:function(t){return!!(this.minZoom&&t<this.minZoom)||(!!(this.maxZoom&&t>this.maxZoom)||!this.visible)}},{key:"appendChild",value:function(t){var n=t instanceof e?t:new e(t);return n.setMap(null),n.setZIndex(this.zIndex),n.setRank(this.rank),n.setZoomRange(this.minZoom,this.maxZoom),n.setVisible(this.visible),this._childLayers[n.id]=n,n}},{key:"removeChild",value:function(t){this._childLayers[t]&&delete this._childLayers[t]}},{key:"hasChild",value:function(t){return!!this._childLayers[t]}},{key:"getChild",value:function(t){return this.hasChild(t)?this._childLayers[t]:null}},{key:"_forEachChild",value:function(t){S.forIn(this._childLayers,function(e,n){t(e,n)})}},{key:"flat",value:function(){var t=[];return this.sourceId&&t.push(this),this._forEachChild(function(e,n){t=t.concat(n.flat())}),t}}]),e}(b);e.default=T},,function(t,e,n){var i=n(22),o=n(80),r=n(31),a=n(52),s=n(312);t.exports=function(t,e){var n=1==t,l=2==t,u=3==t,c=4==t,f=6==t,d=5==t||f,h=e||s;return function(e,s,v){for(var p,_,m=r(e),g=o(m),y=i(s,v,3),x=a(g.length),b=0,S=n?h(e,x):l?h(e,0):void 0;x>b;b++)if((d||b in g)&&(p=g[b],_=y(p,b,m),t))if(n)S[b]=_;else if(_)switch(t){case 3:return!0;case 5:return p;case 6:return b;case 2:S.push(p)}else if(c)return!1;return f?-1:u||c?c:S}}},function(t,e,n){"use strict";var i=n(14).f,o=n(51),r=n(99),a=n(22),s=n(91),l=n(71),u=n(72),c=n(108),f=n(119),d=n(12),h=n(40).fastKey,v=n(183),p=d?"_s":"size",_=function(t,e){var n,i=h(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,u){var c=t(function(t,i){s(t,c,e,"_i"),t._t=e,t._i=o(null),t._f=void 0,t._l=void 0,t[p]=0,void 0!=i&&l(i,n,t[u],t)});return r(c.prototype,{clear:function(){for(var t=v(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[p]=0},delete:function(t){var n=v(this,e),i=_(n,t);if(i){var o=i.n,r=i.p;delete n._i[i.i],i.r=!0,r&&(r.n=o),o&&(o.p=r),n._f==i&&(n._f=o),n._l==i&&(n._l=r),n[p]--}return!!i},forEach:function(t){v(this,e);for(var n,i=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!_(v(this,e),t)}}),d&&i(c.prototype,"size",{get:function(){return v(this,e)[p]}}),c},def:function(t,e,n){var i,o,r=_(t,e);return r?r.v=n:(t._l=r={i:o=h(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=r),i&&(i.n=r),t[p]++,"F"!==o&&(t._i[o]=r)),t},getEntry:_,setStrong:function(t,e,n){u(t,e,function(t,n){this._t=v(t,e),this._k=n,this._l=void 0},function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?"keys"==e?c(0,n.k):"values"==e?c(0,n.v):c(0,[n.k,n.v]):(t._t=void 0,c(1))},n?"entries":"values",!n,!0),f(e)}}},function(t,e,n){var i=n(49),o=n(310);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return o(this)}}},function(t,e,n){var i=n(78)("unscopables"),o=Array.prototype;void 0==o[i]&&n(215)(o,i,{}),t.exports=function(t){o[i][t]=!0}},function(t,e){t.exports=!1},function(t,e,n){var i=n(60),o=n(535),r=n(424),a=n(435)("IE_PROTO"),s=function(){},l=function(){var t,e=n(423)("iframe"),i=r.length;for(e.style.display="none",n(426).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;i--;)delete l.prototype[r[i]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=i(t),n=new s,s.prototype=null,n[a]=t):n=l(),void 0===e?n:o(n,e)}},function(t,e,n){var i=n(537),o=n(424).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,o)}},function(t,e,n){var i=n(214),o=n(136),r=n(435)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),i(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var i=n(537),o=n(424);t.exports=Object.keys||function(t){return i(t,o)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(234),o=Math.max,r=Math.min;t.exports=function(t,e){return t=i(t),t<0?o(t+e,0):r(t,e)}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e,n){var i=n(63);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){!function(i,o,r){t.exports=e=o(n(50),n(446),n(445))}(0,function(t){return function(){var e=t,n=e.lib,i=n.Base,o=n.WordArray,r=e.algo,a=r.MD5,s=r.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:a,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n=this.cfg,i=n.hasher.create(),r=o.create(),a=r.words,s=n.keySize,l=n.iterations;a.length<s;){u&&i.update(u);var u=i.update(t).finalize(e);i.reset();for(var c=1;c<l;c++)u=i.finalize(u),i.reset();r.concat(u)}return r.sigBytes=4*s,r}});e.EvpKDF=function(t,e,n){return s.create(n).compute(t,e)}}(),t.EvpKDF})},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},o=0;o<this.length;o++){var r=this[o][0];"number"==typeof r&&(i[r]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},,function(t,e){function n(t,e){for(var n=0;n<t.length;n++){var i=t[n],o=d[i.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](i.parts[r]);for(;r<i.parts.length;r++)o.parts.push(l(i.parts[r],e))}else{for(var a=[],r=0;r<i.parts.length;r++)a.push(l(i.parts[r],e));d[i.id]={id:i.id,refs:1,parts:a}}}}function i(t){for(var e=[],n={},i=0;i<t.length;i++){var o=t[i],r=o[0],a=o[1],s=o[2],l=o[3],u={css:a,media:s,sourceMap:l};n[r]?n[r].parts.push(u):e.push(n[r]={id:r,parts:[u]})}return e}function o(t,e){var n=p(),i=g[g.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),g.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function r(t){t.parentNode.removeChild(t);var e=g.indexOf(t);e>=0&&g.splice(e,1)}function a(t){var e=document.createElement("style");return e.type="text/css",o(t,e),e}function s(t){var e=document.createElement("link");return e.rel="stylesheet",o(t,e),e}function l(t,e){var n,i,o;if(e.singleton){var l=m++;n=_||(_=a(e)),i=u.bind(null,n,l,!1),o=u.bind(null,n,l,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(e),i=f.bind(null,n),o=function(){r(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(e),i=c.bind(null,n),o=function(){r(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else o()}}function u(t,e,n,i){var o=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=y(e,o);else{var r=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(r,a[e]):t.appendChild(r)}}function c(t,e){var n=e.css,i=e.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function f(t,e){var n=e.css,i=e.sourceMap;i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var o=new Blob([n],{type:"text/css"}),r=t.href;t.href=URL.createObjectURL(o),r&&URL.revokeObjectURL(r)}var d={},h=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}},v=h(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),p=h(function(){return document.head||document.getElementsByTagName("head")[0]}),_=null,m=0,g=[];t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},void 0===e.singleton&&(e.singleton=v()),void 0===e.insertAt&&(e.insertAt="bottom");var o=i(t);return n(o,e),function(t){for(var r=[],a=0;a<o.length;a++){var s=o[a],l=d[s.id];l.refs--,r.push(l)}if(t){n(i(t),e)}for(var a=0;a<r.length;a++){var l=r[a];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete d[l.id]}}}};var y=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LIGHT_FRAG=e.LIGHT_VERTEX=e.LIGHT_VARYING=e.LIGHT_UNIFORM=void 0;var i=n(330),o=function(t){return t&&t.__esModule?t:{default:t}}(i),r=o.default?"\nvec4 lighting_apply_on_color(vec4 color) {\n\tfloat isInShadow = isInShadow();\n\tvec3 colorInLight = color.rgb * mix(\n\t\tlighting_vLightWeight,\n\t\tlighting_vLightWeight - lighting_vShadowWeight,\n\t\tisInShadow\n\t) + mix(\n\t\tlighting_vLightSpecular,\n\t\tlighting_vLightSpecular - lighting_vShadowSpecular,\n\t\tisInShadow\n\t);\n\tcolorInLight = mix(\n\t\tcolorInLight,\n\t\ttoneMapping(colorInLight, lighting_vToneMapping.y),\n\t\tlighting_vToneMapping.x\n\t);\n\treturn vec4(colorInLight, color.a);\n}\n":"\nvec4 lighting_apply_on_color(vec4 color) {\n\tvec3 colorInLight = color.rgb * lighting_vLightWeight + lighting_vLightSpecular;\n\treturn vec4(colorInLight, color.a);\n}\n";e.LIGHT_UNIFORM="\n#define LIGHT_MAX 4\n\n\nuniform vec4 lighting_uBase;\nuniform vec4 lighting_uAdvanced;\nuniform vec3 lighting_uAmbientColor;\nuniform vec3 lighting_uDirDirection[LIGHT_MAX];\nuniform vec3 lighting_uDirColor[LIGHT_MAX];\nuniform vec3 lighting_uPointPosition[LIGHT_MAX];\nuniform vec3 lighting_uPointAtt[LIGHT_MAX];\nuniform vec3 lighting_uPointColor[LIGHT_MAX];\nuniform vec2 lighting_uLightCount;\nuniform vec3 lighting_uViewPos;\nuniform mat4 lighting_uShadowLightPVMatrix;\n",e.LIGHT_VARYING="\n\nvarying vec3 lighting_vLightWeight;\nvarying vec3 lighting_vLightSpecular;\nvarying vec3 lighting_vShadowWeight;\nvarying vec3 lighting_vShadowSpecular;\nvarying mediump vec4 lighting_vShadowInfo;\nvarying vec2 lighting_vToneMapping;\n",e.LIGHT_VERTEX="\nvec3 lighting_vPosition;\nvec3 lighting_vNormal;\nvec3 lighting_vViewDir;\nvec2 lighting_vObjSpec;\n\n\nfloat lighting_calcDiffuse(vec3 lightDir) {\n\treturn max(dot(lightDir, lighting_vNormal), 0.);\n}\n\n\nfloat lighting_calcSpecular(vec3 lightDir) {\n\t\n\t\n\t\n\t\n\tvec3 halfwayDir = normalize(lighting_vViewDir + lightDir);\n\tfloat reflectStrength = max(dot(halfwayDir, lighting_vNormal), 0.);\n\n\treturn pow(reflectStrength, lighting_vObjSpec.y) * lighting_vObjSpec.x;\n}\n\n\nvoid lighting_setObjInfo(vec3 position, vec3 normal, mat4 modelMatrix, vec2 objSpec) {\n\tlighting_vPosition = (modelMatrix * vec4(position, 1.)).xyz;\n\tlighting_vNormal = normalize(modelMatrix * vec4(normal, 0.)).xyz;\n\tlighting_vViewDir = normalize(lighting_uViewPos - lighting_vPosition);\n\tlighting_vObjSpec = objSpec;\n\tlighting_vToneMapping = lighting_uAdvanced.xy;\n\t\n\tvec4 posInLightView = lighting_uShadowLightPVMatrix * vec4(lighting_vPosition, 1.0);\n\tvec3 normalized = (posInLightView.xyz/ posInLightView.w + 1.0) / 2.0;\n\tlighting_vShadowInfo = vec4(normalized, lighting_uAdvanced.z);\n}\n\n\nvoid lighting_calcDirLights(float enable) {\n\tvec3 diffuse = vec3(0.0);\n\tvec3 specular = vec3(0.0);\n\tvec3 shadowDiffuse = vec3(0.0);\n\tvec3 shadowSpecular = vec3(0.0);\n\n\tfor (int i = 0; i < LIGHT_MAX; i++) {\n\t\tfloat isValid = (1.0 - step(float(lighting_uLightCount.x), float(i))) * enable;\n\n\t\t\n\t\tdiffuse += mix(\n\t\t\tvec3(0.0),\n\t\t\tlighting_calcDiffuse(lighting_uDirDirection[i]) * lighting_uDirColor[i],\n\t\t\tisValid\n\t\t);\n\t\t\n\t\t\n\t\tspecular += mix(\n\t\t\tvec3(0.0),\n\t\t\tlighting_calcSpecular(lighting_uDirDirection[i]) * lighting_uDirColor[i],\n\t\t\tisValid\n\t\t);\n\n\t\t\n\t\tfloat isShadowLight = isValid * step(0., lighting_uAdvanced.z) * float((float(i) == lighting_uAdvanced.w));\n\t\tshadowDiffuse += mix(\n\t\t\tvec3(0.0),\n\t\t\tlighting_calcDiffuse(lighting_uDirDirection[i]) * lighting_uDirColor[i],\n\t\t\tisShadowLight\n\t\t);\n\t\tshadowSpecular += mix(\n\t\t\tvec3(0.0),\n\t\t\tlighting_calcSpecular(lighting_uDirDirection[i]) * lighting_uDirColor[i],\n\t\t\tisShadowLight\n\t\t);\n\t}\n\n\tlighting_vLightWeight += diffuse * lighting_uBase.z;\n\tlighting_vLightSpecular += specular * lighting_uBase.w;\n\tlighting_vShadowWeight = shadowDiffuse * lighting_uBase.z * lighting_uAdvanced.z;\n\tlighting_vShadowSpecular = shadowSpecular * lighting_uBase.w * lighting_uAdvanced.z;\n}\n\n\nvoid lighting_calcPointLights(float enable) {\n\tvec3 diffuse = vec3(0.0);\n\tvec3 specular = vec3(0.0);\n\n\tfor (int i = 0; i < LIGHT_MAX; i++) {\n\t\tfloat isValid = (1.0 - step(float(lighting_uLightCount.y), float(i))) * enable;\n\n\t\tvec3 posToLight = lighting_uPointPosition[i] - lighting_vPosition;\n\t\tvec3 direction = normalize(posToLight);\n\t\tfloat distance = length(posToLight);\n\t\t\n\t\t\n\t\tfloat attenuation = 1.0 / dot(vec3(1.0, 0.014, 0.0007), vec3(1.0, distance, distance * distance));\n\n\t\t\n\t\tdiffuse += mix(\n\t\t\tvec3(0.0),\n\t\t\tlighting_calcDiffuse(direction) * lighting_uPointColor[i] * attenuation,\n\t\t\tisValid\n\t\t);\n\t\t\n\t\t\n\t\tspecular += mix(\n\t\t\tvec3(0.0),\n\t\t\tlighting_calcSpecular(direction) * lighting_uPointColor[i] * attenuation,\n\t\t\tisValid\n\t\t);\n\t}\n\n\tlighting_vLightWeight += diffuse * lighting_uBase.z;\n\tlighting_vLightSpecular += specular * lighting_uBase.w;\n}\n\n\nvoid lighting_apply_on_vertex(vec3 position, vec3 normal, mat4 modelMatrix, vec2 objSpec) {\n\tlighting_setObjInfo(position, normal, modelMatrix, objSpec);\n\n\t\n\tlighting_vLightWeight = mix(\n\t\tvec3(1.0),\n\t\tlighting_uAmbientColor * lighting_uBase.y,\n\t\tlighting_uBase.x\n\t);\n\tlighting_vLightSpecular = vec3(0.0);\n\tlighting_vShadowWeight = vec3(0.0);\n\tlighting_vShadowSpecular = vec3(0.0);\n\n\t\n\tlighting_calcDirLights(lighting_uBase.x);\n\tlighting_calcPointLights(lighting_uBase.x);\n}\n\nvoid lighting_apply_on_vertex(vec3 position, vec3 normal, mat4 modelMatrix) {\n\tlighting_apply_on_vertex(position, normal, modelMatrix, vec2(0.4, 32.0));\n}\n",e.LIGHT_FRAG="\nuniform sampler2D lighting_uShadowSampler;\n\nvec3 toneMapping(vec3 hdrColor, float exposure) {\n\tconst float gamma = 2.2;\n\n\n\tvec3 mapped = vec3(1.0) - exp(-hdrColor * exposure);\n\t\n\n\tmapped = pow(mapped, vec3(1.0 / gamma));\n\t\n\treturn mapped;\n}\n\nfloat getShadowSceneDepth() {\n\treturn texture2D(lighting_uShadowSampler, lighting_vShadowInfo.xy).x;\n}\n\nfloat isInShadow() {\n  float isInSideTexture = float(abs(lighting_vShadowInfo.x - 0.5) < 0.5 && abs(lighting_vShadowInfo.y - 0.5) < 0.5);\n\tfloat sceneDepth = getShadowSceneDepth();\n\treturn mix(\n\t\t0.0,\n\t\tstep(0.0005, abs(lighting_vShadowInfo.z - sceneDepth)) * step(sceneDepth, lighting_vShadowInfo.z),\n\t\tstep(0., lighting_vShadowInfo.w) * isInSideTexture\n  );\n}\n\n"+r+"\n"},function(t,e,n){"use strict";function i(t){var e=t.geometries.map(function(t){return t.paths||[]}),n=new o.PolygonParseHelper({complexPolygons:e,IndexType:Uint32Array});n.updatePositions({fp64:!0,extruded:!0});var i=n.getPositions(),r=n.getIndices(),s=n.getPositions64xyLow(),l=n.getVertexValid(),u=n.getPickingColors(),c=n.getElevations({getElevation:function(e){var n=t.geometries[e],i=t.styles[n.styleId];return i&&i.extrudeHeight?i.extrudeHeight:0}}),f=n.getColors({key:"fillColors",getColor:function(e){var n=t.geometries[e],i=t.styles[n.styleId];if(i){return new a.default(i.color).toUpArray()}return[0,0,0,0]}}),d=n.getColors({key:"lineColors",getColor:function(e){var n=t.geometries[e],i=t.styles[n.styleId];if(i){if(i.showBorder){var o=new a.default(i.borderColor);return"borderWidth"in i?[0,0,0,0]:o.toUpArray()}return[0,0,0,0]}return[0,0,0,0]}}),h=i.slice(3),v=s.slice(2),p=i.slice(),_=s.slice();return p.set(h),_.set(v),{positions:i,indices:r,positions64xyLow:s,vertexValid:l,pickingColors:u,elevations:c,fillColors:f,lineColors:d,nextPositions:p,nextPositions64xyLow:_}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(333),r=n(227),a=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=i},function(t,e,n){"use strict";function i(t,e,n,i){n=n||2;var r=e&&e.length,s=r?e[0]*n:t.length,l=o(t,0,s,n,!0),u=[];if(!l)return u;var c=void 0,d=void 0,h=void 0,v=void 0,p=void 0,_=void 0,m=void 0;if(r&&(l=f(t,e,l,n)),t.length>80*n){var g=(0,R.default)(t,2);h=g[0],v=g[1],c=h,d=v;for(var y=n;y<s;y+=n)p=t[y],_=t[y+1],p<c&&(c=p),_<d&&(d=_),p>h&&(h=p),_>v&&(v=_);m=Math.max(h-c,v-d)}return a(l,u,n,c,d,m,void 0,i),u}function o(t,e,n,i,o){var r=void 0,a=void 0;if(o===M(t,e,n,i)>0)for(r=e;r<n;r+=i)a=I(r,t[r],t[r+1],a);else for(r=n-i;r>=e;r-=i)a=I(r,t[r],t[r+1],a);return a&&S(a,a.next)&&(k(a),a=a.next),a}function r(t,e){if(!t)return t;e||(e=t);var n=t,i=void 0;do{if(i=!1,n.steiner||!S(n,n.next)&&0!==b(n.prev,n,n.next))n=n.next;else{if(k(n),e=n.prev,(n=e)===n.next)return null;i=!0}}while(i||n!==e);return e}function a(t,e,n,i,o,f,d,h){if(h=h||0,t){!d&&f&&p(t,i,o,f);for(var v=t,_=void 0,m=void 0;t.prev!==t.next;)if(_=t.prev,m=t.next,f?l(t,i,o,f):s(t))e.push(_.i/n+h),e.push(t.i/n+h),e.push(m.i/n+h),k(t),t=m.next,v=m.next;else if((t=m)===v){d?1===d?(t=u(t,e,n,h),a(t,e,n,i,o,f,2,h)):2===d&&c(t,e,n,i,o,f,h):a(r(t),e,n,i,o,f,1,h);break}}}function s(t){var e=t.prev,n=t,i=t.next;if(b(e,n,i)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(y(e.x,e.y,n.x,n.y,i.x,i.y,o.x,o.y)&&b(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function l(t,e,n,i){var o=t.prev,r=t,a=t.next;if(b(o,r,a)>=0)return!1;for(var s=o.x<r.x?o.x<a.x?o.x:a.x:r.x<a.x?r.x:a.x,l=o.y<r.y?o.y<a.y?o.y:a.y:r.y<a.y?r.y:a.y,u=o.x>r.x?o.x>a.x?o.x:a.x:r.x>a.x?r.x:a.x,c=o.y>r.y?o.y>a.y?o.y:a.y:r.y>a.y?r.y:a.y,f=m(s,l,e,n,i),d=m(u,c,e,n,i),h=t.nextZ;h&&h.z<=d;){if(h!==t.prev&&h!==t.next&&y(o.x,o.y,r.x,r.y,a.x,a.y,h.x,h.y)&&b(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(h=t.prevZ;h&&h.z>=f;){if(h!==t.prev&&h!==t.next&&y(o.x,o.y,r.x,r.y,a.x,a.y,h.x,h.y)&&b(h.prev,h,h.next)>=0)return!1;h=h.prevZ}return!0}function u(t,e,n,i){var o=t;do{var r=o.prev,a=o.next.next;!S(r,a)&&w(r,o,o.next,a)&&T(r,a)&&T(a,r)&&(e.push(r.i/n+i),e.push(o.i/n+i),e.push(a.i/n+i),k(o),k(o.next),t=a,o=t),o=o.next}while(o!==t);return o}function c(t,e,n,i,o,s,l){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&x(u,c)){var f=P(u,c);return u=r(u,u.next),f=r(f,f.next),a(u,e,n,i,o,s,void 0,l),void a(f,e,n,i,o,s,void 0,l)}c=c.next}u=u.next}while(u!==t)}function f(t,e,n,i){var a=[],s=void 0,l=void 0,u=void 0,c=void 0,f=void 0;for(s=0,l=e.length;s<l;s++)u=e[s]*i,c=s<l-1?e[s+1]*i:t.length,f=o(t,u,c,i,!1),f===f.next&&(f.steiner=!0),a.push(g(f));for(a.sort(d),s=0;s<a.length;s++)h(a[s],n),n=r(n,n.next);return n}function d(t,e){return t.x-e.x}function h(t,e){if(e=v(t,e)){var n=P(e,t);r(n,n.next)}}function v(t,e){var n=e,i=t.x,o=t.y,r=-1/0,a=void 0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>r){if(r=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}a=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!a)return null;if(i===r)return a.prev;var l=a,u=a.x,c=a.y,f=1/0,d=void 0;for(n=a.next;n!==l;)i>=n.x&&n.x>=u&&i!==n.x&&y(o<c?i:r,o,u,c,o<c?r:i,o,n.x,n.y)&&((d=Math.abs(o-n.y)/(i-n.x))<f||d===f&&n.x>a.x)&&T(n,t)&&(a=n,f=d),n=n.next;return a}function p(t,e,n,i){var o=t;do{null===o.z&&(o.z=m(o.x,o.y,e,n,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,_(o)}function _(t){var e=void 0,n=void 0,i=void 0,o=void 0,r=void 0,a=void 0,s=void 0,l=void 0,u=1;do{for(n=t,t=null,r=null,a=0;n;){for(a+=1,i=n,s=0,e=0;e<u&&(s+=1,i=i.nextZ);e++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(o=n,n=n.nextZ,s-=1):(o=i,i=i.nextZ,l-=1),r?r.nextZ=o:t=o,o.prevZ=r,r=o;n=i}r&&(r.nextZ=null),u*=2}while(a>1);return t}function m(t,e,n,i,o){return t=32767*(t-n)/o,e=32767*(e-i)/o,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function g(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,i,o,r,a,s){return(o-a)*(e-s)-(t-a)*(r-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(r-s)-(o-a)*(i-s)>=0}function x(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!E(t,e)&&T(t,e)&&T(e,t)&&A(t,e)}function b(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function S(t,e){return t.x===e.x&&t.y===e.y}function w(t,e,n,i){return!!(S(t,e)&&S(n,i)||S(t,i)&&S(n,e))||b(t,e,n)>0!=b(t,e,i)>0&&b(n,i,t)>0!=b(n,i,e)>0}function E(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&w(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function T(t,e){return b(t.prev,t,t.next)<0?b(t,e,t.next)>=0&&b(t,t.prev,e)>=0:b(t,e,t.prev)<0||b(t,t.next,e)<0}function A(t,e){var n=t,i=!1,o=(t.x+e.x)/2,r=(t.y+e.y)/2;do{n.y>r!=n.next.y>r&&n.next.y!==n.y&&o<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}function P(t,e){var n=new L(t.i,t.x,t.y),i=new L(e.i,e.x,e.y),o=t.next,r=e.prev;return t.next=e,e.prev=t,n.next=o,o.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function I(t,e,n,i){var o=new L(t,e,n);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function k(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function L(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(t,e,n,i){for(var o=0,r=e,a=n-i;r<n;r+=i)o+=(t[a]-t[r])*(t[r+1]+t[a+1]),a=r;return o}var C=n(32),R=function(t){return t&&t.__esModule?t:{default:t}}(C);t.exports=i,i.deviation=function(t,e,n,i){var o=e&&e.length,r=o?e[0]*n:t.length,a=Math.abs(M(t,0,r,n));if(o)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,c=s<l-1?e[s+1]*n:t.length;a-=Math.abs(M(t,u,c,n))}for(var f=0,d=0;d<i.length;d+=3){var h=i[d]*n,v=i[d+1]*n,p=i[d+2]*n;f+=Math.abs((t[h]-t[p])*(t[v+1]-t[h+1])-(t[h]-t[v])*(t[p+1]-t[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,o=0;o<t.length;o++){for(var r=0;r<t[o].length;r++)for(var a=0;a<e;a++)n.vertices.push(t[o][r][a]);o>0&&(i+=t[o-1].length,n.holes.push(i))}return n}},,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=i(o),a=n(1),s=i(a),l=n(10),u=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.default)(this,t),e&&(this.gl=e,this.id=n.id||"resource-"+(0,l.uniqueId)(),this._object=this._onCreate(n),this._initialize(n))}return(0,s.default)(t,[{key:"delete",value:function(){this._onDelete(),this._object=null,this.gl=null}},{key:"_onCreate",value:function(){}},{key:"_onDelete",value:function(){}},{key:"_initialize",value:function(){}},{key:"bind",value:function(){}},{key:"unbind",value:function(){}}]),t}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TRAFFIC_LAYER_ID=e.SATELLITE_LAYER_ID=e.VECTOR_LAYER_ID=e.DEFAULT_BASEMAP=e.TRAFFIC_FEATURE=e.SATELLITE_FEATURE=e.TRAFFIC_ROAD_TYPE=e.MAP_TYPE=void 0;var i=n(17),o=function(t){return t&&t.__esModule?t:{default:t}}(i),r=n(66),a=e.MAP_TYPE={vector:"vector",satellite:"satellite",traffic:"traffic",handdraw:"handdraw",oversea:"oversea"},s=e.TRAFFIC_ROAD_TYPE={highway:1,motorway:2,national:3,provincial:4,county:5,country:6,other:7},l=e.SATELLITE_FEATURE={satellite:"base",road:"road"},u=e.TRAFFIC_FEATURE={base:"base",flow:"flow"};e.DEFAULT_BASEMAP={vector:{type:a.vector,features:[r.BASE_LAYER_TYPE.base,r.BASE_LAYER_TYPE.building3d,r.BASE_LAYER_TYPE.point,r.BASE_LAYER_TYPE.label,r.BASE_LAYER_TYPE.arrow]},satellite:{type:a.satellite,features:[l.satellite,l.road]},traffic:{type:a.traffic,features:[u.base],filter:(0,o.default)(s)},handdraw:{type:a.handdraw},oversea:{type:a.oversea}},e.VECTOR_LAYER_ID={base:"vector_bottom",arrow:"vector_bottom_arrow",building:"vector_top_building",poi:"vector_top_poi"},e.SATELLITE_LAYER_ID={base:"satellite",road:"road"},e.TRAFFIC_LAYER_ID={base:"traffic_base",flow:"traffic_flow"}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(25),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(t){return function(){var e=t.apply(this,arguments);return new o.default(function(t,n){function i(r,a){try{var s=e[r](a),l=s.value}catch(t){return void n(t)}if(!s.done)return o.default.resolve(l).then(function(t){i("next",t)},function(t){i("throw",t)});t(l)}return i("next")})}}},function(t,e,n){t.exports=n(402)},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e){t.exports={}},function(t,e,n){var i=n(206);t.exports=function(t,e,n){for(var o in e)i(t,o,e[o],n);return t}},function(t,e,n){"use strict";var i=n(62),o=n(104),r=n(103),a=n(78)("species");t.exports=function(t){var e=i[t];r&&e&&!e[a]&&o.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i=n(104).f,o=n(214),r=n(78)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,r)&&i(t,r,{configurable:!0,value:e})}},function(t,e,n){var i=n(11),o=n(245),r=n(61),a=n(439),s="["+a+"]",l="​",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),f=function(t,e,n){var o={},s=r(function(){return!!a[t]()||l[t]()!=l}),u=o[t]=s?e(d):a[t];n&&(o[n]=u),i(i.P+i.F*s,"String",o)},d=f.trim=function(t,e){return t=String(o(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(c,"")),t};t.exports=f},function(t,e,n){!function(i,o){t.exports=e=o(n(50))}(0,function(t){return function(){function e(t,e,n){for(var i=[],r=0,a=0;a<e;a++)if(a%4){var s=n[t.charCodeAt(a-1)]<<a%4*2,l=n[t.charCodeAt(a)]>>>6-a%4*2;i[r>>>2]|=(s|l)<<24-r%4*8,r++}return o.create(i,r)}var n=t,i=n.lib,o=i.WordArray,r=n.enc;r.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var o=[],r=0;r<n;r+=3)for(var a=e[r>>>2]>>>24-r%4*8&255,s=e[r+1>>>2]>>>24-(r+1)%4*8&255,l=e[r+2>>>2]>>>24-(r+2)%4*8&255,u=a<<16|s<<8|l,c=0;c<4&&r+.75*c<n;c++)o.push(i.charAt(u>>>6*(3-c)&63));var f=i.charAt(64);if(f)for(;o.length%4;)o.push(f);return o.join("")},parse:function(t){var n=t.length,i=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var r=0;r<i.length;r++)o[i.charCodeAt(r)]=r}var a=i.charAt(64);if(a){var s=t.indexOf(a);-1!==s&&(n=s)}return e(t,n,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),t.enc.Base64})},function(t,e,n){!function(i,o){t.exports=e=o(n(50))}(0,function(t){return function(e){function n(t,e,n,i,o,r,a){var s=t+(e&n|~e&i)+o+a;return(s<<r|s>>>32-r)+e}function i(t,e,n,i,o,r,a){var s=t+(e&i|n&~i)+o+a;return(s<<r|s>>>32-r)+e}function o(t,e,n,i,o,r,a){var s=t+(e^n^i)+o+a;return(s<<r|s>>>32-r)+e}function r(t,e,n,i,o,r,a){var s=t+(n^(e|~i))+o+a;return(s<<r|s>>>32-r)+e}var a=t,s=a.lib,l=s.WordArray,u=s.Hasher,c=a.algo,f=[];!function(){for(var t=0;t<64;t++)f[t]=4294967296*e.abs(e.sin(t+1))|0}();var d=c.MD5=u.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var a=0;a<16;a++){var s=e+a,l=t[s];t[s]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var u=this._hash.words,c=t[e+0],d=t[e+1],h=t[e+2],v=t[e+3],p=t[e+4],_=t[e+5],m=t[e+6],g=t[e+7],y=t[e+8],x=t[e+9],b=t[e+10],S=t[e+11],w=t[e+12],E=t[e+13],T=t[e+14],A=t[e+15],P=u[0],I=u[1],k=u[2],L=u[3];P=n(P,I,k,L,c,7,f[0]),L=n(L,P,I,k,d,12,f[1]),k=n(k,L,P,I,h,17,f[2]),I=n(I,k,L,P,v,22,f[3]),P=n(P,I,k,L,p,7,f[4]),L=n(L,P,I,k,_,12,f[5]),k=n(k,L,P,I,m,17,f[6]),I=n(I,k,L,P,g,22,f[7]),P=n(P,I,k,L,y,7,f[8]),L=n(L,P,I,k,x,12,f[9]),k=n(k,L,P,I,b,17,f[10]),I=n(I,k,L,P,S,22,f[11]),P=n(P,I,k,L,w,7,f[12]),L=n(L,P,I,k,E,12,f[13]),k=n(k,L,P,I,T,17,f[14]),I=n(I,k,L,P,A,22,f[15]),P=i(P,I,k,L,d,5,f[16]),L=i(L,P,I,k,m,9,f[17]),k=i(k,L,P,I,S,14,f[18]),I=i(I,k,L,P,c,20,f[19]),P=i(P,I,k,L,_,5,f[20]),L=i(L,P,I,k,b,9,f[21]),k=i(k,L,P,I,A,14,f[22]),I=i(I,k,L,P,p,20,f[23]),P=i(P,I,k,L,x,5,f[24]),L=i(L,P,I,k,T,9,f[25]),k=i(k,L,P,I,v,14,f[26]),I=i(I,k,L,P,y,20,f[27]),P=i(P,I,k,L,E,5,f[28]),L=i(L,P,I,k,h,9,f[29]),k=i(k,L,P,I,g,14,f[30]),I=i(I,k,L,P,w,20,f[31]),P=o(P,I,k,L,_,4,f[32]),L=o(L,P,I,k,y,11,f[33]),k=o(k,L,P,I,S,16,f[34]),I=o(I,k,L,P,T,23,f[35]),P=o(P,I,k,L,d,4,f[36]),L=o(L,P,I,k,p,11,f[37]),k=o(k,L,P,I,g,16,f[38]),I=o(I,k,L,P,b,23,f[39]),P=o(P,I,k,L,E,4,f[40]),L=o(L,P,I,k,c,11,f[41]),k=o(k,L,P,I,v,16,f[42]),I=o(I,k,L,P,m,23,f[43]),P=o(P,I,k,L,x,4,f[44]),L=o(L,P,I,k,w,11,f[45]),k=o(k,L,P,I,A,16,f[46]),I=o(I,k,L,P,h,23,f[47]),P=r(P,I,k,L,c,6,f[48]),L=r(L,P,I,k,g,10,f[49]),k=r(k,L,P,I,T,15,f[50]),I=r(I,k,L,P,_,21,f[51]),P=r(P,I,k,L,w,6,f[52]),L=r(L,P,I,k,v,10,f[53]),k=r(k,L,P,I,b,15,f[54]),I=r(I,k,L,P,d,21,f[55]),P=r(P,I,k,L,y,6,f[56]),L=r(L,P,I,k,A,10,f[57]),k=r(k,L,P,I,m,15,f[58]),I=r(I,k,L,P,E,21,f[59]),P=r(P,I,k,L,p,6,f[60]),L=r(L,P,I,k,S,10,f[61]),k=r(k,L,P,I,h,15,f[62]),I=r(I,k,L,P,x,21,f[63]),u[0]=u[0]+P|0,u[1]=u[1]+I|0,u[2]=u[2]+k|0,u[3]=u[3]+L|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var r=e.floor(i/4294967296),a=i;n[15+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),n[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,l=s.words,u=0;u<4;u++){var c=l[u];l[u]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return s},clone:function(){var t=u.clone.call(this);return t._hash=this._hash.clone(),t}});a.MD5=u._createHelper(d),a.HmacMD5=u._createHmacHelper(d)}(Math),t.MD5})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.PICK_UNIFORM="\nuniform float picking_usePickingColor;\nuniform vec3 picking_selectedPickingColor;\n",e.PICK_FUNCTION="\n    vec4 picking_getFinalColor(vec4 vertexColor, vec3 instancePickingColors) {\n        \n        return mix(\n            vertexColor,\n\n            vec4(instancePickingColors.rgb,  255.0).rgba / 255.0,\n\n            picking_usePickingColor);\n    }\n"},,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!y.has(t)){var n=new l.default(function(t){if(!d.default||_.default.isLocal)return void t(null);var n=e.subkey,i=e.subpid,o=["key="+d.default,"pid="+location.host,"channel=0"];n&&o.push("key2="+n,"pid2="+i);var r=v.default.checkKeySrc+"?"+o.join("&");g(null,r,function(e){var i=void 0;e&&e.info&&0===e.info.error?(i=e.detail&&e.detail.cfg)&&(i.subkey=n):console.error("鉴权失败："+e.info.msg),t(i)},function(){console.error("鉴权失败：网络请求失败。"),t(null)})});y.set(t,n)}return y.get(t)}function r(){return new l.default(function(t){(0,m.getStorageFrontier)().then(function(e){var n=["apikey="+d.default,"ctrlver=-1","ctrlpf=grid","ctrlmb=jsapi","frontier="+(e&&e.version||0),"callback"],i=v.default.overseaSrc+"?"+n.join("&");g(null,i,function(e){t(e)},function(){console.error("鉴权失败：海外图请求失败。"),t(null)})})})}function a(t){y.delete(t)}Object.defineProperty(e,"__esModule",{value:!0});var s=n(25),l=i(s),u=n(148),c=i(u);e.checkKey=o,e.overseaCheckKey=r,e.revokeKeyCheck=a;var f=n(471),d=i(f),h=n(23),v=i(h),p=n(105),_=i(p),m=n(508),g=n(340).send,y=new c.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(247),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=o.default[0]},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){return Math.sqrt(t*t+e*e)}function r(t,e){var n=t.pageX,i=t.pageY;if(t.touches){var o=t.touches[e||0];n=o.pageX,i=o.pageY}return{x:n,y:i}}function a(t){return t}Object.defineProperty(e,"__esModule",{value:!0}),e.Finger=void 0;var s=n(24),l=i(s),u=n(17),c=i(u),f=n(3),d=i(f),h=n(0),v=i(h),p=n(1),_=i(p),m=n(5),g=i(m),y=n(4),x=i(y),b=n(28),S=n(120),w={start:["mousedown","touchstart"],move:["mousemove","touchmove"],end:["mouseup","touchend"],cancel:["","touchcancel"],leave:["mouseleave",""]},E=0,T=(e.Finger=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,v.default)(this,e);var i=(0,g.default)(this,(e.__proto__||(0,d.default)(e)).call(this));if(!t)throw new Error("element is invalid");return i.options=n,i.identifier="Finger__"+E,E+=1,i.touched=!1,i.panning=!1,i.element=t,i.element.__Finger__identifier=i.identifier,i.handlers=[],i.isDoubleTap=!1,i.y1=null,i.x1=i.y1,i.y2=null,i.x2=i.y2,i.deltaTime=null,i.lastStartTime=null,i.panSpeedStartTime=null,i.panSpeedStartPos=null,i.now=null,i.tapTimeout=null,i.holdTimeout=null,i.swipeTimeout=null,i.startVector=null,i.startDistance=null,i.init(),i}return(0,x.default)(e,t),(0,_.default)(e,[{key:"init",value:function(){var t=this,e="ontouchstart"in document?1:0,n=(0,c.default)(w).forEach(function(n){if(w[n][e]){if("leave"===n)return void(0,b.on)(t.element,w[n][e],T.end,t);(0,b.on)(t.element,w[n][e],T[n],t)}});this.handlers.concat(n)}},{key:"destroy",value:function(){clearTimeout(this.tapTimeout),clearTimeout(this.holdTimeout),clearTimeout(this.swipeTimeout),this.removeAllListeners("touch-start"),this.removeAllListeners("multi-touch-start"),this.removeAllListeners("hold"),this.removeAllListeners("pinch"),this.removeAllListeners("rotate"),this.removeAllListeners("pan-start"),this.removeAllListeners("pan"),this.removeAllListeners("pan-end"),this.removeAllListeners("swipe"),this.removeAllListeners("tap"),this.removeAllListeners("doubletap"),this.removeAllListeners("touch-end"),this.removeAllListeners("multi-touch-end"),this.removeAllListeners("touch-cancel"),this.identifier=null,delete this.element.__Finger__identifier,this.handlers.forEach(function(t){t&&t.remove&&t.remove()}),this.touched=!1,this.handlers=[],this.isDoubleTap=!1,this.y1=null,this.x1=this.y1,this.y2=null,this.x2=this.y2,this.deltaTime=null,this.lastStartTime=null,this.now=null,this.tapTimeout=null,this.holdTimeout=null,this.swipeTimeout=null,this.startVector=null,this.startDistance=null}}]),e}(S),{start:function(t){var e=this;if(t&&t.target){this.touched=!0,this.now=Date.now(),this.deltaTime=this.now-(this.lastStartTime||this.now);var n=r(t);"number"==typeof this.x1&&"number"==typeof this.y1&&(this.isDoubleTap=this.deltaTime<300&&Math.abs(n.x-this.x1)<10&&Math.abs(n.y-this.y1)<10),this.x1=n.x,this.y1=n.y;var i=a(t);if(this.emit("touch-start",i),t.touches&&t.touches.length>1){var s=r(t,0),u=r(t,1);this.startVector=[u.x-s.x,u.y-s.y],this.startDistance=o.apply(void 0,(0,l.default)(this.startVector)),i.vector=this.startVector,i.vectorDistance=this.startDistance,clearTimeout(this.holdTimeout),this.emit("multi-touch-start",i)}this.lastStartTime=this.now,this.holdTimeout=setTimeout(function(){e.emit("hold",i)},750),this.options.stopPropagation&&t.stopPropagation()}},move:function(t){if(t&&t.target&&this.touched){var e=r(t),n=a(t);if(this.isDoubleTap=!1,clearTimeout(this.holdTimeout),null!==this.x2?(n.deltaX=e.x-this.x2,n.deltaY=e.y-this.y2):(n.deltaX=0,n.deltaY=0),t.touches&&t.touches.length>1&&this.startVector&&null!==this.startVector.x){var i=r(t,0),s=r(t,1),l=[s.x-i.x,s.y-i.y],u=o.apply(void 0,l),c=u/this.startDistance,f=Math.acos((this.startVector[0]*l[0]+this.startVector[1]*l[1])/(u*this.startDistance));f=l[0]*this.startVector[1]-this.startVector[0]*l[1]>=0?f:-f,Math.abs(c-1)>.01&&(n.scale=c,this.emit("pinch",n)),0!==f&&(n.angle=f,this.emit("rotate",n)),t.preventDefault()}else if(this.touched&&(0!==n.deltaY||0!==n.deltaX))if(this.panning){this.emit("pan",n);var d=Date.now();d-this.panSpeedStartTime>300&&(this.panSpeedStartTime=d,this.panSpeedStartPos=e)}else this.emit("pan-start",n),this.panning=!0,this.panSpeedStartTime=Date.now(),this.panSpeedStartPos=e;this.options.preventDefaultMove&&t.preventDefault(),this.x2=e.x,this.y2=e.y,this.options.stopPropagation&&t.stopPropagation()}},end:function(t){var e=this;if(t&&t.target){clearTimeout(this.holdTimeout),this.now=Date.now();var n=this.x2-this.x1,i=this.y2-this.y1,o=null===this.x2||Math.abs(n)<10&&Math.abs(i)<10,r=this.now-this.lastStartTime<200&&o,s=a(t);if(null!==this.x2&&null!==this.y2&&this.panning){var l=Math.abs(n)>Math.abs(i)?n>0?"RIGHT":"LEFT":i>0?"DOWN":"TOP",u=0,c=0;if(this.now-this.panSpeedStartTime<300){var f=this.x2-this.panSpeedStartPos.x,d=this.y2-this.panSpeedStartPos.y,h=this.now-this.panSpeedStartTime;c=f/h,u=d/h}s.swipeDirection=l,s.speedX=c,s.speedY=u,s.deltaX=n,s.deltaY=i,this.panning&&(this.emit("pan-end",s),this.panning=!1),this.swipeTimeout=setTimeout(function(){e.emit("swipe",s)})}else o&&r&&(this.tapTimeout=setTimeout(function(){e.emit("tap",s),e.isDoubleTap&&(e.emit("doubletap",s),e.isDoubleTap=!1)},0));this.emit("touch-end",s),t.touches&&t.touches.length>0&&t.touches.length<2&&this.emit("multi-touch-end",s),this.startDistance=null,this.startVector=[0,0],this.y2=null,this.x2=this.y2,this.touched=!1,this.options.preventDefaultEnd&&t.preventDefault(),this.options.stopPropagation&&t.stopPropagation()}},cancel:function(t){clearTimeout(this.tapTimeout),clearTimeout(this.holdTimeout),clearTimeout(this.swipeTimeout),this.touched=!1,this.emit("touch-cancel",t)}})},function(t,e,n){"use strict";function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r(t,e);return(0,o.toDom)(n)}Object.defineProperty(e,"__esModule",{value:!0}),e.Template=void 0,e.templeteToDom=i;var o=n(210),r=e.Template=function(){var t={},e=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/[ ]/g,"&nbsp;")};return function(n,i){if("string"==typeof n){var o=t[n];if(!t[n]){var r=n.replace(/<%\s*([^=][^%>]*)\s*%>/g,function(){return"';"+arguments[1]+" tmp+='"}).replace(/<%=\s*([^%>]+)\s*%>/g,function(){return"' + strip("+arguments[1]+") +'"}).replace(/<%=\s*([^%>]+)\s*%>/g,function(){return"' + "+arguments[1]+"+ '"});r='var tmp = ""; with(obj){ tmp = \''+r+"'; } return tmp;",o=new Function("obj","strip",r),t[n]=o}return o(i,e)}}}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return t.length>=3&&(0,w.default)(t[0].lat)&&(0,w.default)(t[0].lng)}function r(t){return t.length>=1&&t.every(function(t){return t.length>=3&&o(t)})}function a(t){return t.length>=1&&t.every(function(t){return r(t)})}function s(t){var e=t[0],n=t[t.length-1];return e.lat===n.lat&&e.lng===n.lng?t:t.concat([e])}function l(t){for(var e=0,n=1,i=void 0,o=void 0;n<t.length;)i=o||t[0],o=t[n],e+=(o.lng-i.lng)*(o.lat+i.lat),n+=1;return e>0}function u(t){return(o(t)?[[s(t)]]:r(t)?[t.map(function(t){return s(t)})]:t.map(function(t){return t.map(s)})).map(function(t){return t.map(function(t,e){var n=[];return t.forEach(function(t){if(n.length>0){var e=n[n.length-1];t.lat===e.lat&&t.lng===e.lng||n.push(t)}else n.push(t)}),0===e?l(n)?n.reverse():n:l(n)?n:n.reverse()})})}function c(t){return u(t).reduce(function(t,e){var n=e.reduce(function(t,e){return t.push(e),t},[]);return t.push.apply(t,(0,b.default)(n)),t},[])}function f(t){return o(t)?t.length:t.reduce(function(t,e){return t+e.reduce(function(t,e){return t+e.length},0)},0)}function d(t){return t.reduce(function(t,e){return t+h(e)},0)}function h(t){var e=0,n=!0,i=!0,o=!1,r=void 0;try{for(var a,s=(0,y.default)(t);!(i=(a=s.next()).done);i=!0){var l=a.value,u=l.length;e+=n?u>=3?u-3:0:u+1,n=!1}}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return e}function v(t){var e=null;if(t.length>1){var n=0;e=[],t.forEach(function(t){n+=t.length,e.push(n)}),e.pop()}return e}function p(t,e){var n=3*d(t),i=m(t),o=new e(n),r=0;return t.forEach(function(t,e){var n=_(t),a=!0,s=!1,l=void 0;try{for(var u,c=(0,y.default)(n);!(a=(u=c.next()).done);a=!0){var f=u.value;o[r]=f+i[e],r+=1}}catch(t){s=!0,l=t}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}),o}function _(t){var e=v(t),n=I(t,{dimensions:2,result:[]});return(0,P.default)(n,e,2)}function m(t){var e=new Array(t.length+1);e[0]=0;var n=0;return t.forEach(function(t,i){n+=t.reduce(function(t,e){return t+e.length},0),e[i+1]=n}),e}Object.defineProperty(e,"__esModule",{value:!0});var g=n(27),y=i(g),x=n(24),b=i(x),S=n(343),w=i(S);e.isSimple=o,e.isPart=r,e.isComplex=a,e.isClockWise=l,e.normalize=u,e.getBorderPolyline=c,e.getVertexCount=f,e.getTriangleCount=d,e.getTriangleCountOfPart=h,e.getSurfaceIndices=p;var E=n(237),T=i(E),A=n(278),P=i(A),I=T.default.flattenVertices},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(e){var n=e.find(function(e){return e.layerid===t});return n?{minZoom:n.zoom_min,maxZoom:n.zoom_max,getTileUrl:function(t,e,i){var o=n.url;return n.params.forEach(function(i){var r=n[i];Array.isArray(r)&&(r=r[(t+e)%r.length]),o=o.replace("{"+i+"}",r)}),o=o.replace("{x}",t).replace("{y}",e).replace("{z}",i)}}:void 0}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(16),a=i(r),s=n(3),l=i(s),u=n(0),c=i(u),f=n(1),d=i(f),h=n(5),v=i(h),p=n(35),_=i(p),m=n(4),g=i(m),y=n(382),x=i(y),b=n(90),S=n(66),w=n(143),E=n(41),T=i(E),A=n(29),P=n(294),I=n(43),k=T.default.isFunction,L=T.default.isString,M=T.default.isNumber,C=function(t){function e(t){(0,c.default)(this,e),t.type=S.RENDER_LAYER_TYPE.imageTile;var n=(0,v.default)(this,(e.__proto__||(0,l.default)(e)).call(this,t));return(0,I.statCn)("ImageTileLayer"),n}return(0,g.default)(e,t),(0,d.default)(e,[{key:"_initialize",value:function(t){(0,_.default)(e.prototype.__proto__||(0,l.default)(e.prototype),"_initialize",this).call(this,t),this._setTileUrlGetter(t.getTileUrl),this.sourceId=this.sourceId||this.id}},{key:"setZIndex",value:function(t){return M(t)||new A.BaseTypeError("ImageTileLayer.zIndex","number",t).error(),(0,_.default)(e.prototype.__proto__||(0,l.default)(e.prototype),"setZIndex",this).call(this,t)}},{key:"_setTileUrlGetter",value:function(t){k(t)?L(t(0,0,0))?this.getTileUrl=t:new A.BaseTypeError("ImageTileLayerOptions.getTileUrl返回值","string",t(0,0,0)).throw():new A.BaseTypeError("ImageTileLayerOptions.getTileUrl","function",t).throw()}},{key:"_addSource",value:function(){this.map&&!this.map.getSource(this.sourceId)&&(this.map.addSource(this.sourceId,{type:b.SOURCE_TYPE.imageTile,tileSize:this.tileSize,data:this.getTileUrl,minZoom:this.minDataZoom,maxZoom:this.maxDataZoom}),this._fire("layer",{}))}},{key:"_removeSource",value:function(){this.map&&this.map.removeSource(this.sourceId),this._fire("source_removed",{})}}],[{key:"createCustomLayer",value:function(t){var n=t.map,i=t.layerId;return n?(0,P.checkKey)(n.id).then(function(r){if(!r)throw"请传入正确的key";if(!r.custom_layer||!r.custom_layer.enable)throw"无个性化图层权限";var s=o(i,r.custom_layer.layers);if(!s)throw"请传入正确的layerId";(0,I.cl)({id:i,subkey:r.subkey});var l=new e((0,a.default)(s,t));return l.setZIndex((0,w.getRank)(w.LAYER_LEVEL.BUILDING+1,0)-(0,w.getRank)(w.LAYER_LEVEL.BUILDING,0)-1),n.moveLayer(l.getId(),w.LAYER_LEVEL.BUILDING),l}).catch(function(t){return console.error("个性化图层鉴权失败："+t),null}):(console.error("个性化图层鉴权失败：未绑定地图对象。"),null)}}]),e}(x.default);e.default=C},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(t.row>e.row){var n=t;t=e,e=n}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function r(t,e,n,i,o){var r=Math.max(n,Math.floor(e.y0)),a=Math.min(i,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var l=t.dx/t.dy,u=e.dx/e.dy,c=t.dx>0,f=e.dx<0,d=r;d<a;d++){var h=l*Math.max(0,Math.min(t.dy,d+c-t.y0))+t.x0,v=u*Math.max(0,Math.min(e.dy,d+f-e.y0))+e.x0;o(Math.floor(v),Math.ceil(h),d)}}function a(t,e,n,i,a,s){var l=o(t,e),u=o(e,n),c=o(n,t),f=void 0;l.dy>u.dy&&(f=l,l=u,u=f),l.dy>c.dy&&(f=l,l=c,c=f),u.dy>c.dy&&(f=u,u=c,c=f),l.dy&&r(c,l,i,a,s),u.dy&&r(c,u,i,a,s)}Object.defineProperty(e,"__esModule",{value:!0});var s=n(17),l=i(s),u=n(0),c=i(u),f=n(1),d=i(f),h=n(23),v=i(h),p=function(){function t(e,n,i,o,r){(0,c.default)(this,t),this.z=e,this.x=n,this.y=i,this.w=o,this.tileSize=r||v.default.tileSize,this.id=n+"_"+i+"_"+e,this._children=null,this._parent=null}return(0,d.default)(t,[{key:"url",value:function(t){var e=this.getServiceCoord(),n=e.x,i=e.y,o=e.z;return t[(this.x+this.y)%t.length].replace("{z}",o).replace("{x}",n).replace("{y}",i).replace("{version}",v.default.dataVersion.tile)}},{key:"setIconUrls",value:function(t){this._iconUrls=t}},{key:"getServiceCoord",value:function(){var t=this.tileSize?v.default.tileSize/this.tileSize:1;return{x:this.x,y:Math.pow(2,this.z)*t-this.y-1,z:this.z}}},{key:"urlForBatchChildren",value:function(t){var e=this.children().map(function(t){return t.getServiceCoord()}).map(function(t){return t.z+"_"+t.x+"_"+t.y}).join();return t[(this.x+this.y)%t.length].replace("{tiles}",e).replace("{version}",v.default.dataVersion.tile)}},{key:"parent",value:function(e){return 0===this.z?null:this._parent?this._parent:(this.z>e?this._parent=new t(this.z-1,this.x,this.y,this.w):this._parent=new t(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w),this._parent)}},{key:"ancestor",value:function(e){var n=Math.round(this.z)-Math.round(e);if(n<=0)return null;var i=Math.pow(2,n);return new t(this.z-n,Math.floor(this.x/i),Math.floor(this.y/i),this.w)}},{key:"children",value:function(e){if(this._children)return this._children;if(this.z>=e)return this._children=[new t(this.z+1,this.x,this.y,this.w)],this._children;var n=this.z+1,i=2*this.x,o=2*this.y;return this._children=[new t(n,i,o,this.w),new t(n,i+1,o,this.w),new t(n,i,o+1,this.w),new t(n,i+1,o+1,this.w)],this._children}},{key:"descendant",value:function(e){var n=this.x,i=this.y,o=this.z,r=this.w,a=Math.round(e)-Math.round(o);if(a<=0)return null;for(var s=Math.pow(2,a),l=[],u=0;u<s;u++)for(var c=0;c<s;c++)l.push(new t(e,n*s+u,i*s+c,r));return l}},{key:"isVirtualCoord",value:function(){return this.z<=0}},{key:"wrapXAroundCenter",value:function(t){var e=this.x,n=this.z,i=Math.pow(2,n),o=t.getLng()/360+.5,r=e/i,a=r-o;return a>.5?e-i:a<-.5?e+i:e}}],[{key:"converter",value:function(t){return new this(t.z,t.x,t.y,t.w,t.tileSize)}},{key:"cover",value:function(e,n){function i(n,i,a){var s=void 0,l=void 0,u=void 0,c=void 0;if(a>=0&&a<=o)for(s=n;s<i;s++)l=Math.floor(s/o),u=(s%o+o)%o,c=new t(e,u,a,l),r[c.id]=c}var o=1<<e,r={};return a(n[0],n[1],n[2],0,o,i),a(n[2],n[3],n[0],0,o,i),(0,l.default)(r).map(function(t){return r[t]})}},{key:"coverAll",value:function(e){for(var n=1<<e,i=[],o=0;o<n;o++)for(var r=0;r<n;r++){var a=new t(e,o,r,0);i.push(a)}return i}}]),t}();e.default=p},function(t,e,n){"use strict";function i(t){return t===o.DEFAULT||o[t]===o.DEFAULT}Object.defineProperty(e,"__esModule",{value:!0}),e.isDefaultStyle=i;var o=e.STYLE_ID={DEFAULT:0,DARK:1,LIGHT:2,GAME:3}},,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(){return{state:0,transition:function(t){var e="overlay"===t;switch(this.state){case 0:this.state=e?1:0;break;case 1:this.state=e?1:2;break;case 2:this.state=e?1:0}}}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(16),a=i(r),s=n(3),l=i(s),u=n(0),c=i(u),f=n(1),d=i(f),h=n(5),v=i(h),p=n(35),_=i(p),m=n(4),g=i(m),y=n(10),x=i(y),b=n(504),S=i(b),w=n(28),E=i(w),T=n(484),A=i(T),P=n(209),I=i(P),k=n(29),L=n(41),M=i(L),C=n(43),R=n(112),B=function(t){function e(t){(0,c.default)(this,e);var n=(0,v.default)(this,(e.__proto__||(0,l.default)(e)).call(this));return t.geometries=t.geometries||[],n.id=t.id||x.default.uniqueId(),n.zIndex=t.zIndex>=0?t.zIndex:0,n.styles=t.styles||{},n.minZoom=t.minZoom,n.maxZoom=t.maxZoom,n._setGeometryType(),n._checkGeometries(t.geometries,n.styles),n._rawGeometries=n._assignIdToGeometry(t.geometries),n._idSet=n._updateGeometryIdSet(n._rawGeometries),n.geometries=n._transferFromGeometry(n._rawGeometries),n._checkStyles(n.styles),n._initialize(t),n._bubbleHandler=[],n._lastestOverlayMouseMoveObj=null,n._mousemoveFSM=o(),t.map&&n.setMap(t.map),(0,C.statCn)(n._className),n}return(0,g.default)(e,t),(0,d.default)(e,[{key:"_initialize",value:function(){}},{key:"_emitGeoEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.emit(t,(0,a.default)({},n,{geometry:e,type:t,target:this}))}},{key:"_bindBubbleHandler",value:function(){var t=this;this._bubbleHandler.push(E.default.on(this.map._bubbleMiddleware,"mousemove",function(e){2===t._mousemoveFSM.state&&(t._lastestOverlayMouseMoveObj=null,t._emitGeoEvent("mouseout",null,e),t._emitGeoEvent("hover",null,e)),t._mousemoveFSM.transition.call(t._mousemoveFSM,"map")})),this._bubbleHandler.push(E.default.on(this.map._bubbleMiddleware,"action",function(e){if(e&&e.layerId===t.id){var n=t.geometries[e.objectIndex];t._emitGeoEvent(e.eventType,n,e.mapEvent),"mousemove"===e.eventType&&(t._mousemoveFSM.transition.call(t._mousemoveFSM,"overlay"),t._lastestOverlayMouseMoveObj?n!==t._lastestOverlayMouseMoveObj&&t._emitGeoEvent("hover",n,e.mapEvent):(t._emitGeoEvent("mouseover",n,e.mapEvent),t._emitGeoEvent("hover",n,e.mapEvent)),t._lastestOverlayMouseMoveObj=n)}})),this._bubbleHandler.push(E.default.on(this.map,"destroy",function(){t.setMap(null)}))}},{key:"_removeBubbleHander",value:function(){this._bubbleHandler.forEach(function(t){t&&t.remove&&t.remove()})}},{key:"_setGeometryType",value:function(){}},{key:"_createLayer",value:function(){this.layer=new A.default({map:this.map,id:this.id,type:this._layerType,zIndex:this.zIndex,minZoom:this.minZoom,maxZoom:this.maxZoom,sourceData:this._getRenderSourceData()})}},{key:"_removeLayer",value:function(){this.layer&&this.layer.setMap(null)}},{key:"setVisible",value:function(t){return t=Boolean(t),this.layer&&this.layer.setVisible(t),this}},{key:"setMap",value:function(t){return null===t||t instanceof window.TMap.Map?t===this.map?this:(t?this.map?(this.setMap(null),this.setMap(t)):this.id&&t.getLayer(this.id)?console.error("Map中已存在id为"+this.id+"的图层，无法重复添加"):(this.map=t,this._bindBubbleHandler(),this._createLayer()):(this._removeBubbleHander(),this._removeLayer(),this.map=null),this):(console.error("所传入参数并非TMap.Map的实例！"),this)}},{key:"setGeometries",value:function(t){return Array.isArray(t)?t===this._rawGeometries?this:((0,_.default)(e.prototype.__proto__||(0,l.default)(e.prototype),"setGeometries",this).call(this,t,this.styles),this.map&&this.map.getSource(this.id).setData(this._getRenderSourceData()),this):(new k.BaseTypeError("geometries","Array",t).error(),this)}},{key:"setStyles",value:function(t){return t?(t.hasOwnProperty||new k.BaseTypeError("styles","Object",t).error(),this._checkStyles(t),t===this.styles?this:(this.styles=t,this.map&&this.map.getSource(this.id).setData(this._getRenderSourceData()),this)):this}},{key:"setZIndex",value:function(t){return M.default.isNumber(t)?t<0?(console.error("zIndex希望设置为非负数,实际值为: "+t),this):(this.layer&&this.layer.setZIndex(t),this.zIndex=t,this):(new k.BaseTypeError("zIndex","Number",t).error(),this)}},{key:"getMap",value:function(){return this.map}},{key:"getVisible",value:function(){return this.layer&&this.layer.visible}},{key:"getStyles",value:function(){return(0,a.default)({},this.styles)}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"updateGeometries",value:function(t,n){return t?((0,_.default)(e.prototype.__proto__||(0,l.default)(e.prototype),"updateGeometries",this).call(this,t,n),this.map&&this.map.getSource(this.id).setData(this._getRenderSourceData()),this):this}},{key:"add",value:function(t){return(0,_.default)(e.prototype.__proto__||(0,l.default)(e.prototype),"add",this).call(this,t)}},{key:"remove",value:function(t){return(0,_.default)(e.prototype.__proto__||(0,l.default)(e.prototype),"remove",this).call(this,t)}},{key:"destroy",value:function(){(0,_.default)(e.prototype.__proto__||(0,l.default)(e.prototype),"destroy",this).call(this),this.removeAllListeners(),this.setMap(null),this.styles=null,this.id=null,this.zIndex=null,this.minZoom=null,this.maxZoom=null}},{key:"getGeometryType",value:function(){return this._geometryType}},{key:"snap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments[2];this._snapTargets||(this._updateSnapTargets(),this.on("geometry_changed",this._updateSnapTargets.bind(this)));var i=null;return i=this._snapToPoints(t,e,n),i||(i=this._snapToSegments(t,e,n)),i}},{key:"_snapToPoints",value:function(t,e,n){var i=this._snapTargets.points,o=this.map;n&&!n.isEmpty()&&(i=i.filter(function(t){return n.contains(t)}));var r=o.projectToContainer(t),a=null,s=1/0;return i.forEach(function(t){var n=o.projectToContainer(t),i=r.dist(n);i<e&&i<s&&(a=t,s=i)}),a?{latLng:a,dist:s}:null}},{key:"_snapToSegments",value:function(t,e,n){var i=this._snapTargets.segments,o=this.map;n&&!n.isEmpty()&&(i=i.filter(function(t){var e=new I.default;return e.extend(t[0]),e.extend(t[1]),n.intersects(e)}));for(var r=o.projectToContainer(t),a=null,s=1/0,l=0;l<i.length;l++){var u=i[l],c=o.projectToContainer(u[0]),f=o.projectToContainer(u[1]),d=f.sub(c),h=r.sub(c),v=h.dot(d)/d.lengthSq();if(v>0&&v<1){var p=d.mult(v),_=h.sub(p),m=_.length();m<e&&m<s&&(a=o.unprojectFromContainer(c.add(p)),s=m)}}return a?{latLng:a,dist:s}:null}},{key:"_updateSnapTargets",value:function(){this._snapTargets={points:this._getAllPoints(),segments:this._getAllSegments()}}},{key:"_getAllPoints",value:function(){return[]}},{key:"_getAllSegments",value:function(){return[]}},{key:"_getRenderableGeometries",value:function(){var t=this;return this.geometries.filter(function(e){return e&&t.styles}).map(function(e){var n=(0,a.default)({},e);return t.styles[e.styleId]||(n.styleId="default"),n})}},{key:"_getRenderSourceData",value:function(){return{type:this._geometryType,styles:this.styles,geometries:this._getRenderableGeometries()}}},{key:"_checkStyles",value:function(t){t.default||(t.default=this._getDefaultStyle())}}]),e}(S.default);e.default=B,B.LatLngBoundsToBoundingBox=function(t){var e=t.getNorthEast(),n=t.getSouthWest(),i=new TMap.LatLng((e.lat+n.lat)/2,(e.lng+n.lng)/2),o=(0,R.latLngToMercator)(e),r=(0,R.latLngToMercator)(n),a=o.x-r.x,s=o.y-r.y;return i.height=((e.height||0)+(0|n.height))/2,{center:i,width:a,height:s}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.MAP_ZOOM_TYPE={DEFAULT:0,CENTER:1}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(211),p=i(v),_=function(t){function e(t){(0,s.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t));return n.textureShader=!0,n}return(0,h.default)(e,t),(0,u.default)(e,[{key:"afterDraw",value:function(){this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}}]),e}(p.default);e.default=_},function(t,e,n){t.exports={default:n(308),__esModule:!0}},function(t,e,n){n(73),n(33),n(39),n(314),n(318),n(317),n(316),t.exports=n(2).Map},function(t,e,n){n(315),t.exports=n(2).Math.log2},function(t,e,n){n(319),t.exports=n(2).Object.values},function(t,e,n){var i=n(71);t.exports=function(t,e){var n=[];return i(t,!1,n.push,n,e),n}},function(t,e,n){var i=n(7),o=n(117),r=n(9)("species");t.exports=function(t){var e;return o(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!o(e.prototype)||(e=void 0),i(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){var i=n(311);t.exports=function(t,e){return new(i(t))(e)}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e,n){"use strict";var i=n(260),o=n(183);t.exports=n(250)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=i.getEntry(o(this,"Map"),t);return e&&e.v},set:function(t,e){return i.def(o(this,"Map"),0===t?0:t,e)}},i,!0)},function(t,e,n){var i=n(6);i(i.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){n(251)("Map")},function(t,e,n){n(252)("Map")},function(t,e,n){var i=n(6);i(i.P+i.R,"Map",{toJSON:n(261)("Map")})},function(t,e,n){var i=n(6),o=n(118)(!1);i(i.S,"Object",{values:function(t){return o(t)}})},function(t,e,n){var i=n(244),o=n(78)("toStringTag"),r="Arguments"==i(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),o))?n:r?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){var i=n(244);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var i=n(60),o=n(229),r=n(78)("species");t.exports=function(t,e){var n,a=i(t).constructor;return void 0===a||void 0==(n=i(a)[r])?e:o(n)}},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.attributePart="\n\tattribute vec2 a_Positions;\n\tattribute vec3 a_InstanceTrans;\n\tattribute vec4 a_InstanceCoords;\n\tattribute vec4 a_InstanceTextBounds;\n\tattribute vec4 a_InstanceInfo;\n",e.uniformPart="\n\tuniform mat4 u_matrix;\n\tuniform vec2 u_resolution;\n\tuniform float u_fadeChange;\n\tuniform vec2 u_InstanceTileTextureOffset;\n\tuniform vec2 u_iconTextureResolution;\n\tuniform vec2 u_textTextureResolution;\n\tuniform float u_showPoint;\n\tuniform float u_showLabel;\n\tuniform float u_mapScale;\n",e.varyingPart="\n\tvarying vec2 v_TexCoord;\n\tvarying float v_isShow;\n\tvarying float v_isIcon;\n\tvarying float v_opacity;\n\tvarying vec4 v_ndcCoord;\n",e.filterPart="\nfloat getFilterOpacity(float opacity, float type) {\n\treturn mix(\n\t\tmix(0.0, opacity, u_showPoint),\n\t\tmix(0.0, opacity, u_showLabel),\n\t\ttype\n\t);\n}\n",e.projectScreenPart="\nvec2 project(vec4 device) {\n    vec3 device_normal = device.xyz / device.w;\n    vec2 clip_pos = (device_normal * 0.5 + 0.5).xy;\n    return clip_pos * u_resolution;\n}\n\nvec4 unproject(vec2 screen, float z, float w) {\n    vec2 clip_pos = screen / u_resolution;\n    vec2 device_normal = clip_pos * 2.0 - 1.0;\n    return vec4(device_normal * w, z, w);\n}\n",e.glPositionPart="\n\t\tvec4 center_proj = u_matrix * vec4(transCoord, 0., 1.);\n\t\tvec2 center_screen = project(center_proj);\n        \n\t\tfloat s_rotate = a_InstanceInfo.x;\n\t\tfloat angle_sin = sin(s_rotate);\n    float angle_cos = cos(s_rotate);\n\t\tmat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n        \n\t\tvec2 positions = a_Positions * 0.5 + 0.5;\n\t\tvec2 corner_screen = rotation_matrix * vec2(\n\t\t\t(a_InstanceCoords.x * positions.x - a_InstanceCoords.z) * u_mapScale,\n\t\t\t(a_InstanceCoords.y * (positions.y - 1.0) + a_InstanceCoords.w) * u_mapScale\n\t\t) + center_screen.xy;\n\t\tvec4 corner_proj = unproject(corner_screen, center_proj.z, center_proj.w);\n\t\tgl_Position = corner_proj;\n\n\t\tv_ndcCoord = center_proj;\n",e.glPositionCusPart="\n\t\tvec4 center_proj = u_matrix * vec4(transCoord, 0., 1.);\n\t\tvec2 center_screen = project(center_proj);\n        \n\t\tfloat s_rotate = a_InstanceInfo.x;\n\t\tfloat angle_sin = sin(s_rotate);\n    float angle_cos = cos(s_rotate);\n\t\tmat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n        \n\t\tvec2 positions = a_Positions * 0.5 + 0.5;\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\tvec2 corner_screen = rotation_matrix * vec2(\n\t\t\t(a_InstanceCoords.x  * positions.x - a_InstanceCoords.z) * u_mapScale * mix(1.0 , a_InstanceStrentchinglens.x , a_InstanceInfo.z),\n\t\t\t(a_InstanceCoords.y * (positions.y - 1.0) + a_InstanceCoords.w) * mix(1.0 , a_InstanceStrentchinglens.y , a_InstanceInfo.z) * u_mapScale\n\t\t) + center_screen.xy;\n\t\tvec4 corner_proj = unproject(corner_screen, center_proj.z, center_proj.w);\n\t\tgl_Position = corner_proj;\n\t\t\n\t\tv_ndcCoord = center_proj;\n",e.fragPart="\n\tuniform sampler2D u_SamplerMask;\n\tuniform sampler2D u_SamplerText;\n\tuniform sampler2D u_SamplerIcon;\n\tuniform float u_asbackground;\n\tuniform float u_maskScale;\n",e.maskPart="\n\tvec2 v_texCoord = (v_ndcCoord.xy / v_ndcCoord.w * u_maskScale + 1.0) / 2.0;\n\t\n\tfloat maskCull = texture2D(u_SamplerMask, v_texCoord).r;\n\tfloat clipCull = texture2D(u_SamplerMask, v_texCoord).g;\n\tfloat isCulledByMask = step(0.99, clipCull) * step(maskCull, 0.1);\n\t\n\t\n\t\n\t\n"},,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(23),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=o.default.highQualityRender},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=t.getSouthWest(),n=t.getNorthEast(),i=t.getSouthEast();return[n,t.getNorthWest(),e,i]}function r(t,e,n){var i=(0,u.latLngToMercator)(t);return[new f.default(e/2,n/2),new f.default(e/2,-n/2),new f.default(-e/2,-n/2),new f.default(-e/2,n/2)].map(function(t){return t.x=i.x+t.x,t.y=i.y+t.y,(0,u.mercatorToLatLng)(t)})}function a(t){return(0,l.default)(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.getBoundsPath=o,e.getRectanglePath=r;var s=n(277),l=i(s),u=n(112),c=n(74),f=i(c);e.default=a},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){var i="highlightRegion"===t?T:983040&t,o=n[i]&&n[i][t];return o?f(o,e):k[t]?k[t]:null}function r(t){var e={};return e[T]=a(t.regionStyles),e[A]=s(t.labelStyles),e[E]=l(t.lineStyles),e[w]=u(t.pointStyles),e[P]=c(t.arrowStyles),e[T].highlightRegion=[{minScale:16,maxScale:22,fillStyle:"rgba(0, 0, 0, 0.1)",strokeStyle:"#888888",lineWidth:.5}],e}function a(t){var e={};return(0,h.default)(t).forEach(function(n){e[n]={},e[n]=t[n].map(function(t){return{minScale:t.minScaleVal,maxScale:t.maxScaleVal,topStyle:(0,b.convertColorToHex)(t.top_color),bottomStyle:(0,b.convertColorToHex)(t.bottom_color),insideStyle:(0,b.convertColorToHex)(t.bottom_color),outsideStyle:(0,b.convertColorToHex)(t.outside_color),lineWidth:t.sidewidth}})}),e}function s(t){var e={};return(0,h.default)(t).forEach(function(n){e[n]={},e[n]=t[n].map(function(t){var e=(0,b.getFontStyle)(t.effect),n=(0,b.getFontWeight)(),i=t.font_size,o=(0,b.getFontFamily)(t.font_name);return{minScale:t.minScaleVal,maxScale:t.maxScaleVal,effect:t.effect,font:e+" "+n+" "+i+"px "+o,fontStyle:e,fontWeight:n,fontSize:i,fontFamily:o,fillStyle:(0,b.convertColorToHex)(t.font_color),strokeStyle:(0,b.convertColorToHex)(t.background_color),lineWidth:t.effect_size}})}),e}function l(t){var e={};return(0,h.default)(t).forEach(function(n){e[n]={},e[n]=t[n].map(function(t){return{minScale:t.minScaleVal,maxScale:t.maxScaleVal,fillStyle:(0,b.convertColorToHex)(t.color_fill),fillWidth:t.width,fillLineCap:"round",fillLineJoin:"bevel",strokeStyle:(0,b.convertColorToHex)(t.color_side),strokeWidth:t.sidewidth,strokeLineCap:"butt",strokeLineJoin:"bevel"}})}),e}function u(t){var e={};return(0,h.default)(t).forEach(function(n){e[n]={},e[n]=t[n].map(function(t){return{minScale:t.minScaleVal,maxScale:t.maxScaleVal,icon_offset:t.icon_offset,labelid:t.labelid,density:t.density}})}),e}function c(){return{}}function f(t,e){var n=null;return t.some(function(t){return n=t,e>=t.minScale&&e<=t.maxScale||22===e&&21===t.maxScale})&&n||null}Object.defineProperty(e,"__esModule",{value:!0}),e.IndoorStyleMap=e.customStyle=e.ARROW_NUM=e.LABEL_NUM=e.REGION_NUM=e.LINE_NUM=e.POINT_NUM=void 0;var d=n(17),h=i(d),v=n(148),p=i(v),_=n(0),m=i(_),g=n(1),y=i(g);e.getStyle=o;var x=n(646),b=n(647),S=null,w=e.POINT_NUM=65536,E=e.LINE_NUM=131072,T=e.REGION_NUM=196608,A=e.LABEL_NUM=262144,P=e.ARROW_NUM=327680,I=r(x.STYLE),k=e.customStyle={};e.IndoorStyleMap=function(){function t(){(0,m.default)(this,t),this.styleMap=new p.default,this.styleMap.set("default",I)}return(0,y.default)(t,[{key:"set",value:function(t,e){var n=r(e);this.styleMap.set(t,n)}},{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return this.has(t)?this.styleMap.get(t):this.styleMap.get("default")}},{key:"has",value:function(t){return this.styleMap.has(t)}},{key:"getFeatureStyle",value:function(t,e,n){return o(t,e,this.get(n))}}],[{key:"getInstance",value:function(){return null===S&&(S=new t),S}}]),t}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return t.reduce(function(t,e){return t+y.getVertexCount(e)},0)}function r(t){return t.reduce(function(t,e){return t+y.getTriangleCount(e)},0)}function a(t){var e=new Array(t.length+1);e[0]=0;var n=0;return t.forEach(function(t,i){n+=y.getVertexCount(t),e[i+1]=n}),e}function s(t){var e=t.complexPolygons,n=t.IndexType,i=void 0===n?Uint32Array:n,o=3*r(e),s=a(e),l=new i(o),u=0;return e.forEach(function(t,e){var n=y.getSurfaceIndices(t,i),o=!0,r=!1,a=void 0;try{for(var c,f=(0,h.default)(n);!(o=(c=f.next()).done);o=!0){var d=c.value;l[u]=d+s[e],u+=1}}catch(t){r=!0,a=t}finally{try{!o&&f.return&&f.return()}finally{if(r)throw a}}}),l}function l(t){var e=t.cache,n=e.positions,i=e.positions64xyLow,o=e.vertexValid,r=t.complexPolygons,a=t.fp64,s=0;r.forEach(function(t){t.forEach(function(t){t.forEach(function(t){t.forEach(function(t){var e=t.lng,o=t.lat,r=t.z||0;n[3*s]=e,n[3*s+1]=o,n[3*s+2]=r,a&&(i[2*s]=(0,S.fp64LowPart)(e),i[2*s+1]=(0,S.fp64LowPart)(o)),s+=1}),o[s-1]=0})})})}function u(t){var e=t.cache,n=t.complexPolygons,i=t.pointCount,o=t.getElevation,r=e||new Float32Array(i),a=0;return n.forEach(function(t,e){var n=o(e),i=y.getVertexCount(t);E({target:r,source:[n],start:a,count:i}),a+=i}),r}function c(t){var e=t.cache,n=t.complexPolygons,i=t.pointCount,o=t.getColor,r=e||new Uint8ClampedArray(4*i),a=0;return n.forEach(function(t,e){var n=o(e);isNaN(n[3])&&(n[3]=255);var i=y.getVertexCount(t);E({target:r,source:n,start:a,count:i}),a+=n.length*i}),r}function f(t){var e=t.complexPolygons,n=t.pointCount,i=new Uint8ClampedArray(3*n),o=0;return e.forEach(function(t,e){var n=(0,w.encodePickingColor)(e),r=y.getVertexCount(t);E({target:i,source:n,start:o,count:r}),o+=n.length*r}),i}Object.defineProperty(e,"__esModule",{value:!0}),e.PolygonParseHelper=void 0;var d=n(27),h=i(d),v=n(0),p=i(v),_=n(1),m=i(_),g=n(298),y=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(g),x=n(237),b=i(x),S=n(139),w=n(240),E=b.default.fillArray,T=[0,0,0,255];e.PolygonParseHelper=function(){function t(e){var n=e.complexPolygons,i=e.IndexType;(0,p.default)(this,t),n=n.map(function(t){return y.normalize(t)});var r=o(n);this.complexPolygons=n,this.pointCount=r,this.IndexType=i,this.attributes={pickingColors:f({complexPolygons:n,pointCount:r})}}return(0,m.default)(t,[{key:"updatePositions",value:function(t){var e=t.fp64,n=t.extruded;e=!0;var i=this.attributes,o=this.complexPolygons,r=this.pointCount;i.positions=i.positions||new Float32Array(3*r),i.vertexValid=i.vertexValid||new Uint8ClampedArray(r).fill(1),e&&(i.positions64xyLow=i.positions64xyLow||new Float32Array(2*r)),l({cache:i,complexPolygons:o,extruded:n,fp64:e})}},{key:"getIndices",value:function(){return s({complexPolygons:this.complexPolygons,IndexType:this.IndexType})}},{key:"getPositions",value:function(){return this.attributes.positions}},{key:"getPositions64xyLow",value:function(){return this.attributes.positions64xyLow}},{key:"getVertexValid",value:function(){return this.attributes.vertexValid}},{key:"getElevations",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=void 0===e?"elevations":e,i=t.getElevation,o=void 0===i?function(){return 100}:i,r=this.attributes,a=this.complexPolygons,s=this.pointCount,l=u({cache:r[n],complexPolygons:a,pointCount:s,getElevation:o});return r[n]=l,l}},{key:"getColors",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=void 0===e?"colors":e,i=t.getColor,o=void 0===i?function(){return T}:i,r=this.attributes,a=this.complexPolygons,s=this.pointCount,l=c({cache:r[n],complexPolygons:a,pointCount:s,getColor:o});return r[n]=l,l}},{key:"getPickingColors",value:function(){return this.attributes.pickingColors}}]),t}()},,,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(){var t=["position:absolute;","left:0;","top:0;","overflow:hidden;","z-index:1000;","width:100%;","height:100%;"],e=document.createElement("div");e.style.cssText=t.join("");var n=document.createElement("div");return n.style.cssText="left:0;top:0;z-index:101;",e.appendChild(n),{root:e,childs:{domOverlayLayer:n}}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(223),a=i(r),s=n(140),l=i(s),u=n(113),c=i(u),f=n(17),d=i(f),h=n(16),v=i(h),p=n(3),_=i(p),m=n(0),g=i(m),y=n(1),x=i(y),b=n(5),S=i(b),w=n(4),E=i(w),T=n(775),A=i(T),P=n(747),I=i(P),k=n(735),L=i(k),M=n(627),C=i(M),R=n(248),B=n(629),N=i(B),O=n(472),D=i(O),z=n(474),F=i(z),V=n(473),Y=i(V),U=n(294),j=n(376),G=n(726),Z=n(43),H=n(399),W=i(H),X=n(23),Q=i(X),q=n(105),K=i(q),J=n(637),$=i(J),tt=n(736),et=i(tt),nt=n(112),it=n(29),ot=n(41),rt=i(ot),at=n(137),st=n(304),lt=n(663),ut=i(lt),ct=n(486),ft=i(ct),dt=n(143),ht=n(794),vt=n(750),pt=n(660),_t=n(28),mt=n(463),gt=n(630),yt=n(106),xt=n(47),bt=n(209),St=n(74),wt=n(10),Et=rt.default.isString,Tt=rt.default.isUndefined,At=rt.default.isBoolean,Pt=rt.default.isNumber,It=rt.default.isObject,kt={center:new xt(39.88795,116.49369),zoom:13,minZoom:Q.default.minZoom,maxZoom:Q.default.maxZoom,minPitch:Q.default.minPitch,maxPitch:Q.default.maxPitch,rotation:0,pitch:0,scale:1,offset:{x:0,y:0},draggable:!0,scrollable:!0,pitchable:!0,rotatable:!0,doubleClickZoom:!0,mapZoomType:st.MAP_ZOOM_TYPE.DEFAULT,viewMode:at.VIEW_MODE.MAP_3D,mapStyleId:"DEFAULT",showControl:!0,enableExtendZoom:!1},Lt=_t.isLowMobileDevice()?30:55,Mt=wt.uniqueId(),Ct=function(t){function e(t,n){(0,g.default)(this,e);var i=(0,S.default)(this,(e.__proto__||(0,_.default)(e)).call(this)),o=Date.now();n=wt.extend({},kt,n),n.heading=360-n.rotation;var r=n,a=r.minZoom,s=r.maxZoom,l=r.minPitch,u=r.maxPitch;if("number"==typeof a?n.minZoom=Math.max(a,Q.default.minZoom):(new it.ClassTypeError("MapOptions的minZoom参数","Number",a).warn(),n.minZoom=Q.default.minZoom),"number"==typeof s)if(n.enableExtendZoom){if(s>Q.default.maxZoom){var c=Math.min(s,25);Q.default.maxZoom=c,n.maxZoom=c}}else n.maxZoom=Math.min(n.maxZoom,Q.default.maxZoom);else new it.ClassTypeError("MapOptions的maxZoom参数","Number",s).warn(),n.maxZoom=Q.default.maxZoom;"number"==typeof l?n.minPitch=Math.max(l,Q.default.minPitch):(new it.ClassTypeError("MapOptions的minPitch参数","Number",l).warn(),n.minPitch=Q.default.minPitch),"number"==typeof u?n.maxPitch=Math.min(u,Q.default.maxPitch):(new it.ClassTypeError("MapOptions的maxPitch参数","Number",u).warn(),n.maxPitch=Q.default.maxPitch),i._destroyed=!1,i._glContextLost=!1,i.drawContainer=Et(t)?document.getElementById(t):t,i._uniqueId="map-"+i.drawContainer.id+"_"+wt.uniqueId(),i._initContainer();var f=n,d=f.subkey,h=f.subpid;(0,U.checkKey)(i.id,{subkey:d,subpid:h}),i.subkey=d,i.subpid=h,n.map=i;var p=new A.default(i.canvasContainer,n);i.renderEngine=p,i.drawManager=new vt(p),i.transform=new ht(n,p),i.transform._setEventedParent(i,null),i.controlManager=new C.default(i),i.layerResource=new pt(n,i),i.indoorManager=new $.default({map:i}),i.OverseaManager=new et.default({map:i}),i.fpsManager=new I.default,i.fpsManager.map=i,i.fpsManager.setCallback(i._render.bind(i)),i._shouldKeepHighFps=!1,i._renderCallbackList=[],(0,v.default)(i,j.easableMixin),(0,v.default)(i,G.animatableMap),wt.bindAll(["_onData","_render"],i),i._initListeners(),i.jumpTo({center:n.center,zoom:n.zoom,heading:n.heading||0,pitch:n.pitch||0,scale:n.scale||0}),i.highFpsReferIndex=0;var m=p.getDrawContainer();return i.resize(m.clientWidth,m.clientHeight),i._update(),i.handler=new mt(i,{mapZoomType:n.mapZoomType}),i._bubbleMiddleware=new L.default(i,i._checkFeaturePickingType(n)),i.setDraggable(n.draggable),i.setScrollable(n.scrollable),i.setDoubleClickZoom(n.doubleClickZoom),i.setViewMode(n.viewMode),i.setShowControl(n.showControl),i.dragRotate.setRotatable(n.rotatable),i.dragRotate.setPitchable(n.pitchable),i._initControls(),i.enableAreaClip(n.clip),(0,Z.minfo)({zoom:n.zoom,pitch:n.pitch,rotation:n.rotation,width:i.transform.width,height:i.transform.height}),(0,Z.fps)(i),(0,Z.frt)(i,o,_t.isPC()?"pc":"mobile"),(0,Z.ds)(i,_t.isLowMobileDevice(),_t.mobileSystem()),i}return(0,E.default)(e,t),(0,x.default)(e,[{key:"_initListeners",value:function(){var t=this;this._on("preload",this._preLoad),this._on("data",this._onData),this._on("data",function(e){"metadata"===e.sourceDataType&&t._update()}),_t.on(this,"layer,transit_end",this._update.bind(this,!1)),this._on("move",_t.debounce(function(){t._update()},10)),this._on("tilesloaded",_t.debounce(function(){t._update()},250)),_t.on(this,"movestart,transit_start",function(){t._changeFPS(Lt)}),_t.on(this,"data,moveend,transit_end",_t.debounce(function(){t._destroyed||t._shouldKeepHighFps||t._changeFPS(6)},3e3)),_t.on(this,"moveend,data_loaded",_t.debounce(function(){t.renderEngine&&t.layerResource&&t.renderEngine.updateLabel(t.layerResource.getDrawLayers())},10)),this.on("mapstyle_changed",function(e){var n=e.styleId;t.renderEngine.onMapStyleUpdate(n),t.drawManager.resetGradualPlacement(),t._update()})}},{key:"resetRenderEngine",value:function(){this.renderEngine=new A.default(this.canvasContainer,{})}},{key:"_changeFPS",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt;this.fpsManager.updateFPS(t)}},{key:"keepHighFps",value:function(t){t?this.highFpsReferIndex+=1:this.highFpsReferIndex-=1,this.highFpsReferIndex=Math.max(this.highFpsReferIndex,0),this.highFpsReferIndex<=0?this._shouldKeepHighFps=!1:(this._changeFPS(Lt),this._shouldKeepHighFps=!0)}},{key:"setCenter",value:function(t,e){return this.jumpTo({center:t},e)}},{key:"getCenter",value:function(){return this.transform.center}},{key:"setZoom",value:function(t,e){return this.jumpTo({zoom:t},e),this}},{key:"getZoom",value:function(){return this.transform&&this.transform.zoom}},{key:"setPitch",value:function(t,e){return this._viewMode!==at.VIEW_MODE.MAP_2D&&this.getPitchable()?(this.jumpTo({pitch:t},e),this):this}},{key:"setMaxZoom",value:function(t,e){var n=this.transform;return isNaN(t)||!Pt(t)?(new it.BaseTypeError("maxZoom","number",t).error(),this):n.maxZoom===+t?this:(+t<n.minZoom||+t>Q.default.maxZoom?console.error("无法设置maxZoom,请检查maxZoom值是否大于"+Q.default.maxZoom+"，或小于当前minZoom。"):(n.zoom>t&&this.jumpTo({zoom:t},e),n.maxZoom=+t),this)}},{key:"setMinZoom",value:function(t,e){var n=this.transform;return isNaN(t)||!Pt(t)?(new it.BaseTypeError("minZoom","number",t).error(),this):n.minZoom===+t?this:(+t>n.maxZoom||+t<Q.default.minZoom?console.error("无法设置minZoom,请检查minZoom值是否小于"+Q.default.minZoom+"，或大于当前maxZoom。"):(n.zoom<t&&this.jumpTo({zoom:t},e),n.minZoom=+t),this)}},{key:"setMaxPitch",value:function(t,e){var n=this.transform;return isNaN(t)||!Pt(t)?(new it.BaseTypeError("maxPitch","number",t).error(),this):n.maxPitch===+t?this:(+t>n.maxPitch||+t>Q.default.maxPitch?console.error("无法设置maxPitch,请检查maxPitch值是否大于"+Q.default.maxPitch+"，或小于当前minPitch。"):(n.pitch>t&&this.jumpTo({pitch:t},e),n.maxPitch=+t),this)}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"getRoll",value:function(){return this.transform.roll}},{key:"setRoll",value:function(t){this.transform.roll=t}},{key:"frequentEaseTo",value:function(t){var e=this;if(this._once("moveend",function(){e._easeToStore=null}),!this.moving)return this._easeToStore=t,void this.easeTo(t);(0,d.default)(t).forEach(function(n){e._easeToStore[n]=t[n]}),this.easeTo(this._easeToStore)}},{key:"setPitchable",value:function(t){return At(t)?"2D"===this.getViewMode()||t===this.getPitchable()?this:(t?(this.dragRotate.setPitchable(!0),this.touchTilt.enable(),this.controlManager.setViewMode("3D")):(this.frequentEaseTo({pitch:0}),this.dragRotate.setPitchable(!1),this.touchTilt.disable(),this.controlManager.setViewMode("3D")),this):(new it.BaseTypeError("setPitchable参数","Boolean",t).error(),this)}},{key:"getPitchable",value:function(){return this.dragRotate.pitchable}},{key:"setRotatable",value:function(t){return At(t)?"2D"===this.getViewMode()||t===this.getRotatable()?this:(t?(this.dragRotate.setRotatable(!0),this.touchZoomRotate.enableRotation(),this.controlManager.setViewMode("3D")):(this.frequentEaseTo({rotation:0}),this.dragRotate.setRotatable(!1),this.touchZoomRotate.disableRotation(),this.controlManager.setViewMode("3D")),this):(new it.BaseTypeError("setRotatable参数","Boolean",t).error(),this)}},{key:"getRotatable",value:function(){return this.dragRotate.rotatable}},{key:"setScale",value:function(t,e){return Pt(t)?t<=0?this:(this.jumpTo({scale:t},e),this):(new it.BaseTypeError("scale","number",t).error(),this)}},{key:"getScale",value:function(){return this.transform.scale}},{key:"setOffset",value:function(t){return It(t)&&Pt(t.x)&&Pt(t.y)?(this.renderEngine.camera.setOffset(t),this.emit("offset_changed")):new it.ClassTypeError("Map.offset","Object:{x,y}",t).error(),this}},{key:"getOffset",value:function(){return this.renderEngine.camera.offset}},{key:"setRotation",value:function(t,e){return this._viewMode!==at.VIEW_MODE.MAP_2D&&this.getRotatable()?(this.jumpTo({heading:360-t},e),this):this}},{key:"getRotation",value:function(){return 360-this.transform.heading}},{key:"getHeading",value:function(){return this.transform.heading}},{key:"getContainer",value:function(){return this.drawContainer}},{key:"getBounds",value:function(){return this.transform&&this.transform.getBounds()}},{key:"getRenderContainer",value:function(){return this.renderEngine.getDrawContainer()}},{key:"setDraggable",value:function(t){var e=t?"enable":"disable";return this.dragPan[e](),this.dragRotate[e](),this.longPress[e](),this.draggable=!!t,this}},{key:"getDraggable",value:function(){return this.draggable}},{key:"setScrollable",value:function(t){var e=t?"enable":"disable";return this.scrollZoom[e](),this}},{key:"getScrollable",value:function(){return this.scrollZoom.isEnabled()}},{key:"setDoubleClickZoom",value:function(t){var e=t?"enable":"disable";return this.doubleClickZoom[e](),this}},{key:"getDoubleClickZoom",value:function(){return this.doubleClickZoom.isEnabled()}},{key:"setBoundary",value:function(t){return this.transform.boundary=t,this._update(),this}},{key:"getBoundary",value:function(){return this.transform.boundary}},{key:"getIndoorManager",value:function(){return this.indoorManager}},{key:"getLightManager",value:function(){return this.renderEngine.lightManager}},{key:"setViewMode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:at.VIEW_MODE.MAP_3D,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t=String(t).toUpperCase(),this._viewMode===t)return this;switch(t){case at.VIEW_MODE.MAP_2D:this.easeTo({pitch:0,heading:0,roll:0},e),this.dragRotate.disable(),this.touchZoomRotate.disableRotation(),this.touchTilt.disable();break;default:if(new it.EnumError("viewMode",[at.VIEW_MODE.MAP_2D,at.VIEW_MODE.MAP_3D,at.VIEW_MODE.SPHERE],t).error(),!Tt(this.getViewMode()))return this;t=at.VIEW_MODE.MAP_3D;case at.VIEW_MODE.SPHERE:case at.VIEW_MODE.MAP_3D:this.draggable&&(this.dragRotate.enable(),this.touchZoomRotate.enableRotation(),this.touchTilt.enable())}return this.controlManager.setViewMode(t),this.transform.transitTo(t,e),this._viewMode=t,this}},{key:"getViewMode",value:function(){return this._viewMode}},{key:"getBaseMap",value:function(){return this.layerResource.baseMap}},{key:"setBaseMap",value:function(t){this.layerResource.baseMap=t;var e=this.getControl(Mt);return e&&e.updateMapAppNum(this.layerResource.hasSatellite()),this}},{key:"setMapStyleId",value:function(t){return t&&Et(t)?this.layerResource.setMapStyleId(t):console.error("传入的mapStyleId有误："+t),this}},{key:"setMapStyleConfig",value:function(t){return It(t)?"{}"===(0,c.default)(t)?(console.error("setMapStyleConfig传入的参数为空对象"),this):(this.layerResource.setMapStyleConfig(t),this):(new it.BaseTypeError("StyleConfig","object",t).error(),this)}},{key:"getShowControl",value:function(){return this._showControl}},{key:"setShowControl",value:function(t){this._showControl=t}},{key:"getControl",value:function(t){return this.controlManager.getControl(t)}},{key:"removeControl",value:function(t){return this.controlManager.removeControl(t),this}},{key:"addControl",value:function(t){return this.controlManager.addControl(t),this}},{key:"panTo",value:function(t,e,n){return this.easeTo({center:t},e,n)}},{key:"panBy",value:function(t,e,n){return t=St.convert(t).mult(-1),this.panTo(this.transform.center,wt.extend({offset:t},e),n)}},{key:"flyTo",value:function(){}},{key:"zoomBy",value:function(t,e,n){var i=this.getZoom()+t,o=this.transform;i=Math.max(Math.min(i,o.maxZoom),o.minZoom),this.zoomTo(i,e,n)}},{key:"zoomTo",value:function(t,e,n){return this.easeTo({zoom:t},e,n)}},{key:"rotateTo",value:function(t,e,n){return this.easeTo({rotation:t},e,n)}},{key:"headTo",value:function(t,e,n){return this.easeTo({heading:t},e,n)}},{key:"pitchTo",value:function(t,e){return this.easeTo({pitch:t},e)}},{key:"naviTo",value:function(t,e,n,i){return this.easeTo({heading:e,center:t},wt.extend({isMatrix:!1},n),i)}},{key:"jumpTo",value:function(t,e){this.stopMoving();var n=this.transform,i=!1,o=!1,r=!1,a=!1,s=!1;return"zoom"in t&&n.zoom!==+t.zoom&&((0,l.default)(+t.zoom)?new it.BaseTypeError("zoom","number",t.zoom).error():(i=!0,n.zoom=+t.zoom)),"center"in t&&(n.center=xt.convert(t.center),a=!0),"heading"in t&&n.heading!==+t.heading&&(o=!0,n.heading=+t.heading),"pitch"in t&&n.pitch!==+t.pitch&&(r=!0,n.pitch=+t.pitch),"roll"in t&&n.roll!==+t.roll&&(s=!0,n.roll=+t.roll),"scale"in t&&n.scale!==t.scale&&(n.scale=t.scale),this._fire("movestart",e)._fire("move",e),i&&this._fire("zoomstart",e)._fire("zoom",e)._fire("zoomend",e),o&&this._fire("rotate",e),r&&this._fire("pitchstart",e)._fire("pitch",e)._fire("pitchend",e),s&&this._fire("rollstart",e)._fire("roll",e)._fire("rollend",e),a&&this._fire("panstart",e)._fire("pan",e)._fire("panend",e),this._fire("moveend",e)}},{key:"easeTo",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2];this.stopMoving(),n=wt.extend({offset:[0,0],duration:500,easing:wt.ease},n),!1===n.animate&&(n.duration=0);var o=this.transform,r=this.getZoom(),a=this.getHeading(),s=this.getPitch(),l=this.getRoll(),u=this.getCenter(),c=r,f=a,d=s,h=l;Pt(t.zoom)?c=t.zoom:Tt(t.zoom)||new it.BaseTypeError("mapStatus.zoom","number",t.zoom).error(),Pt(t.rotation)?f=this._normalizeHeading(360-t.rotation,a):Tt(t.rotation)||new it.BaseTypeError("mapStatus.rotation","number",t.rotation).error(),Pt(t.heading)&&(f=this._normalizeHeading(t.heading,a)),Pt(t.pitch)?d=t.pitch:Tt(t.pitch)||new it.BaseTypeError("mapStatus.pitch","number",t.pitch).error(),Pt(t.roll)?h=t.roll:Tt(t.roll)||new it.BaseTypeError("mapStatus.roll","number",t.roll).error();var v=null,p=null;n.around&&(v=n.around,p=this.projectToContainer(v));var _=this.projectToContainer(u),m=St.convert(n.offset),g=xt.convert(t.center||u);this._normalizeCenter(g);var y=o.latLngToCoord(u),x=o.latLngToCoord(g),b=x.sub(y),S=o.zoomScale(c-r);return this.zooming=c!==r&&c<=o.maxZoom&&c>=o.minZoom,this.rotating=a!==f,this.pitching=d!==s,this.panning=0!==b.add(m).length(),this.rolling=l!==h,this._viewMode===at.VIEW_MODE.MAP_2D&&(this.rotating=!1,this.pitching=!1,this.rolling=!1),this.zooming+this.rotating+this.pitching+this.rolling+this.panning?(this._prepareMoving(i,n.noMoveStart),clearTimeout(this._onEaseEnd),this._ease(function(t){if(this.zooming&&(o.zoom=(0,W.default)(r,c,t)),this.rotating&&(o.heading=(0,W.default)(a,f,t)),this.pitching&&(o.pitch=(0,W.default)(s,d,t)),this.rolling&&(o.roll=(0,W.default)(l,h,t)),n.around)o.setLocationAtPoint(v,p);else{var e=o.zoomScale(o.zoom-r),u=c>r?Math.min(2,S):Math.max(.5,S),g=Math.pow(u,1-t),x=b.mult(t*g),w=_.add(m.mult(t*g)),E=o.coordToLatLng(y.add(x).mult(e),o.zoom);o.setLocationAtPoint(E,w)}this._fireMoveEvents(i)},function(){n.delayEndEvents?e._onEaseEnd=setTimeout(function(){return e._moveToEnd(i)},n.delayEndEvents):e._moveToEnd(i)},function(){e._moveToEnd(i,!0)},n),this):this}},{key:"getNonStopRotate",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments[1];if(!this.rotateTickTimer){this.rotating=!0;var i=this.transform;this.rotateTickTimer=function(o){t.isRotateAnimationRunning&&(-1===o?i.heading-=.8*e:i.heading+=.8*e,_t.frame(t.rotateTickTimer.bind(t,o)),t._fireMoveEvents(n))}}return{begin:function(e){t._prepareMoving(n),t.rotating=!0,t.isRotateAnimationRunning=!0,t.rotateTickTimer(e)},cancel:function(){t.isRotateAnimationRunning&&(t._moveToEnd(n),t.isRotateAnimationRunning=!1)}}}},{key:"getNonStopPitch",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments[1];if(!this.pitchTickTimer){this.pitching=!0;var i=this.transform;this.pitchTickTimer=function(o){t.isPitchAnimationRunning&&(-1===o?i.pitch-=.8*e:i.pitch+=.8*e,_t.frame(t.pitchTickTimer.bind(t,o)),t._fireMoveEvents(n))}}return{begin:function(e){t._prepareMoving(n),t.isPitchAnimationRunning=!0,t.pitching=!0,t.pitchTickTimer(e)},cancel:function(){t.isPitchAnimationRunning&&(t.pitching=!1,t._moveToEnd(n),t.isPitchAnimationRunning=!1)}}}},{key:"_prepareMoving",value:function(t,e){this.moving=!0,e||(this._fire("movestart",t),this.zooming&&this._fire("zoomstart",t),this.rotating&&this._fire("rotatestart",t),this.pitching&&this._fire("pitchstart",t),this.panning&&this._fire("panstart",t))}},{key:"_fireMoveEvents",value:function(t){this._fire("move",t),this.zooming&&this._fire("zoom",t),this.rotating&&this._fire("rotate",t),this.pitching&&this._fire("pitch",t),this.panning&&this._fire("pan",t)}},{key:"_moveToEnd",value:function(t,e){var n=this.zooming,i=this.rotating,o=this.pitching,r=this.panning;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.panning=!1,n&&this._fire(e?"zoomcancel":"zoomend",t),i&&this._fire(e?"rotatecancel":"rotateend",t),o&&this._fire(e?"pitchcancel":"pitchend",t),r&&this._fire(e?"pancancel":"panend",t),this._fire(e?"movecancel":"moveend",t)}},{key:"resetNorth",value:function(t,e){return this.rotateTo(0,wt.extend({duration:1e3},t),e),this}},{key:"snapToNorth",value:function(t,e){return Math.abs(this.getHeading())<7?this.resetNorth(t,e):this}},{key:"fitBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(t&&t instanceof bt))return new it.ClassTypeError("Map.fitBounds的bounds参数","LatLngBounds",t).error(),this;var n=e.minZoom,i=void 0===n?this.transform.minZoom:n,o=e.maxZoom,r=void 0===o?this.transform.maxZoom:o,a=e.animate,s=void 0===a||a,l=e.ease,u=void 0;if(Pt(e.padding)){var c=e.padding;u={top:c,bottom:c,right:c,left:c}}else u=(0,v.default)({top:0,bottom:0,right:0,left:0},e.padding);if(!wt.deepEqual((0,d.default)(u).sort(function(t,e){return t<e?-1:t>e?1:0}),["bottom","left","right","top"]))return void wt.warnOnce("FitBoundsOptions.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'");t=bt.convert(t);var f=u,h=f.top,p=f.bottom,_=f.left,m=f.right,g=[(_-m)/2,(h-p)/2],y=St.convert(g),x=this.transform,b=x.latLngToCoord(t.getNorthWest()),S=x.latLngToCoord(t.getSouthEast()),w=x._minZoom,E=x.coordToLatLng(b.add(S).div(2));if(0===x.pitch){var T=S.sub(b),A=(x.width-m-_)/T.x,P=(x.height-h-p)/T.y;if(P<0||A<0)return wt.warnOnce("传入参数无效导致map无法进行fitBounds操作"),this;w=x.scaleZoom(x.scrollScale*Math.min(A,P))}else w=this._getZoomByBounds(t,{padding:u});w=Math.max(Math.min(w,r),i);var I={center:E,zoom:w,heading:0};return s?this.easeTo(I,(0,v.default)({offset:y},l)):this.jumpTo(I),this}},{key:"_getZoomByBounds",value:function(t,e){var n=e.padding,i=n.top,o=n.bottom,r=n.left,a=n.right,s=[(r-a)/2,(i-o)/2],l=St.convert(s),u=this.transform,c=u._minZoom,f=u._maxZoom,d=u._minPitch,h=u._maxPitch,v=u._fov,p=u.width,_=u.height,m=u.zoom,g=u.tileZoom,y=u._center,x=u._pitch,b=u._roll,S=u._scale,w=u.viewTransition,E=u._boundary,T={minZoom:c,maxZoom:f,minPitch:d,maxPitch:h,fov:v,width:p,height:_,zoom:m,tileZoom:g,center:y,pitch:x,roll:b,scale:S,viewTransition:w,boundary:E,heading:0},A=x/Math.PI*180,P=b/Math.PI*180;this.renderEngine.camera.setRotate(A,0,P);var I=new ht(T,this.renderEngine),k=c,L=c,M=f,C=!1,R=this._getCenterByBounds(t),B={x:p/2,y:_/2};for(B.x=B.x+l.x,B.y=B.y+l.y;M-L>.001;){k=(L+M)/2,I.zoom=k,I.setLocationAtPoint(R,B);var N=I.latLngToScreen(t.getNorthWest()),O=I.latLngToScreen(t.getSouthEast()),D=I.latLngToScreen(t.getSouthWest()),z=I.latLngToScreen(t.getNorthEast()),F=Math.min.apply(null,[N.x,O.x,D.x,z.x]),V=Math.max.apply(null,[N.x,O.x,D.x,z.x]),Y=Math.min.apply(null,[N.y,O.y,D.y,z.y]),U=Math.max.apply(null,[N.y,O.y,D.y,z.y]);F>r&&Y>i&&V<p-a&&U<_-o?(C=!0,L=k):(M=k,C=!1)}return C||(k=L),k}},{key:"_getCenterByBounds",value:function(t){var e=this.transform,n=e.latLngToCoord(t.getNorthWest()),i=e.latLngToCoord(t.getSouthEast());return e.coordToLatLng(n.add(i).div(2))}},{key:"getZoomByBounds",value:function(t){var e=this.transform,n=e.latLngToCoord(t.getNorthWest()),i=e.latLngToCoord(t.getSouthEast()),o=i.sub(n),r=e.width/o.x,a=e.height/o.y;return a<0||r<0?void wt.warnOnce("bounds error!"):Math.min(e.scaleZoom(e.scrollScale*Math.min(r,a)),e.maxZoom)}},{key:"stopMoving",value:function(){return this.stopEase(),this.stopAnimation(),this}},{key:"stopEase",value:function(){return this._abortFn&&(this._abortFn(),this._finishEase()),this}},{key:"getSource",value:function(t){return this.layerResource.getSource(t)}},{key:"addSource",value:function(t,e){this.layerResource.addSource(t,e)}},{key:"removeSource",value:function(t){this.layerResource.removeSource(t)}},{key:"addLayer",value:function(t){this.layerResource.addLayer(t)}},{key:"removeLayer",value:function(t){this.layerResource.removeLayer(t)}},{key:"moveLayer",value:function(t,e){return this.layerResource.moveLayer(t,e),this}},{key:"getLayer",value:function(t){return this.layerResource.getLayer(t)}},{key:"findLayer",value:function(t){return this.layerResource.findLayer(t)}},{key:"addVisualPlugin",value:function(t){this.layerResource.addVisualPlugin(t),this._update()}},{key:"removeVisualPlugin",value:function(t){this.layerResource.removeVisualPlugin(t),this._update()}},{key:"indoorStateChange",value:function(t,e){this.layerResource.updateIndoorData(t,e)}},{key:"unprojectFromContainer",value:function(t){return t instanceof St?this.transform.screenToLatLng(t):t&&t.x&&t.y?this.transform.screenToLatLng(new St(t.x,t.y)):(new it.ClassTypeError("Map.unprojectFromContainer的point参数","Point",t).error(),null)}},{key:"projectToContainer",value:function(t){if(t instanceof xt){var e=this.transform.latLngToScreen(t);return new St(e.x,e.y)}return new it.ClassTypeError("Map.projectToContainer的latLng参数","LatLng",t).error(),null}},{key:"projectToCenterLocalPlane",value:function(t){if(t instanceof xt){return this.transform.latLngToCenterLocalPixel(t)}return new it.ClassTypeError("Map.projectToCenterLocalPlane的latLng参数","LatLng",t).error(),null}},{key:"projectToWorldPlane",value:function(t,e){if(t instanceof xt){return this.transform.latLngToCoord(t,e)}return new it.ClassTypeError("Map.projectToWorldPlane的latLng参数","LatLng",t).error(),null}},{key:"_getSpatialResolution",value:function(t,e){t=t||this.getZoom();var n=(e||this.getCenter().getLat())*Math.PI/180;return(0,nt.getSpatialResolution)(t)*Math.cos(n)/this.getScale()}},{key:"_onData",value:function(){this.drawManager.updatePlace(),this._rerender()}},{key:"_preLoad",value:function(){this.layerResource._sources.vector_source.preload(this.transform)}},{key:"_normalizeHeading",value:function(t,e){t=wt.wrap(t,-180,180);var n=Math.abs(t-e);return Math.abs(t-360-e)<n&&(t-=360),Math.abs(t+360-e)<n&&(t+=360),t}},{key:"_normalizeCenter",value:function(t){var e=this.transform,n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},{key:"_rerender",value:function(){this._changeFPS(Lt),this.fpsManager.start()}},{key:"_render",value:function(){var t=this.getRenderContainer();this.resize(t.clientWidth,t.clientHeight);var e=this.drawManager.render(this.layerResource,this.transform);this._bubbleMiddleware&&this._bubbleMiddleware.runPick(),e&&this._rerender(),this._renderCallbackList.forEach(function(t){return t&&t()})}},{key:"addRenderCallback",value:function(t){this._renderCallbackList.push(t)}},{key:"removeRenderCallback",value:function(t){var e=this._renderCallbackList.indexOf(t);this._renderCallbackList.splice(e,1)}},{key:"resize",value:function(t,e){t&&e&&(t===this.width&&e===this.height||(this.width=t,this.height=e,this.transform.resize(t,e),this.drawManager.resize(t,e),this._update(),this._frameId=null,this._fire("resize",{width:t,height:e},!0)))}},{key:"_update",value:function(){this._destroyed||this._glContextLost||(this.layerResource._updateSource(this.transform,this.renderEngine.camera,{causedBy:"move"}),this.drawManager.updatePlace(),this._rerender())}},{key:"_initContainer",value:function(){this.drawContainer.style.webkitTapHighlightColor="rgba(0,0,0,0)","static"===getComputedStyle(this.drawContainer).getPropertyValue("position")&&(this.drawContainer.style.position="relative");var t=document.createElement("canvas");t.style.cssText="width:100%; height: 100%;";var e=o();this.drawContainer.appendChild(t),this.drawContainer.appendChild(e.root),this.canvasContainer=t,this._overlayer=e}},{key:"_initControls",value:function(){var t=this;if((0,U.checkKey)(this.id).then(function(e){void 0!==e||K.default.isLocal||t.addControl(new N.default({position:R.CONTROL_POSITION.BOTTOM_CENTER}))}),this.addControl(new gt({id:Mt,position:R.CONTROL_POSITION.BOTTOM_LEFT,hasSatellite:this.layerResource.hasSatellite()})),this.lgId=Mt,!1===this._showControl)return this;this.addControl(new D.default({id:R.DEFAULT_CONTROL_ID.SCALE,position:R.CONTROL_POSITION.BOTTOM_LEFT,center:this.getCenter(),zoom:this.getZoom(),scale:this.getScale()})),this.addControl(new F.default({id:R.DEFAULT_CONTROL_ID.ZOOM,position:R.CONTROL_POSITION.TOP_RIGHT})),this.addControl(new Y.default({id:R.DEFAULT_CONTROL_ID.ROTATION,position:R.CONTROL_POSITION.TOP_RIGHT}))}},{key:"_onContextError",value:function(t){"restored"===t?(this._rerender(),this._glContextLost=!1,(0,Z.err)({type:"ctx",code:1}),this._fire("context_restored")):(this.stop(),this._glContextLost=!0,(0,Z.err)({type:"ctx",code:0}),this._fire("context_lost"))}},{key:"enableAreaHighlight",value:function(t){var e=t.layerId||"$tmap_highlight",n=this.getLayer(e);if(n||(n=new ut.default({id:e,map:this,geometries:[]})),t){var i=t.paths,o=void 0===i?[]:i,r=t.highlightColor,a=t.shadeColor;n.update([{id:"highlight",paths:o}],{highlightColor:r,shadeColor:a})}return n.setVisible(!0),this}},{key:"disableAreaHighlight",value:function(t){var e=t&&t.layerId||"$tmap_highlight",n=this.getLayer(e);return n?(n.setVisible(!1),this):this}},{key:"enableAreaClip",value:function(t){if(t&&t.paths&&this._checkMaskPaths(t.paths)){t.layerId="$tmap_clip_highlight",t.shadeColor=this.renderEngine.getBgColor(),this.enableAreaHighlight(t),this.moveLayer("$tmap_clip_highlight",dt.LAYER_LEVEL.OVERLAY_AA);var e=this.getLayer("$tmap_clip_clip");e||(e=new ft.default({map:this,id:"$tmap_clip_clip",geometries:[],isMaskReverse:!0})),e.add([{id:"$tmap_clip_clip",paths:t.paths}]),this.clipOptions=t,this.on("bgcolor_change",this._updateClipBgColor)}}},{key:"disableAreaClip",value:function(){this.disableAreaHighlight({layerId:"$tmap_clip_highlight"}),this.removeLayer("$tmap_clip_clip"),this.removeSource("$tmap_clip_clip"),this.off("bgcolor_change",this._updateClipBgColor)}},{key:"_updateClipBgColor",value:function(t){this.enableAreaHighlight((0,a.default)({},this.clipOptions,{shadeColor:t})),this.moveLayer("$tmap_clip_highlight",dt.LAYER_LEVEL.OVERLAY_AA)}},{key:"_checkMaskPaths",value:function(t){if(!Array.isArray(t))return!1;var e=!0;return t.forEach(function(t,n){rt.default.isValidLatLng(t)||(e=!1,console.error("areaClip.paths: 希望传入Geometry数组，实际第"+n+"元素非latlng格式！"))}),e}},{key:"_checkFeaturePickingType",value:function(t){var e=t.enableFeaturePicking,n=t.featurePickingRadius,i=e,o=n;return e?(isNaN(n)||!Pt(n)?(new it.BaseTypeError("featurePickingRadius","number",n).error(),o=null):n<=0&&(o=null),At(e)||(new it.BaseTypeError("enableFeaturePicking","Boolean",e).error(),i=!1),{featurePicking:i,pickingRadius:o}):{}}},{key:"stop",value:function(){this.fpsManager.stop()}},{key:"destroy",value:function(){this._destroyed||(this.emit("destroy"),this.stopMoving(),(0,U.revokeKeyCheck)(this.id),this.controlManager.destroy(),this.handler.destroy(),this.fpsManager.destroy(),this.layerResource.destroy(),this._bubbleMiddleware.destroy(),this.renderEngine.destroy(),this.drawManager.destroy(),this.indoorManager=null,this.fpsManager=null,this.handler=null,this.layerResource=null,this._bubbleMiddleware=null,this.renderEngine=null,this.drawManager=null,this.transform=null,this._clearAllListeners(),this.drawContainer.innerHTML="",this.canvasContainer.width=1,this.canvasContainer.height=1,this.canvasContainer=null,this._overlayer=null,this.drawContainer=null,this.isPitchAnimationRunning=null,this.isRotateAnimationRunning=null,this.pitchTickTimer=null,this.rotateTickTimer=null,this._destroyed=!0)}},{key:"_getPoiInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.drawManager.getPoi(t);if(e){e.latLng=this.unprojectFromContainer(e.coord);var n=Math.round(this.getZoom())>=Q.default.minShowIndoorZoom&&this.indoorManager.getVisible()&&this.indoorManager.getIndoorBuildingList().length;if(!e.isIndoor&&n)for(var i=this.indoorManager.getIndoorBuildingList(),o=0;o<i.length;o++){var r=i[o],a=r.getBuildingInfo();if(a&&a.bounds.contains(e.latLng)){e=null;break}}}return e}},{key:"id",get:function(){return this._uniqueId}}]),e}(yt);e.default=Ct},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){if((0,T.isSimple)(t)){for(var e=[],n=t.length,i=0;i<n;i++){var r=void 0;if(i<n-1)r=[t[i],t[i+1]];else{if(t[i].equals(t[0]))continue;r=[t[i],t[0]]}e.push(r)}return e}return t.map(function(t){return o(t)}).flat()}var r=n(16),a=i(r),s=n(17),l=i(s),u=n(3),c=i(u),f=n(0),d=i(f),h=n(1),v=i(h),p=n(5),_=i(p),m=n(35),g=i(m),y=n(4),x=i(y),b=n(303),S=i(b),w=n(220),E=n(66),T=n(298),A=n(339),P=i(A),I=n(506),k=i(I),L=n(29),M=n(41),C=i(M),R=n(10),B=i(R),N=n(218),O=N.PolygonStyle,D=n(218),z=D.ExtrudablePolygonStyle,F=C.default.isValidColor,V=C.default.isNumber,Y=function(t){function e(t){(0,d.default)(this,e);var n=(0,_.default)(this,(e.__proto__||(0,c.default)(e)).call(this,t));return n._createSubOverlay(t),n}return(0,x.default)(e,t),(0,v.default)(e,[{key:"_initialize",value:function(){this._childGeometryOverlays=[]}},{key:"_setGeometryType",value:function(){this._geometryType=w.GEOMETRY_TYPES.POLYGON,this._layerType=E.RENDER_LAYER_TYPE.polygon,this._className="MultiPolygon"}},{key:"_checkGeometries",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t,e){t?t.styleId||(t.styleId="default"):console.error("MultiPolygon.geometries: 希望传入PolygonGeometry数组，实际第"+e+"元素不存在！"),t.paths&&((0,T.isSimple)(t.paths)||(0,T.isPart)(t.paths)||(0,T.isComplex)(t.paths))||console.error("MultiPolygon.geometries: 希望传入PolygonGeometry数组，实际第"+e+"元素的paths属性无效！")})}},{key:"_getDefaultStyle",value:function(){return new O}},{key:"_checkStyles",value:function(t){(0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"_checkStyles",this).call(this,t),(0,l.default)(t).forEach(function(e){var n=t[e];n&&(n instanceof O||n instanceof z)?n instanceof O?F(n.color)?F(n.borderColor)||console.error("MultiPolygon.styles: 样式id ",e," 对应的PolygonStyle.borderColor属性无效",n):console.error("MultiPolygon.styles: 样式id ",e," 对应的PolygonStyle.color属性无效",n):n instanceof z&&(F(n.color)?F(n.borderColor)?V(n.extrudeHeight)||console.error("MultiPolygon.styles: 样式id ",e," 对应的ExtrudablePolygonStyle.extrudeHeight属性无效",n):console.error("MultiPolygon.styles: 样式id ",e," 对应的ExtrudablePolygonStyle.borderColor属性无效",n):console.error("MultiPolygon.styles: 样式id ",e," 对应的ExtrudablePolygonStyle.color属性无效",n)):console.error("MultiPolygon.styles: 样式id ",e,"希望传入PolygonStyle或ExtrudablePolygonStyle实例，实际传入：",n)})}},{key:"_createSubOverlay",value:function(t){var e=this._extractSubStyles(),n=this._extractSubGeometries(),i=new k.default((0,a.default)(t,{id:this.id+"_border",styles:e,geometries:n}));this._childGeometryOverlays.push(i)}},{key:"_extractSubGeometries",value:function(){var t=this;return this.geometries.reduce(function(e,n){var i=t.styles[n.styleId]||t.styles.default;if(i&&i.showBorder&&i instanceof O){var o=(0,T.getBorderPolyline)(n.paths);e.push({styleId:n.styleId,paths:o,rank:n.rank})}return e},[])}},{key:"_extractSubStyles",value:function(){var t={};return B.default.forIn(this.styles,function(e,n){n&&n.showBorder&&n instanceof O&&(t[e]=new P.default({id:e,color:n.borderColor,width:n.borderWidth,lineCap:"round",dashArray:n.borderDashArray}))}),t}},{key:"setVisible",value:function(t){return t=Boolean(t),(0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"setVisible",this).call(this,t),this._childGeometryOverlays.forEach(function(e){e.setVisible(t)}),this}},{key:"setMap",value:function(t){return(0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"setMap",this).call(this,t),this._childGeometryOverlays.forEach(function(e){return e.setMap(t)}),this}},{key:"setZIndex",value:function(t){return V(t)?t<0?(console.error("zIndex希望设置为非负数,实际值为: "+t),this):((0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"setZIndex",this).call(this,t),this._childGeometryOverlays.forEach(function(e){return e.setZIndex(t)}),this):(new L.BaseTypeError("zIndex","Number",t).error(),this)}},{key:"updateGeometries",value:function(t,n){return t?((0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"updateGeometries",this).call(this,t,n),this._updateSubGeometries(),this):this}},{key:"_updateSubGeometries",value:function(){var t=this._extractSubGeometries();this._childGeometryOverlays.forEach(function(e){return e.setGeometries(t)})}},{key:"_updateSubStyles",value:function(){var t=this._extractSubStyles();this._childGeometryOverlays.forEach(function(e){return e.setStyles(t)}),this._updateSubGeometries()}},{key:"setGeometries",value:function(t){return t?((0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"setGeometries",this).call(this,t),this._updateSubGeometries(),this):this}},{key:"setStyles",value:function(t){return t?((0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"setStyles",this).call(this,t),this._updateSubStyles(),this):this}},{key:"destroy",value:function(){this._childGeometryOverlays.forEach(function(t){return t.destroy()}),(0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"destroy",this).call(this)}},{key:"_getAllPoints",value:function(){return this.geometries.map(function(t){return t.paths.flat(1/0)}).flat()}},{key:"_getAllSegments",value:function(){return this.geometries.map(function(t){return o(t.paths)}).flat()}}]),e}(S.default);t.exports=Y},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(m(t)){var n=(0,u.default)(t,2),i=n[0],o=n[1];return _(i)&&_(o)?(i=Math.max(Math.round(i),0),o=Math.max(Math.round(o),0),[i,o]):(new p.BaseTypeError("PolylineStyle."+e+"[index]","number",i),[0,0])}return new p.BaseTypeError("PolylineStyle."+e,"array",t).error(),[0,0]}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=["width","height","space"],n={};if(e.forEach(function(e){if(e in t){var i=t[e];_(i)?n[e]=Math.min(Math.max(i,0),255):new p.BaseTypeError("ArrowOptions."+e,"number",i).error()}}),!g(t.align)){var i=t.align;i in x?n.align=i:new p.EnumError("ArrowOptions.align",(0,s.default)(x),i).error()}return n}Object.defineProperty(e,"__esModule",{value:!0});var a=n(17),s=i(a),l=n(32),u=i(l),c=n(0),f=i(c),d=n(10),h=n(41),v=i(h),p=n(29),_=v.default.isNumber,m=v.default.isArray,g=v.default.isUndefined,y={color:"#3777FF",width:3,borderWidth:0,borderColor:"#3777FF",lineCap:"butt",dashArray:[0,0],showArrow:!1,arrowOptions:{width:6,height:4,space:50,align:"middle"},eraseColor:"#C2CBD2",enableBloom:!1},x={middle:0,left:1,right:2},b=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,f.default)(this,t),e=(0,d.extend)({},y,e),this.color=e.color,this.width=e.width,this.borderColor=e.borderColor,this.borderWidth=e.borderWidth||0,this.lineCap="round"===e.lineCap?2:"square"===e.lineCap?1:0,this.dashArray=o(e.dashArray,"dashArray"),this.eraseColor=e.eraseColor,this.enableBloom=!!e.enableBloom;var n=(0,d.extend)({},y.arrowOptions,r(e.arrowOptions)),i=n.width,a=n.height,s=n.space,l=n.align;this.arrowInfo=[i,a*!!e.showArrow,s,x[l]]};e.default=b},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(){return document.getElementsByTagName("head")[0]}function r(t){return[].concat((0,_.default)(new URLSearchParams(t.split("?")[1]))).reduce(function(t,e){var n=(0,v.default)(e,2),i=n[0],o=n[1];return t[i]=o,t},{})}function a(){return"cb"+(new Date).getTime().toString(36)+(I++).toString(36)}function s(t,e){P.push({name:t,sender:e})}function l(t){t.clearAttributes&&t.clearAttributes(),t[E]=null,t.onerror=null,t.parentNode&&t.parentNode.removeChild(t)}function u(t,e){var n=t.replace("https://apis.map.qq.com","").replace("&servicesk="+e,""),i=[].concat((0,_.default)(new URLSearchParams(n.split("?")[1]))).sort(function(t,e){return t[0].localeCompare(e[0])}).map(function(t){return t.join("=")}).join("&"),o=n.split("?")[0]+"?"+i+e;return"https://apis.map.qq.com"+n+"&sig="+(0,g.default)(o)}function c(t,e,n,i,a){var l=null,c=!1,f=[];e.indexOf("callback")>-1?(e=e.replace("&callback",""),f=["output=jsonp","callback="+A+"."+t]):f=["output=jsonp","pf=jsapi","ref=jsapi","cb="+A+"."+t];var h=S.createElement("script");h.setAttribute("type","text/javascript"),h.setAttribute("charset",a||"GBK"),h.async=!0;var v=e+(-1===e.indexOf("?")?"?":"&")+f.join("&"),p=r(v);p.servicesk&&(v=u(v,p.servicesk)),h.src=v,h.onerror=function(){c=!0,i&&i(),d(t)},T[t]=function(t){l=t},h[E]=function(){w.test(this.readyState)&&(d(t),l?(l.id=t,n&&n(l)):c||i&&i())};var _=o();_.insertBefore(h,_.firstChild),s(t,h)}function f(t,e,n,i){return t||(t=a()),b(function(){d(t),c(t,e,n,i)}),t}function d(t){if(t){for(var e=0,n=null,i=P.length;e<i;e++)if(P[e].name===t){n=P.splice(e,1)[0];break}n&&l(n.sender),T[t]&&delete T[t]}}var h=n(32),v=i(h),p=n(24),_=i(p),m=n(400),g=i(m),y=n(56),x=n(392),b=x.domReady,S=window.document,w=/loaded|complete|undefined/i,E=S.dispatchEvent?"onload":"onreadystatechange",T=window[y]._svcb||(window[y]._svcb={}),A=y+"._svcb",P=[],I=0;e.send=f,e.cancel=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.LIGHT_TYPE={AMBIENT:"ambient",DIRECTION:"dir",POINT:"point",SPOT:"spot"}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(35),h=i(d),v=n(4),p=i(v),_=n(211),m=i(_),g=[-1,-1,1,-1,-1,1,1,1],y=function(t){function e(t){(0,s.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t));return n.shaderParams={attributes:["aClipSpacePosition"],uniforms:t.uniformList||[]},n.vertices=new Float32Array(g),n}return(0,p.default)(e,t),(0,u.default)(e,[{key:"preDraw",value:function(){(0,h.default)(e.prototype.__proto__||(0,r.default)(e.prototype),"preDraw",this).call(this),this.buffers||(this.buffers=this.createBuffer(null,this.vertices)),this.bindBuffer()}},{key:"bindBuffer",value:function(){var t=this.gl;this.buffers.vertices.bind(),this.buffers.vertices.pointToAttrib({location:this.aClipSpacePosition,size:2,type:t.FLOAT})}},{key:"draw",value:function(t){var e=this.gl;e.useProgram(e.program),this.setUniforms(t),e.drawArrays(e.TRIANGLE_STRIP,0,4)}},{key:"setUniforms",value:function(){}}]),e}(m.default);e.default=y},function(t,e,n){t.exports={default:n(411),__esModule:!0}},function(t,e,n){var i=n(216),o=n(88),r=n(269);t.exports=function(t){return function(e,n,a){var s,l=i(e),u=o(l.length),c=r(a,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}}},function(t,e,n){"use strict";var i=n(62),o=n(11),r=n(206),a=n(286),s=n(253),l=n(348),u=n(284),c=n(63),f=n(61),d=n(350),h=n(288),v=n(427);t.exports=function(t,e,n,p,_,m){var g=i[t],y=g,x=_?"set":"add",b=y&&y.prototype,S={},w=function(t){var e=b[t];r(b,t,"delete"==t?function(t){return!(m&&!c(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(m&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof y&&(m||b.forEach&&!f(function(){(new y).entries().next()}))){var E=new y,T=E[x](m?{}:-0,1)!=E,A=f(function(){E.has(1)}),P=d(function(t){new y(t)}),I=!m&&f(function(){for(var t=new y,e=5;e--;)t[x](e,e);return!t.has(-0)});P||(y=e(function(e,n){u(e,y,t);var i=v(new g,e,y);return void 0!=n&&l(n,_,i[x],i),i}),y.prototype=b,b.constructor=y),(A||I)&&(w("delete"),w("has"),_&&w("get")),(I||T)&&w(x),m&&b.clear&&delete b.clear}else y=p.getConstructor(e,t,_,x),a(y.prototype,n),s.NEED=!0;return h(y,t),S[t]=y,o(o.G+o.W+o.F*(y!=g),S),m||p.setStrong(y,t,_),y}},function(t,e,n){"use strict";n(548);var i=n(206),o=n(215),r=n(61),a=n(245),s=n(78),l=n(433),u=s("species"),c=!r(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),f=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var d=s(t),h=!r(function(){var e={};return e[d]=function(){return 7},7!=""[t](e)}),v=h?!r(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[u]=function(){return n}),n[d](""),!e}):void 0;if(!h||!v||"replace"===t&&!c||"split"===t&&!f){var p=/./[d],_=n(a,d,""[t],function(t,e,n,i,o){return e.exec===l?h&&!o?{done:!0,value:p.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}}),m=_[0],g=_[1];i(String.prototype,t,m),o(RegExp.prototype,d,2==e?function(t,e){return g.call(t,this,e)}:function(t){return g.call(t,this)})}}},function(t,e,n){"use strict";var i=n(60);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var i=n(231),o=n(529),r=n(428),a=n(60),s=n(88),l=n(443),u={},c={},e=t.exports=function(t,e,n,f,d){var h,v,p,_,m=d?function(){return t}:l(t),g=i(n,f,e?2:1),y=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(r(m)){for(h=s(t.length);h>y;y++)if((_=e?g(a(v=t[y])[0],v[1]):g(t[y]))===u||_===c)return _}else for(p=m.call(t);!(v=p.next()).done;)if((_=o(p,g,v.value,e))===u||_===c)return _};e.BREAK=u,e.RETURN=c},function(t,e,n){var i=n(244);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(78)("iterator"),o=!1;try{var r=[7][i]();r.return=function(){o=!0},Array.from(r,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var r=[7],a=r[i]();a.next=function(){return{done:n=!0}},r[i]=function(){return a},t(r)}catch(t){}return n}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){"use strict";var i=n(320),o=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var r=n.call(t,e);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},function(t,e,n){var i=n(102),o=n(62),r=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(263)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){for(var i,o=n(62),r=n(215),a=n(270),s=a("typed_array"),l=a("view"),u=!(!o.ArrayBuffer||!o.DataView),c=u,f=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(i=o[d[f++]])?(r(i.prototype,s,!0),r(i.prototype,l,!0)):c=!1;t.exports={ABV:u,CONSTR:c,TYPED:s,VIEW:l}},function(t,e,n){var i=n(62),o=i.navigator;t.exports=o&&o.userAgent||""},function(t,e,n){!function(i,o){t.exports=e=o(n(50))}(0,function(t){return function(e){var n=t,i=n.lib,o=i.Base,r=i.WordArray,a=n.x64={};a.Word=o.extend({init:function(t,e){this.high=t,this.low=e}}),a.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,n=[],i=0;i<e;i++){var o=t[i];n.push(o.high),n.push(o.low)}return r.create(n,this.sigBytes)},clone:function(){for(var t=o.clone.call(this),e=t.words=this.words.slice(0),n=e.length,i=0;i<n;i++)e[i]=e[i].clone();return t}})}(),t})},,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.easableMixin=void 0;var i=n(28);e.easableMixin={_abortFn:null,_finishFn:null,_ease:function(t,e,n,o){var r=this;this._finishFn=e;var a=!1;this._abortFn=(0,i.timed)(function(e){t.call(this,o.easing(e)),1===e&&this._finishEase()},function(){a||(delete r._finishFn,n&&n.call(r),a=!0,delete r._abortFn)},!1===o.animate?0:o.duration,this)},_finishEase:function(){delete this._abortFn;var t=this._finishFn;delete this._finishFn,t&&t.call(this)},_stopEase:function(){this._abortFn&&(this._abortFn(),this._finishEase())}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(32),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=function(){function t(e,n){(0,s.default)(this,t),this.p0=e,this.p1=n}return(0,u.default)(t,[{key:"getXYCoefficient",value:function(){var t=(0,r.default)(this.p0.elements,3),e=t[0],n=t[1],i=t[2],o=(0,r.default)(this.p1.elements,3),a=o[0],s=o[1],l=o[2];return[(a-e)/(l-i),(e*l-a*i)/(l-i),(s-n)/(l-i),(n*l-s*i)/(l-i)]}}]),t}();e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(32),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(107),f=function(){function t(e,n){(0,s.default)(this,t),this.center=e,this.radius=n}return(0,u.default)(t,[{key:"intersectWithLine",value:function(t){var e=t.getXYCoefficient(),n=(0,r.default)(e,4),i=n[0],o=n[1],a=n[2],s=n[3],l=(0,r.default)(this.center.elements,3),u=l[0],f=l[1],d=l[2],h=this.radius,v=o-u,p=s-f,_=-d,m=i*i+a*a+1,g=2*(i*v+a*p+_),y=v*v+p*p+_*_-h*h,x=g*g-4*m*y;if(x<0)return[];var b=(-g+Math.sqrt(x))/(2*m),S=(-g-Math.sqrt(x))/(2*m),w=i*b+o,E=a*b+s,T=i*S+o,A=a*S+s;return[new c.Vector3(w,E,b),new c.Vector3(T,A,S)]}}]),t}();e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConfigUtil=e.INDOOR_ICON_SIZE=void 0;var i=n(23),o=function(t){return t&&t.__esModule?t:{default:t}}(i),r=0;e.INDOOR_ICON_SIZE=o.default.iconSize,e.ConfigUtil={setBV:function(t){r=t},getBV:function(){return r},getIconPath:function(){var t=Math.floor(3*Math.random());return o.default.indoorIconSrc.replace("%$%",0===t?1:t)},getIconSrc:function(t){return""+this.getIconPath()+t+".png?v="+this.getBV()}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return t[0]+(t[1]<<8)+(t[2]<<16)}function r(t,e){var n={};n.x=360*t/268435456-180;var i=180-360*e/268435456;n.y=Math.atan(Math.exp(.017453292519943295*i))/.008726646259971648-90;var o=new _.default(n.y,n.x);return o.x=n.x,o.y=n.y,o}function a(t){return(0,v.default)({},t)}function s(t,e){var n=(0,S.mercatorToLatLng)(new g.default(t,e));return n.x=t,n.y=e,n}function l(t,e){return(0,S.latLngToMercator)(new _.default(e,t))}function u(t){var e=t.map(function(t){return{lng:t.x,lat:t.y}});return(0,b.isClockWise)(e)}function c(t,e,n,i){var o=(0,y.getStyle)(t,e,i);if(!o)return!1;var r=(0,y.getStyle)(o.labelid,e,i);if(!r)return!1;if(o.icon_offset&&65535!==o.icon_offset||r.effect&&5===r.effect){var a=o.icon_offset;if(n&&"number"==typeof o.icon_offset&&isFinite(o.icon_offset)&&65535!==o.icon_offset&&-1!==o.icon_offset){if(r.fontSize>0)return!0}else if(r.fontSize>0)return!0;return!!("number"==typeof a&&isFinite(a)&&a>=0&&a<500)}return r.fontSize>0}function f(t,e,n,i){var o=c(t,e,n,i),r=!1,a=!1;if(!o)return{isValid:o,drawIcon:r,drawLabel:a};var s=(0,y.getStyle)(t,e,i),l=(0,y.getStyle)(s.labelid,e,i);if(s.icon_offset&&65535!==s.icon_offset||l.effect&&5===l.effect){var u=s.icon_offset;a=(n&&"number"==typeof s.icon_offset&&isFinite(s.icon_offset)&&65535!==s.icon_offset&&s.icon_offset,l.fontSize>0),r=!!("number"==typeof u&&isFinite(u)&&u>=0&&u<500)}else r=!1,a=l.fontSize>0;return{isValid:o,drawLabel:a,drawIcon:r}}function d(t,e,n,i){var o=(0,y.getStyle)(t.styleId,e,i);if(!o)return void console.warn("style is invalid!");var r=(0,y.getStyle)(o.labelid,e,i);if(!r)return void console.warn("labelStyle is invalid!");var a=t.drawInfo||f(t.styleId,e,t.direct,i),s=x.INDOOR_ICON_SIZE,l=x.INDOOR_ICON_SIZE,u=/\\/g,c=null,d=null,h=s/2,v=l/2,p=t.text.split(u);return p.map(function(e,i){var o={x:0,y:0},s={w:0,h:0},l={x:0,y:0},u={text:e,coords:[l.x,l.y],anchor:o,textBounds:s};if(!a.drawLabel)return u;switch(t.direct){case 2:c="right",d="middle";break;case 3:c="center",d="top";break;case 4:c="center",d="bottom";break;case 1:c="left",d="middle";break;default:c="center",d="middle"}var f=0;return n.font!==r.font&&(n.font=r.font),f=n.measureText(e).width,s.w=Math.ceil(f),s.h=t.fontSize,"left"===c&&a.drawIcon?(o.x=0+h+2+f/2,l.x=o.x):"right"===c&&a.drawIcon?(o.x=0-h-2-f/2,l.x=o.x):(o.x=0,l.x=0),"top"===d?(o.y=0+v+(r.fontSize+2)*(i+1)-r.fontSize/2,l.y=o.y):"bottom"===d?(o.y=0-v-(r.fontSize+2)*(p.length-i)+r.fontSize/2,l.y=o.y):a.drawIcon&&a.drawLabel?(o.y=0+(1===p.length?0:(r.fontSize/2+2)*(0===i?-1:1)),l.y=o.y):a.drawIcon?(o.y=0,l.y=0):a.drawLabel&&(1===p.length?(o.y=0,l.y=0):(o.y=0+(r.fontSize/2+2)*(0===i?-1:1),l.y=o.y)),u.coords=[l.x,l.y],u})}Object.defineProperty(e,"__esModule",{value:!0});var h=n(223),v=i(h);e.readUint24=o,e.pixels2LongLat=r,e.extendCopy=a,e.mercator2latLng=s,e.latLng2Mercator=l,e.isClockWise=u,e.isValidPointStyle=c,e.getPoiDrawInfo=f,e.getPoiRect=d;var p=n(47),_=i(p),m=n(74),g=i(m),y=n(332),x=n(379),b=n(298),S=n(112)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=null;e.default={setStyleTag:function(t){i=t},isDefaultNoSideLine:function(t){var e=i,n=e.lineTag,o=["street","path","secondaryroad"],r=o.some(function(e){return n[e]&&n[e].some(function(e){return e===Number(t)})});return Number(r)}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(257),p=i(v),_=n(41),m=i(_),g=n(29),y=m.default.isNumber,x=function(t){function e(t){return(0,s.default)(this,e),(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t))}return(0,h.default)(e,t),(0,u.default)(e,[{key:"_initialize",value:function(t){this._setTileSize(t.tileSize)}},{key:"_setTileSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;y(t)||(new g.BaseTypeError("TileLayer.tileSize","number",t).error(),t=256),this.tileSize=t}}]),e}(p.default);e.default=x},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(148),r=i(o),a=n(25),s=i(a),l=n(3),u=i(l),c=n(0),f=i(c),d=n(1),h=i(d),v=n(5),p=i(v),_=n(35),m=i(_),g=n(4),y=i(g),x=n(382),b=i(x),S=n(137),w=i(S),E=n(90),T=n(66),A=n(29),P=n(23),I=function(t){function e(t){return(0,f.default)(this,e),(0,p.default)(this,(e.__proto__||(0,u.default)(e)).call(this,t))}return(0,y.default)(e,t),(0,h.default)(e,[{key:"_initialize",value:function(t){(0,m.default)(e.prototype.__proto__||(0,u.default)(e.prototype),"_initialize",this).call(this,t),t.type&&("string"!=typeof t.type?new A.BaseTypeError("Layer.type","string",t.type).error():this.features=k[t.type]),this.features=this.features||t.features||[],this.maxDataZoom=t.maxDataZoom||P.maxDataZoom,this.vectorSrc=t.vectorSrc,this._checkSourceId()}},{key:"setMap",value:function(t){return(0,m.default)(e.prototype.__proto__||(0,u.default)(e.prototype),"setMap",this).call(this,t),t&&this._init(),this}},{key:"_init",value:function(){var t=this;this._createSource().then(function(){t.features.forEach(function(e){var n=new b.default({id:e.id||e.type+"_"+t.id,type:e.type,maxDataZoom:t.maxDataZoom,sourceId:t.layerSourceId,tileSize:256});n.filter=e.filter,t.appendChild(n)}),t._fire("layer",{})})}},{key:"_createSource",value:function(){var t=this,e=this._checkVectorSrc();return this.map.getSource(this.layerSourceId)?s.default.resolve():(this.map.addSource(this.layerSourceId,{tileSize:P.tileSize,minZoom:this.minZoom,maxZoom:this.maxZoom,minDataZoom:this.minDataZoom,maxDataZoom:this.maxDataZoom,type:E.SOURCE_TYPE.vector,data:{vectorSrc:e.vectorSrc||P.vectorSrc,batchVectorSrc:e.batchVectorSrc||P.batchVectorSrc},enc:!1}),this.map.layerResource.getStyleIdPromise().then(function(e){t.map.getSource(t.layerSourceId).setStyleId(e)},function(t){return console.warn("底图样式未能加载：",t),s.default.resolve()}))}},{key:"_checkSourceId",value:function(){if(this.layerSourceId)return void(this.layerSourceId=this.layerSourceId);var t=this.vectorSrc;return this.layerSourceMap=P.layerSourceMap||new r.default,P.layerSourceMap=this.layerSourceMap,Array.isArray(t)?void this._checkSourceIdUpdate(t.sort().toString()):"string"==typeof t?void this._checkSourceIdUpdate(t):void(this.layerSourceId=w.default.VECTOR_SOURCE_ID)}},{key:"_checkSourceIdUpdate",value:function(t){var e=this,n=!0;if(this.layerSourceMap.forEach(function(i,o){i===t&&(n=!1,e.layerSourceId=o)}),n){var i=w.default.VECTOR_SOURCE_ID+"_"+this.id;this.layerSourceMap.set(i,t),this.layerSourceId=i}}},{key:"_checkVectorSrc",value:function(){var t=this,e=this.vectorSrc,n={};return Array.isArray(e)&&e.forEach(function(e){n.vectorSrc=n.vectorSrc||[],n.batchVectorSrc=n.batchVectorSrc||[],n.vectorSrc.push(t._concatVectorSrc(e)),n.batchVectorSrc.push(t._concatVectorSrc(e))}),"string"==typeof e&&(n.vectorSrc=[this._concatVectorSrc(e,"vector")],n.batchVectorSrc=[this._concatVectorSrc(e,"batchvector")]),n}},{key:"_concatVectorSrc",value:function(t){return"batchvector"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"batchvector")?t+"?"+P.batchVectorSrc[0].split("?")[1]:t+"?"+P.vectorSrc[0].split("?")[1]}},{key:"_removeSource",value:function(){if(this.map){!this.map.findLayer(function(t){return t instanceof e})&&(this.map.removeSource(this.layerSourceId),P.layerSourceMap&&P.layerSourceMap.delete(this.layerSourceId),this.layerSourceMap=P.layerSourceMap)}}}]),e}(b.default);e.default=I;var k={base:[{type:T.BASE_LAYER_TYPE.base,filter:T.BASE_LAYER_TYPE.base},{type:T.BASE_LAYER_TYPE.ground,filter:T.BASE_LAYER_TYPE.ground}],arrow:[{type:T.BASE_LAYER_TYPE.arrow,filter:T.BASE_LAYER_TYPE.arrow}],building2d:[{type:T.BASE_LAYER_TYPE.building2d,filter:T.BASE_LAYER_TYPE.building3d}],building3d:[{type:T.BASE_LAYER_TYPE.building3d,filter:T.BASE_LAYER_TYPE.building3d}],point:[{type:T.BASE_LAYER_TYPE.point,filter:T.BASE_LAYER_TYPE.point},{type:T.BASE_LAYER_TYPE.text,filter:T.BASE_LAYER_TYPE.text}],label:[{type:T.BASE_LAYER_TYPE.label,filter:T.BASE_LAYER_TYPE.label},{type:T.BASE_LAYER_TYPE.text,filter:T.BASE_LAYER_TYPE.text}]}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=i(o),a=n(1),s=i(a),l=n(10),u=i(l),c=function(){function t(e,n){(0,r.default)(this,t),this.max=e,this.onRemove=n,this.reset()}return(0,s.default)(t,[{key:"reset",value:function(){var t=this;return u.default.forIn(this.data,function(e,n){t.onRemove(n)}),this.data={},this.order=[],this}},{key:"add",value:function(t,e){if(this.has(t))this.order.splice(this.order.indexOf(t),1),this.data[t]=e,this.order.push(t);else if(this.data[t]=e,this.order.push(t),this.order.length>this.max){var n=this.get(this.order[0]);n&&this.onRemove(n)}return this}},{key:"has",value:function(t){return t in this.data}},{key:"keys",value:function(){return this.order}},{key:"get",value:function(t){if(!this.has(t))return null;var e=this.data[t];return delete this.data[t],this.order.splice(this.order.indexOf(t),1),e}},{key:"getWithoutRemoving",value:function(t){return this.has(t)?this.data[t]:null}},{key:"remove",value:function(t){if(!this.has(t))return this;var e=this.data[t];return delete this.data[t],this.onRemove(e),this.order.splice(this.order.indexOf(t),1),this}},{key:"setMaxSize",value:function(t){for(this.max=t;this.order.length>this.max;){var e=this.get(this.order[0]);e&&this.onRemove(e)}return this}}]),t}();e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=y.default.QMAPI_style+t;return a(e).then(function(n){var i=n.version,o=n.cacheJson;return u({styleId:t,version:i,serviceSrc:P.styleSrc,qosId:"st"}).then(function(n){if(n?l(e,n):n=o,!n)throw Error("未知错误：获取样式文件失败。");return(0,m.setBgColor)(t,n.data),n.data})}).catch(function(t){console.error(t)})}function r(t){var e=y.default.QMAPI_style_indoor+t;return a(e).then(function(n){var i=n.version,o=n.cacheJson;return u({styleId:t,version:i,serviceSrc:P.indoorStyleSrc,qosId:"in_st"}).then(function(t){return t?(l(e,t),t.data):o?o.data:null},function(t){return t&&console.error(t.status+": "+t.message),null})})}function a(t){return new _.default(function(e){A.support()?A.get(t,function(t){var n=JSON.parse(t)||null,i=n?n.version:-1;e({version:i,cacheJson:n})}):(console.error("兼容性错误：当前浏览器不支持LocalStorage。"),e({version:-1}))})}function s(t,e){return new _.default(function(n){if(A.support()){(0,m.setBgColor)(e,t);var i=y.default.QMAPI_style+"config";A.set(i,(0,v.default)({data:t}),function(){n(!0)})}else console.error("兼容性错误：当前浏览器不支持LocalStorage。"),n(!1)})}function l(t,e){A.support()&&A.set(t,(0,v.default)(e))}function u(t){var e=t.styleId,n=t.version,i=void 0===n?-1:n,o=t.serviceSrc,r=void 0===o?P.styleSrc:o,a=t.qosId,s=void 0===a?"st":a,l=d(r,{id:e,version:i});return new _.default(function(t,n){T.getJSON(null,l,function(o,r,a){"in_st"===s?c({err:o,result:r,time:a,resolve:t,reject:n,styleId:e,version:i}):f({err:o,result:r,time:a,resolve:t,reject:n,styleId:e,version:i})})})}function c(t){var e=t.err,n=t.result,i=t.time,o=t.resolve,r=t.reject,a=t.styleId,s=t.version;if(!e&&n&&n.data){var l=!0;for(var u in n.data)if(n.data.hasOwnProperty(u)){l=!1;break}l?o(null):((0,x.qos)("in_st",{styleId:a,version:s,loadTime:i}),o(n))}else(0,x.qos)("in_st",{styleId:a,version:s,error:e&&e.status||0}),r(e||"未知错误：获取样式文件失败。")}function f(t){var e=t.err,n=t.result,i=t.time,o=t.resolve,r=t.reject,a=t.styleId,s=t.version;if(e||!n)(0,x.qos)("st",{styleId:a,version:s,error:e&&e.status||0}),r(e||"未知错误：获取样式文件失败。");else{if(n&&n.data&&E.default.isLocal)return void o(n);if(n&&0===n.isup)o(null);else{var l=n&&n.url;if(!l)return void r("未返回cdn地址，获取样式失败。");T.getJSON(null,l,function(t,n,l){t||!n?((0,x.qos)("st",{styleId:a,version:s,error:e&&e.status||0}),r(e||"未知错误：获取样式文件失败。")):((0,x.qos)("st",{styleId:a,version:s,loadTime:i+l}),o(n))})}}}function d(t,e){var n=t;return S.default.forIn(e,function(t,e){n=n.replace("{"+t+"}",e)}),n}Object.defineProperty(e,"__esModule",{value:!0});var h=n(113),v=i(h),p=n(25),_=i(p);e.loadStyleFile=o,e.loadIndoorStyleFile=r,e.setStyleConfig=s,e.loadStyleFileFromServer=u;var m=n(496),g=n(137),y=i(g),x=n(43),b=n(10),S=i(b),w=n(105),E=i(w),T=n(79),A=n(89),P=n(23)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.styleNameConfig={regionTag:{airportsarea:[196832],building:[196619,197120,197121,197122,197123],commercial:[196890],grass:[196614,196615,196616,196833],hospital:[196774],land:[196609,196612,196613,196617],otherarea:[196775,196831,196856,196857,196858,196859,196860,196861,196862,196863,196864,196865,196866,196867,196868,196869,196877,196894,196895,196934],park:[196622],parkinglots:[196629,196787],resident:[196621,196627,196630,196632],school:[196773],sportsfield:[196626,196789,196790,196791,196792,196793,196794,196795,196796,196798],subwayarea:[196634,196635,196636,196637,196638,196639,196640,196641,196642,196643,196644,196645,196646,196647,196648,196649,196684,196685,196686,196687,196688,196689,196690,196651,196652,196653,196654,196655,196656,196657,196658,196659,196660,196691,196692,196693,196694,196695,196696,196697,196698,196661,196662,196663,196664,196665,196666,196667,196668,196669,196670,196671,196672,196673,196674,196675,196676,196677,196678,196679,196680,196681,196682,196683,196699,196700,196701,196702,196703,196704,196705,196706,196707,196708,196709,196710,196711,196712,196713,196714,196715,196716,196717,196718,196719,196720,196721,196722,196723,196724,196725,196726,196727,196728,196729,196730,196731,196732,196733,196734,196735,196736,196737,196738,196739,196650,196740,196741,196742,196743,196744,196745,196746,196747,196748,196749,196750,196753,196754,196755,196756,196757,196758,196759,196760,196761,196762,196763,196764,196765,196766,196767,196768,196769,196770,196771,196772,196776,196777,196778,196779,196780,196781,196782,196783,196784,196785,196786,196799,196800,196801,196802,196803,196815,196816,196817,196818,196819,196820,196821,196822,196823,196824,196825,196826,196827,196828,196829,196830,196834,196835,196836,196837,196838,196839,196840,196841,196842,196843,196844,196845,196846,196847,196848,196849,196850,196851,196852,196853,196854,196855,196870,196871,196872,196874,196875,196876,196881,196878,196879,196880,196882,196883,196884,196885,196886,196887,196888,196889,196891,196892,196893,196896,196897,196898,196899,196900,196901,196902,196903,196904,196905,196906,196907,196908,196909,196910,196911,196912,196913,196914,196915,196916,196917,196918,196919,196920,196921,196922,196923,196924,196925,196926,196927,196928,196929,196930,196931,196932,196933,196935,196936,196938,196939,196940,196941,196942,196944,196945,196946,196947],water:[196610,196611,196618]},labelTag:{aoi:[262149,262150,262404,262405,262406,262482,262483,262484,262153,262952],autoservice:[262864],bridge:[262154,262953,262946,262947,262948,262949,262950],building:[262145,262409,262487,262708,262713,262494,262506,262954],business:[262493,262515],city:[262157,262158,262159,262160],commercial:[262942],continent:[262395,262426],country:[262402,262865],district:[262155],education:[262453,262488],entertainment:[262486],ferry:[262162,262801],government:[262869],highway:[262166,262418,262425,262792,262799,262812,262813],highwaynum:[262164,262165,262169,262170,262783,262784],hospital:[262407],hotel:[262452],island:[262146],lifeservice:[262866,262867,262868],mainroad:[262178,262179,262185,262186,262415,262416,262419,262420,262790,262791,262797,262798,262802,262803,262810,262811],motorway:[262173,262417,262424,262793,262800],nationalnum:[262163,262168,262785],ocean:[262147,262396,262707],other:[262151,262496,262497,262498,262499,262500,262501,262502,262503,262504,262505,262507,262508,262509,262510,262511,262512,262514],path:[262903],province:[262533],railway:[262908,263057],restrant:[262450,262495],roadnum:[262167,262176,262786],scenic:[262288,262489,262870,262941],secondaryroad:[262180,262181,262187,262188,262413,262414,262421,262422,262788,262789,262795,262796,262804,262805,262808,262809],shopping:[262451,262945],street:[262182,262189,262412,262423,262787,262794,262806,262807],subwaygate:[262454,262455,262456,262457,262458,262459,262460,262461,262462,262463,262464,262465,262466,262467,262468,262469,262470,262471,262472,262473,262474,262475,262476,262477,262478,262479,262480,262481,262492,262485,262691,262696,262750,262818,262841,262842,262853,262921,262922,262927,262940,263016],subwayline:[262544,262545,262546,262547,262548,262549,262550,262551,262552,262553,262554,262555,262556,262557,262558,262559,262560,262561,262564,262565,262566,262567,262568,262569,262570,262571,262572,262573,262574,262575,262576,262577,262578,262579,262580,262581,262582,262583,262584,262585,262586,262587,262588,262589,262590,262591,262592,262593,262594,262595,262596,262597,262598,262599,262600,262601,262602,262603,262604,262605,262606,262607,262608,262609,262610,262611,262612,262613,262614,262615,262616,262617,262618,262619,262620,262621,262622,262623,262624,262625,262626,262627,262628,262629,262630,262631,262632,262633,262634,262635,262636,262637,262638,262639,262640,262641,262642,262643,262644,262645,262646,262647,262648,262649,262650,262651,262652,262653,262654,262655,262656,262657,262658,262659,262660,262661,262662,262663,262664,262665,262666,262667,262668,262669,262670,262671,262672,262673,262674,262675,262676,262677,262678,262679,262680,262681,262682,262684,262686,262688,262690,262693,262695,262698,262700,262702,262704,262706,262710,262712,262715,262717,262719,262721,262723,262725,262727,262729,262731,262733,262735,262737,262739,262741,262743,262745,262747,262749,262752,262762,262767,262768,262769,262770,262771,262772,262773,262774,262775,262776,262777,262778,262779,262780,262781,262782,262815,262817,262820,262822,262824,262826,262828,262830,262832,262834,262836,262838,262840,262844,262846,262848,262850,262852,262855,262857,262859,262861,262863,262905,262907,262910,262909,262912,262914,262916,262918,262920,262924,262926,262929,262931,262933,262935,262937,262939,262944,262973,262975,262977,262979,262981,262983,262985,262987,262989,262991,262993,262995,262997,262999,263001,263003,263005,263007,263009,263011,263013,263015,263018,263020,263022,263024,263026,263028,263030,263032,263034,263036,263038,263040,263042,263044,263046,263048,263050,263052,263054,263056,263061,263063,263065,263067,263069,263073,263075,263077,263079],subwaystation:[262287],town:[262156],transport:[262410,262871],village:[262152]},lineTag:{ferry:[131115],guojie:[131073,131074,131075],highway:[131082,131088,131335,131337,131090,131396,131406],mainroad:[131084,131085,131105,131106,131107,131333,131342,131108,131109,131110,131111,131334,131344,131112,131398,131399,131408,131409],motorway:[131083,131089,131329,131338,131091,131397,131407],path:[131336,131483,131484,131405,131453,131454,131455,131456,131457,131506],pfurniture:[131352,131353,131354,131355,131511,131512],railway:[131086,131087,131489],secondaryroad:[131208,131097,131098,131099,131331,131340,131100,131101,131102,131103,131332,131341,131104,131400,131401,131410,131411,131507],shengjie:[131078,131079,131080,131486],street:[131092,131093,131094,131330,131339,131095,131096,131345,131412,131505],subwayline:[131117,131118,131119,131120,131121,131122,131123,131124,131125,131126,131127,131128,131129,131130,131131,131132,131133,131134,131135,131136,131137,131138,131139,131140,131141,131142,131143,131144,131145,131146,131147,131148,131149,131150,131151,131152,131153,131154,131155,131156,131157,131158,131159,131160,131161,131162,131163,131164,131165,131166,131167,131168,131169,131170,131171,131172,131173,131174,131175,131176,131177,131178,131179,131180,131181,131182,131183,131184,131185,131186,131187,131188,131189,131190,131191,131192,131193,131194,131195,131196,131197,131198,131199,131200,131201,131202,131203,131204,131205,131206,131207,131209,131210,131211,131212,131213,131214,131215,131216,131217,131218,131219,131220,131221,131222,131223,131224,131225,131226,131227,131228,131229,131230,131231,131232,131233,131234,131235,131236,131237,131238,131239,131240,131241,131242,131243,131244,131245,131246,131247,131248,131249,131250,131251,131252,131253,131254,131255,131256,131257,131258,131259,131260,131261,131262,131263,131264,131265,131266,131267,131268,131269,131270,131271,131272,131273,131274,131275,131276,131277,131278,131279,131280,131281,131282,131283,131284,131285,131286,131287,131288,131289,131290,131291,131292,131293,131294,131295,131296,131297,131298,131299,131300,131301,131302,131303,131304,131305,131306,131307,131308,131309,131310,131311,131312,131313,131314,131315,131316,131317,131318,131319,131320,131321,131322,131323,131324,131325,131326,131327,131346,131347,131348,131349,131350,131351,131356,131357,131358,131359,131360,131361,131362,131363,131364,131365,131366,131367,131368,131369,131370,131371,131384,131385,131386,131387,131388,131389,131390,131391,131392,131393,131394,131395,131402,131403,131404,131413,131414,131415,131416,131417,131437,131438,131439,131440,131441,131442,131443,131444,131445,131446,131447,131448,131449,131450,131451,131452,131458,131459,131460,131461,131462,131463,131464,131465,131466,131467,131468,131469,131470,131471,131472,131473,131474,131475,131476,131477,131478,131479,131480,131481,131482,131487,131488,131491,131492,131493,131494,131495,131496,131497,131498,131499,131500,131501,131502,131503,131504,131508,131509,131510,131513,131514,131515,131516,131517,131518,131519,131520,131521,131522,131523,131524,131525,131526,131527,131528,131529,131530,131531,131532,131533,131534,131535,131536,131537,131538,131539,131540,131541,131542,131543,131544,131545,131546,131547,131548,131549,131550,131551,131552,131554,131555,131556,131557,131558,131560,131561,131562,131563],water:[131081]},pointTag:{aoi:[65546,65550,65686,65687,65688,65755,65756,65757,65554,66202,66618],autoservice:[65606,66173,66174,66175,66176,66177],bridge:[65547,66612,66613,66614,66615,66616,66617],building:[65568,65574,65577,65587,65592,65594,65600,65602,65603,65604,65608,65619,65620,65621,65622,65623,65624,65625,65626,65627,65628,65629,65630,65632,65703,66092,66098,66099,66100,66101,66102,66103,66096,66105,66106,66107,66108,66109,66110,66111,66112,66113,66114,66115,66116,66120,66132,66133,66134,66135,66136,66137,66138,66139,66140,66141,66142,66178,66179,66180,66181,66183,66184,66186,66187,66189,66190,66191,66192,66193,66194,66224,66414,66415,66416,66417,66418,66419,66420,66421,66422,66423,66424,66425,66426,66427,66428,66429,66430,66431,66432,66433,66434,66435,66634,66684,66685,66686,66850],business:[65578,65618,66582],carpark:[65607,66526,66527],city:[65543,65555,65557,65558,65559,65693],commercial:[65758],continent:[65537],country:[65541,65556],district:[65542],education:[65562,65571,65583,65584,65701,65702,65741,65742,66227,66849],entertainment:[65569,65593,65613,65743,66199,66200,66226],government:[65579],hospital:[65581,65598,65705,66852],hotel:[65582,65733,65734,65735,66123,66124,66125,66126,66127,66128,66163,66164,66165,66166,66167,66168,66169,66170,66171,66172,66188,66222,66490,66541],island:[65539],lifeservice:[65586,65596,65597,65599,65617,65738,65739,65740,66118,66119,66129,66182,66185,66221],ocean:[65538,65540,65549],other:[65553,65616,65631,65700,65706,65707,65708,65709,66196,66564,66565,66577],province:[66572],restrant:[65591,65595,65601,65729,65730,65731,65732,65704,66223,66851],scenic:[65552,65563,65564,65565,65566,65567,65573,65585,65744,66198,66201,66491,66492,66493,66494,66495,66496,66497,66498,66499,66500,66501,66502,66503,66504,66505,66506,66507,66508,66509,66510,66511,66512,66513,66514,66515,66516,66517,66518,66519,66520,66521,66522,66523,66524,66525,66528,66529,66530,66531,66532,66533,66534,66535,66536,66537,66538,66539,66540,66542,66543,66544,66545,66546,66547,66548,66549,66550,66551,66552,66553,66554,66555,66556,66557,66558,66559,66560,66561,66562,66563],shopping:[65588,65589,65736,65737,66619],subwaygate:[65836,65837,65838,65839,65840,65841,65842,65843,65844,65845,65745,65846,65847,65848,65849,65850,65851,65852,65853,65854,65855,65856,65857,65858,65859,65860,65861,65862,65863,65864,65894,66080,66086,66160,66233,66398,66402,66413,66590,66594,66600,66610,66679,66682,66775,66844],subwayline:[65936,65937,65938,65939,65940,65941,65942,65943,65944,65945,65946,65947,65948,65949,65950,65951,65952,65953,65954,65955,65956,65957,65958,65959,65960,65961,65962,65963,65964,65965,65966,65967,65968,65969,65970,65971,65972,65973,65974,65975,65976,65978,65979,65980,65981,65982,65983,65984,65985,65986,65987,65988,65989,65990,65991,65992,65993,65994,65995,65996,65997,65998,65999,66e3,66001,66002,66003,66004,66005,66006,66007,66008,66009,66010,66011,66012,66013,66014,66015,66016,66017,66018,66019,66020,66021,66022,66023,66024,66025,66026,66027,66028,66029,66030,66031,66032,66033,66034,66035,66036,66037,66038,66039,66040,66041,66042,66043,66044,66045,66046,66047,66048,66049,66050,66051,66052,66053,66054,66055,66056,66057,66058,66059,66060,66061,66062,66063,66064,66065,66066,66067,66068,66069,66070,66071,66072,66073,66074,66075,66076,66081,66082,66087,66088,66089,66090,66091,66097,66104,66117,66130,66131,66143,66144,66145,66146,66147,66148,66149,66150,66151,66152,66153,66154,66155,66156,66161,66162,66195,66203,66206,66207,66208,66209,66210,66211,66212,66213,66214,66215,66216,66217,66218,66219,66220,66228,66229,66234,66377,66378,66380,66382,66385,66387,66389,66390,66391,66392,66403,66404,66405,66406,66409,66486,66487,66566,66568,66569,66573,66574,66579,66581,66583,66584,66585,66586,66595,66596,66601,66602,66603,66604,66605,66606,66611,66638,66639,66640,66641,66642,66643,66644,66645,66646,66647,66648,66649,66650,66651,66652,66653,66654,66655,66656,66657,66658,66659,66660,66661,66662,66663,66664,66665,66666,66667,66668,66669,66670,66671,66672,66673,66674,66675,66676,66683,66687,66688,66834,66835,66836,66837,66838,66840,66841,66845,66848],subwaystation:[65635,65637,65639,65641,65643,65645,65647,65649,65651,65653,65654,65655,65657,65659,65661,65663,65665,65667,65669,65673,65675,65677,65681,65683,65684,65689,65691,65694,65696,65698,65710,66077,66083,66157,66204,66205,66230,66375,66235,66236,66237,66238,66239,66240,66241,66242,66243,66244,66245,66246,66247,66248,66249,66250,66251,66252,66253,66254,66255,66256,66257,66258,66259,66260,66261,66262,66263,66264,66265,66266,66267,66268,66269,66270,66271,66272,66273,66274,66275,66276,66277,66278,66279,66280,66281,66282,66283,66284,66285,66286,66287,66288,66289,66290,66291,66292,66293,66294,66295,66296,66297,66298,66299,66300,66301,66302,66303,66304,66305,66306,66307,66308,66309,66310,66311,66312,66313,66314,66315,66316,66317,66318,66319,66320,66321,66322,66323,66324,66325,66326,66327,66328,66329,66330,66331,66332,66333,66334,66335,66336,66337,66338,66339,66340,66342,66343,66344,66345,66346,66347,66348,66349,66350,66351,66352,66353,66354,66355,66356,66357,66358,66359,66360,66361,66362,66363,66364,66365,66366,66367,66368,66369,66370,66371,66372,66373,66374,66376,66379,66381,66383,66384,66386,66388,66393,66394,66395,66399,66407,66408,66410,66411,66488,66489,66567,66570,66571,66575,66576,66580,66587,66588,66591,66592,66597,66598,66607,66608,66677,66678,66680,66681,66773,66774,66842,66843],town:[65544],transport:[65560,65570,65572,65576,65605,65609,65610,65611,65614,65615,66093,66094,66095,66121,66122,66225],village:[65545,65551,65580,66578]}}},function(t,e,n){"use strict";function i(t,e){var n=(0,r.default)(t.getLat()),i=(0,r.default)(e.getLat());return 2*Math.asin(Math.sqrt(Math.pow(Math.sin((n-i)/2),2)+Math.cos(n)*Math.cos(i)*Math.pow(Math.sin(((0,r.default)(t.getLng())-(0,r.default)(e.getLng()))/2),2)))}Object.defineProperty(e,"__esModule",{value:!0});var o=n(124),r=function(t){return t&&t.__esModule?t:{default:t}}(o);e.default=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){return(0,a.default)(t,e)*(n||l.default)}Object.defineProperty(e,"__esModule",{value:!0});var r=n(387),a=i(r),s=n(295),l=i(s);e.default=o},,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(106),p=i(v),_=n(337),m=i(_),g=n(28),y=n(43),x=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this));return n.onInit(t),n.dom=n.createDOM(),n.map=null,n.setMap(t.map),(0,y.statCn)("DOMOverlay"),n}return(0,h.default)(e,t),(0,u.default)(e,[{key:"_addToMap",value:function(){this.map&&(this.map._overlayer.childs.domOverlayLayer.appendChild(this.dom),this.updateDOM(),this._listener=(0,g.throttleWithFrame)(this.updateDOM.bind(this)),this.map.on("move",this._listener),this.map.on("resize",this._listener),this.map.on("offset_changed",this._listener),this._onMapdestroy=this._onMapdestroy.bind(this),this.map.on("destroy",this._onMapdestroy))}},{key:"_onMapdestroy",value:function(){this.setMap(null)}},{key:"_removeFromMap",value:function(){this.map&&(this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.map.off("move",this._listener),this.map.off("resize",this._listener),this.map.off("offset_changed",this._listener),this.map.off("destroy",this._onMapdestroy),this._listener=null)}},{key:"getMap",value:function(){return this.map}},{key:"setMap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.map===t?this:!t||t instanceof m.default?(this._removeFromMap(),this.map=t,this._addToMap(),this):(console.error("类型错误: map参数类型错误，应为TMap.Map。"),this)}},{key:"destroy",value:function(){return this.onDestroy(),this.setMap(null),this.removeAllListeners(),this}},{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"createDOM",value:function(){return document.createElement("div")}},{key:"updateDOM",value:function(){}}]),e}(p.default);e.default=x},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=i(o),a=n(74),s=i(a),l=n(10),u={color:"rgba(0, 0, 0, 1)",backgroundColor:"rgba(0, 0, 0, 0)",borderColor:"rgba(0, 0, 0, 0)",strokeColor:"rgba(0, 0, 0, 0)",borderWidth:0,size:14,scale:1,borderRadius:0,offset:new s.default(0,0),angle:0,alignment:"center",verticalAlignment:"middle"},c=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.default)(this,t),e=(0,l.extend)({},u,e),this.color=e.color,this.backgroundColor=e.backgroundColor,this.borderColor=e.borderColor,this.borderWidth=e.borderWidth,this.strokeColor=e.strokeColor,this.size=e.size,this.width=e.width,this.height=e.height,this.padding=e.padding,this.borderRadius=e.borderRadius,this.scale=e.scale,this.offset=e.offset,this.angle=e.angle,this.alignment=e.alignment,this.verticalAlignment=e.verticalAlignment};e.default=c},function(t,e,n){"use strict";function i(){r.removeEventListener("DOMContentLoaded",i,!1),o.fireReady()}var o=[],r=document;o.isReady=!1,o._used=!1,o.ready=function(t){o.initReady(),o.isReady?t():o.push(t)},o.initReady=function(){if(!o._used){if(o._used=!0,"complete"===r.readyState||"interactive"===r.readyState)return o.fireReady();r.addEventListener("DOMContentLoaded",i,!1)}},o.fireReady=function(){if(!o.isReady){if(!r.body)return setTimeout(o.fireReady,16);if(o.isReady=!0,o.length)for(var t,e=0;t=o[e];e++)t()}},e.domReady=o.ready},function(t,e,n){"use strict";function i(t,e){if(!t.unprojectFromContainer(e))return!1;var n=!0,i=t.renderEngine.camera.getFogEdge()[1]+.15;if(i<1){var o=(1-i)*t.transform.height/2;e.y<o&&(n=!1)}return n}Object.defineProperty(e,"__esModule",{value:!0}),e.isResponsible=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(35),h=i(d),v=n(4),p=i(v),_=n(211),m=i(_),g=n(110),y=n(139),x=n(112),b=n(219),S=n(10),w=i(S),E=function(t){function e(t){(0,s.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t));return n.store=new g.Store("buffer",128,16,b.deleteInstanceCacllback),n.commonUniformList=["uMatrix","uCenter","uZoom","uPixelsPerMeter","uResolution","uProject_uCommonUnitsPerWorldUnit","uProject_uCommonUnitsPerWorldUnit2","uRelativeCenter"],n}return(0,p.default)(e,t),(0,u.default)(e,[{key:"draw",value:function(t,e,n,i){if(t&&n){var o=this.gl;o.useProgram(o.program),this.setUniforms(t,e,n,i);var r=this.setBuffers(t);o.drawElements(o.TRIANGLES,r.index.length,r.index.type,0),o.bindBuffer(o.ARRAY_BUFFER,null),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,null)}}},{key:"setBuffers",value:function(t){var e=this.gl,n=this.store,i=t.uid,o=!1;if(n){n.exist(i)?this.isBufferChanged(n.get(i),t)&&(o=!0):n.set(i,this.createBuffer(t));var r=n.get(i);return w.default.forIn(r,function(n,i){var r=i.buffer,a=i.location,s=i.size,l=i.type;r.bind(),o&&(r.bufferData(t[n],{usage:e.DYNAMIC_DRAW}),i.data=t[n]),"index"!==n&&r.pointToAttrib({location:a,size:s,type:l})}),r}}},{key:"setUniforms",value:function(t,e,n,i){var o=this.gl,r=e.center,a=e.zoom,s=1/(0,x.getSpatialResolution)(a),l=i.distanceScales||e.getDistanceScales(),u=(0,y.splitLatLngNumber)(r.lat),c=(0,y.splitLatLngNumber)(r.lng),f={latPart:(0,y.splitLatLngNumber)(t.center.lat),lngPart:(0,y.splitLatLngNumber)(t.center.lng)};o.uniformMatrix4fv(this.uMatrix,!1,n.elements),o.uniform4f(this.uCenter,c.high,u.high,c.low,u.low),o.uniform1f(this.uZoom,a),o.uniform3f(this.uPixelsPerMeter,s,s,s),o.uniform3f(this.uProject_uCommonUnitsPerWorldUnit,l.pixelsPerDegree[0],l.pixelsPerDegree[1],l.pixelsPerDegree[2]),o.uniform3f(this.uProject_uCommonUnitsPerWorldUnit2,l.pixelsPerDegree2[0],l.pixelsPerDegree2[1],l.pixelsPerDegree2[2]),o.uniform2f(this.uResolution,e.width,e.height),o.uniform4f(this.uRelativeCenter,f.lngPart.high,f.latPart.high,f.lngPart.low,f.latPart.low)}},{key:"destroy",value:function(){this.commonUniformList=null,(0,h.default)(e.prototype.__proto__||(0,r.default)(e.prototype),"destroy",this).call(this)}}]),e}(m.default);e.default=E},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(16),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(513),f=i(c),d=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,-1,1,0,1]),h=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,s.default)(this,t);var i=n.id,o=void 0===i?"pass":i;this.id=o,this.gl=e,this.props={},(0,r.default)(this.props,n)}return(0,u.default)(t,[{key:"setProps",value:function(t){(0,r.default)(this.props,t)}},{key:"render",value:function(t){var e=t.inputBuffer,n=t.outputBuffer,i=t.preserve,o=void 0!==i&&i,r=t.colorIndex,a=void 0===r?0:r,s=this.gl;n?n.bind(s):s.frameBuffer&&s.frameBuffer.unbind(),o||s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._renderPass({inputBuffer:e,colorIndex:a})}},{key:"destroy",value:function(){this._onDestroy(),this._painter&&this._painter.destroy(),this.id=null,this.gl=null,this.props=null}},{key:"_onDestroy",value:function(){}},{key:"_renderPass",value:function(t){var e=t.inputBuffer,n=this.gl;this._painter||(this._painter=new f.default({gl:n})),e.color.bind(n),this._painter.preDraw(),this._painter.draw({matrix:{elements:d},size:{width:2,height:2},texInfo:{s:0,t:0,w:1,h:1},opacity:1})}}]),t}();e.default=h},function(t,e,n){"use strict";function i(t){return Math.pow(2,Math.ceil((0,r.default)(t)))}Object.defineProperty(e,"__esModule",{value:!0});var o=n(306),r=function(t){return t&&t.__esModule?t:{default:t}}(o);e.getPowerOf2=i,e.default={extendCanvasToPow2:function(t,e){function n(t){if(t<2)return!1;var e=(0,r.default)(t);return e===~~e}return e=e||1,t&&t.isPow2&&1===e?t:n(t.width)&&n(t.height)&&1===e?(t.isPow2=!0,t):function(t,e){var n=document.createElement("canvas"),o=n.getContext("2d");return n.width=i(t.width*e),n.height=i(t.height*e),o.drawImage(t,0,0,n.width,n.height),n.isPow2=!0,n}(t,e)}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(0),r=i(o),a=n(1),s=i(a),l=n(475),u=i(l),c=n(247).default,f=n(74),d=n(47),h=n(10),v=c[0],p=function(){function t(){(0,r.default)(this,t),this.a=new f(128,128),this.b=256/360,this.c=256/(2*Math.PI),this.d=!0}return(0,s.default)(t,[{key:"fromLatLngToPoint",value:function(t){var e=new f(0,0),n=this.a;e.x=n.x+t.lng*this.b;var i=h.clamp(Math.sin(h.degreeToRadian(t.lat)),-(1-1e-15),1-1e-15);return e.y=n.y+.5*Math.log((1+i)/(1-i))*-this.c,e.z=t.height*this.c/v*Math.cos(h.degreeToRadian(t.lat)),e}},{key:"fromPointToLatLng",value:function(t){var e=this.a,n=h.radianToDegree(2*Math.atan(Math.exp((t.y-e.y)/-this.c))-Math.PI/2),i=(t.x-e.x)/this.b,o=(t.z||0)*v*Math.cos(h.degreeToRadian(n))/this.c;return new d(n,i,o,!0)}},{key:"latLngToCoord",value:function(t,e){var n=this.fromLatLngToPoint(t);if(n){var i=e,o=Math.pow(2,i);n.x=n.x*o,n.y=n.y*o,n.z=n.z*o}return n}},{key:"coordToLatLng",value:function(t,e){var n=e,i=Math.pow(2,n),o=new u.default(t.x/i,t.y/i,(t.z||0)/i);return this.fromPointToLatLng(o)}}]),t}();t.exports=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.HEX_REG=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,e.RGB_REG=/^rgb\((\d+,?\s*){3}\)$/,e.RGBA_REG=/^rgba\((\d+,?\s*){3},\s*[0-9.]+\)$/},function(t,e,n){"use strict";function i(t,e,n){return t*(1-n)+e*n}function o(t,e){t=a.default.wrap(t,0,360);var n=Math.abs(t,e);return Math.abs(t-360-e)<n&&(t-=360),Math.abs(t+360-e)<n&&(t+=360),t}Object.defineProperty(e,"__esModule",{value:!0});var r=n(10),a=function(t){return t&&t.__esModule?t:{default:t}}(r);i.number=i,i.vec2=function(t,e,n){return[i(t[0],e[0],n),i(t[1],e[1],n)]},i.color=function(t,e,n){return[i(t[0],e[0],n),i(t[1],e[1],n),i(t[2],e[2],n),i(t[3],e[3],n)]},i.array=function(t,e,n){return t.map(function(t,o){return i(t,e[o],n)})},i.latlng=function(t,e,n){return[i(t.getLat(),e.getLat(),n),i(t.getLng(),e.getLng(),n)]},i.rotation=function(t,e,n){return e=o(e,t),i(t,e,n)},e.default=i},function(t,e,n){"use strict";function i(t){return r(o(a(t)))}function o(t){return l(u(s(t),8*t.length))}function r(t){for(var e,n=m?"0123456789ABCDEF":"0123456789abcdef",i="",o=0;o<t.length;o++)e=t.charCodeAt(o),i+=n.charAt(e>>>4&15)+n.charAt(15&e);return i}function a(t){for(var e,n,i="",o=-1;++o<t.length;)e=t.charCodeAt(o),n=o+1<t.length?t.charCodeAt(o+1):0,55296<=e&&e<=56319&&56320<=n&&n<=57343&&(e=65536+((1023&e)<<10)+(1023&n),o++),e<=127?i+=String.fromCharCode(e):e<=2047?i+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?i+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(i+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return i}function s(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(var n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e}function l(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e}function u(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var n=1732584193,i=-271733879,o=-1732584194,r=271733878,a=0;a<t.length;a+=16){var s=n,l=i,u=o,c=r;n=f(n,i,o,r,t[a+0],7,-680876936),r=f(r,n,i,o,t[a+1],12,-389564586),o=f(o,r,n,i,t[a+2],17,606105819),i=f(i,o,r,n,t[a+3],22,-1044525330),n=f(n,i,o,r,t[a+4],7,-176418897),r=f(r,n,i,o,t[a+5],12,1200080426),o=f(o,r,n,i,t[a+6],17,-1473231341),i=f(i,o,r,n,t[a+7],22,-45705983),n=f(n,i,o,r,t[a+8],7,1770035416),r=f(r,n,i,o,t[a+9],12,-1958414417),o=f(o,r,n,i,t[a+10],17,-42063),i=f(i,o,r,n,t[a+11],22,-1990404162),n=f(n,i,o,r,t[a+12],7,1804603682),r=f(r,n,i,o,t[a+13],12,-40341101),o=f(o,r,n,i,t[a+14],17,-1502002290),i=f(i,o,r,n,t[a+15],22,1236535329),n=d(n,i,o,r,t[a+1],5,-165796510),r=d(r,n,i,o,t[a+6],9,-1069501632),o=d(o,r,n,i,t[a+11],14,643717713),i=d(i,o,r,n,t[a+0],20,-373897302),n=d(n,i,o,r,t[a+5],5,-701558691),r=d(r,n,i,o,t[a+10],9,38016083),o=d(o,r,n,i,t[a+15],14,-660478335),i=d(i,o,r,n,t[a+4],20,-405537848),n=d(n,i,o,r,t[a+9],5,568446438),r=d(r,n,i,o,t[a+14],9,-1019803690),o=d(o,r,n,i,t[a+3],14,-187363961),i=d(i,o,r,n,t[a+8],20,1163531501),n=d(n,i,o,r,t[a+13],5,-1444681467),r=d(r,n,i,o,t[a+2],9,-51403784),o=d(o,r,n,i,t[a+7],14,1735328473),i=d(i,o,r,n,t[a+12],20,-1926607734),n=h(n,i,o,r,t[a+5],4,-378558),r=h(r,n,i,o,t[a+8],11,-2022574463),o=h(o,r,n,i,t[a+11],16,1839030562),i=h(i,o,r,n,t[a+14],23,-35309556),n=h(n,i,o,r,t[a+1],4,-1530992060),r=h(r,n,i,o,t[a+4],11,1272893353),o=h(o,r,n,i,t[a+7],16,-155497632),i=h(i,o,r,n,t[a+10],23,-1094730640),n=h(n,i,o,r,t[a+13],4,681279174),r=h(r,n,i,o,t[a+0],11,-358537222),o=h(o,r,n,i,t[a+3],16,-722521979),i=h(i,o,r,n,t[a+6],23,76029189),n=h(n,i,o,r,t[a+9],4,-640364487),r=h(r,n,i,o,t[a+12],11,-421815835),o=h(o,r,n,i,t[a+15],16,530742520),i=h(i,o,r,n,t[a+2],23,-995338651),n=v(n,i,o,r,t[a+0],6,-198630844),r=v(r,n,i,o,t[a+7],10,1126891415),o=v(o,r,n,i,t[a+14],15,-1416354905),i=v(i,o,r,n,t[a+5],21,-57434055),n=v(n,i,o,r,t[a+12],6,1700485571),r=v(r,n,i,o,t[a+3],10,-1894986606),o=v(o,r,n,i,t[a+10],15,-1051523),i=v(i,o,r,n,t[a+1],21,-2054922799),n=v(n,i,o,r,t[a+8],6,1873313359),r=v(r,n,i,o,t[a+15],10,-30611744),o=v(o,r,n,i,t[a+6],15,-1560198380),i=v(i,o,r,n,t[a+13],21,1309151649),n=v(n,i,o,r,t[a+4],6,-145523070),r=v(r,n,i,o,t[a+11],10,-1120210379),o=v(o,r,n,i,t[a+2],15,718787259),i=v(i,o,r,n,t[a+9],21,-343485551),n=p(n,s),i=p(i,l),o=p(o,u),r=p(r,c)}return Array(n,i,o,r)}function c(t,e,n,i,o,r){return p(_(p(p(e,t),p(i,r)),o),n)}function f(t,e,n,i,o,r,a){return c(e&n|~e&i,t,e,o,r,a)}function d(t,e,n,i,o,r,a){return c(e&i|n&~i,t,e,o,r,a)}function h(t,e,n,i,o,r,a){return c(e^n^i,t,e,o,r,a)}function v(t,e,n,i,o,r,a){return c(n^(e|~i),t,e,o,r,a)}function p(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function _(t,e){return t<<e|t>>>32-e}Object.defineProperty(e,"__esModule",{value:!0});var m=0;e.default=i},function(t,e,n){t.exports={default:n(410),__esModule:!0}},function(t,e,n){var i=function(){return this}()||Function("return this")(),o=i.regeneratorRuntime&&Object.getOwnPropertyNames(i).indexOf("regeneratorRuntime")>=0,r=o&&i.regeneratorRuntime;if(i.regeneratorRuntime=void 0,t.exports=n(403),o)i.regeneratorRuntime=r;else try{delete i.regeneratorRuntime}catch(t){i.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";function n(t,e,n,i){var r=e&&e.prototype instanceof o?e:o,a=Object.create(r.prototype),s=new h(i||[]);return a._invoke=u(t,n,s),a}function i(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function o(){}function r(){}function a(){}function s(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function l(t){function e(n,o,r,a){var s=i(t[n],t,o);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&g.call(u,"__await")?Promise.resolve(u.__await).then(function(t){e("next",t,r,a)},function(t){e("throw",t,r,a)}):Promise.resolve(u).then(function(t){l.value=t,r(l)},a)}a(s.arg)}function n(t,n){function i(){return new Promise(function(i,o){e(t,n,i,o)})}return o=o?o.then(i,i):i()}var o;this._invoke=n}function u(t,e,n){var o=T;return function(r,a){if(o===P)throw new Error("Generator is already running");if(o===I){if("throw"===r)throw a;return p()}for(n.method=r,n.arg=a;;){var s=n.delegate;if(s){var l=c(s,n);if(l){if(l===k)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===T)throw o=I,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=P;var u=i(t,e,n);if("normal"===u.type){if(o=n.done?I:A,u.arg===k)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=I,n.method="throw",n.arg=u.arg)}}}function c(t,e){var n=t.iterator[e.method];if(n===_){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=_,c(t,e),"throw"===e.method))return k;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return k}var o=i(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,k;var r=o.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=_),e.delegate=null,k):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,k)}function f(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function d(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function h(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(f,this),this.reset(!0)}function v(t){if(t){var e=t[x];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(g.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=_,e.done=!0,e};return i.next=i}}return{next:p}}function p(){return{value:_,done:!0}}var _,m=Object.prototype,g=m.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},x=y.iterator||"@@iterator",b=y.asyncIterator||"@@asyncIterator",S=y.toStringTag||"@@toStringTag",w="object"==typeof t,E=e.regeneratorRuntime;if(E)return void(w&&(t.exports=E));E=e.regeneratorRuntime=w?t.exports:{},E.wrap=n;var T="suspendedStart",A="suspendedYield",P="executing",I="completed",k={},L={};L[x]=function(){return this};var M=Object.getPrototypeOf,C=M&&M(M(v([])));C&&C!==m&&g.call(C,x)&&(L=C);var R=a.prototype=o.prototype=Object.create(L);r.prototype=R.constructor=a,a.constructor=r,a[S]=r.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===r||"GeneratorFunction"===(e.displayName||e.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,S in t||(t[S]="GeneratorFunction")),t.prototype=Object.create(R),t},E.awrap=function(t){return{__await:t}},s(l.prototype),l.prototype[b]=function(){return this},E.AsyncIterator=l,E.async=function(t,e,i,o){var r=new l(n(t,e,i,o));return E.isGeneratorFunction(e)?r:r.next().then(function(t){return t.done?t.value:r.next()})},s(R),R[S]="Generator",R[x]=function(){return this},R.toString=function(){return"[object Generator]"},E.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},E.values=v,h.prototype={constructor:h,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=_,this.done=!1,this.delegate=null,this.method="next",this.arg=_,this.tryEntries.forEach(d),!t)for(var e in this)"t"===e.charAt(0)&&g.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=_)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,i){return r.type="throw",r.arg=t,n.next=e,i&&(n.method="next",n.arg=_),!!i}if(this.done)throw t;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],r=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var a=g.call(o,"catchLoc"),s=g.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&g.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=t,r.arg=e,o?(this.method="next",this.next=o.finallyLoc,k):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),k},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),d(n),k}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var o=i.arg;d(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:v(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=_),k}}}(function(){return this}()||Function("return this")())},,,,,,function(t,e,n){var i=n(2),o=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return o.stringify.apply(o,arguments)}},function(t,e,n){n(414),t.exports=n(2).Math.fround},function(t,e,n){n(415),t.exports=n(2).Number.isFinite},function(t,e,n){n(73),n(33),n(39),n(416),n(419),n(418),n(417),t.exports=n(2).Set},function(t,e,n){var i=n(313),o=Math.pow,r=o(2,-52),a=o(2,-23),s=o(2,127)*(2-a),l=o(2,-126),u=function(t){return t+1/r-1/r};t.exports=Math.fround||function(t){var e,n,o=Math.abs(t),c=i(t);return o<l?c*u(o/l/a)*l*a:(e=(1+a/r)*o,n=e-(e-o),n>s||n!=n?c*(1/0):c*n)}},function(t,e,n){var i=n(6);i(i.S,"Math",{fround:n(413)})},function(t,e,n){var i=n(6),o=n(8).isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&o(t)}})},function(t,e,n){"use strict";var i=n(260),o=n(183);t.exports=n(250)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return i.def(o(this,"Set"),t=0===t?0:t,t)}},i)},function(t,e,n){n(251)("Set")},function(t,e,n){n(252)("Set")},function(t,e,n){var i=n(6);i(i.P+i.R,"Set",{toJSON:n(261)("Set")})},function(t,e,n){"use strict";var i=n(436)(!0);t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},function(t,e,n){"use strict";var i=n(136),o=n(269),r=n(88);t.exports=function(t){for(var e=i(this),n=r(e.length),a=arguments.length,s=o(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:o(l,n);u>s;)e[s++]=t;return e}},function(t,e,n){"use strict";var i=n(104),o=n(268);t.exports=function(t,e,n){e in t?i.f(t,e,o(0,n)):t[e]=n}},function(t,e,n){var i=n(63),o=n(62).document,r=i(o)&&i(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var i=n(78)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var i=n(62).document;t.exports=i&&i.documentElement},function(t,e,n){var i=n(63),o=n(434).set;t.exports=function(t,e,n){var r,a=e.constructor;return a!==n&&"function"==typeof a&&(r=a.prototype)!==n.prototype&&i(r)&&o&&o(t,r),t}},function(t,e,n){var i=n(285),o=n(78)("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||r[o]===t)}},function(t,e,n){var i=n(63),o=n(244),r=n(78)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==o(t))}},function(t,e,n){"use strict";var i=n(263),o=n(11),r=n(206),a=n(215),s=n(285),l=n(530),u=n(288),c=n(266),f=n(78)("iterator"),d=!([].keys&&"next"in[].keys()),h=function(){return this};t.exports=function(t,e,n,v,p,_,m){l(n,e,v);var g,y,x,b=function(t){if(!d&&t in T)return T[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},S=e+" Iterator",w="values"==p,E=!1,T=t.prototype,A=T[f]||T["@@iterator"]||p&&T[p],P=A||b(p),I=p?w?b("entries"):P:void 0,k="Array"==e?T.entries||A:A;if(k&&(x=c(k.call(new t)))!==Object.prototype&&x.next&&(u(x,S,!0),i||"function"==typeof x[f]||a(x,f,h)),w&&A&&"values"!==A.name&&(E=!0,P=function(){return A.call(this)}),i&&!m||!d&&!E&&T[f]||a(T,f,P),s[e]=P,s[S]=h,p)if(g={values:w?P:b("values"),keys:_?P:b("keys"),entries:I},m)for(y in g)y in T||r(T,y,g[y]);else o(o.P+o.F*(d||E),e,g);return g}},function(t,e){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e,n){"use strict";var i=n(347),o=RegExp.prototype.exec,r=String.prototype.replace,a=o,s=function(){var t=/a/,e=/b*/g;return o.call(t,"a"),o.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),l=void 0!==/()??/.exec("")[1];(s||l)&&(a=function(t){var e,n,a,u,c=this;return l&&(n=new RegExp("^"+c.source+"$(?!\\s)",i.call(c))),s&&(e=c.lastIndex),a=o.call(c,t),s&&a&&(c.lastIndex=c.global?a.index+a[0].length:e),l&&a&&a.length>1&&r.call(a[0],n,function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(a[u]=void 0)}),a}),t.exports=a},function(t,e,n){var i=n(63),o=n(60),r=function(t,e){if(o(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n(231)(Function.call,n(232).f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return r(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:r}},function(t,e,n){var i=n(353)("keys"),o=n(270);t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,e,n){var i=n(234),o=n(245);t.exports=function(t){return function(e,n){var r,a,s=String(o(e)),l=i(n),u=s.length;return l<0||l>=u?t?"":void 0:(r=s.charCodeAt(l),r<55296||r>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):r:t?s.slice(l,l+2):a-56320+(r-55296<<10)+65536)}}},function(t,e,n){var i=n(429),o=n(245);t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(o(t))}},function(t,e,n){"use strict";var i=n(234),o=n(245);t.exports=function(t){var e=String(o(this)),n="",r=i(t);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var i,o,r,a=n(231),s=n(527),l=n(426),u=n(423),c=n(62),f=c.process,d=c.setImmediate,h=c.clearImmediate,v=c.MessageChannel,p=c.Dispatch,_=0,m={},g=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},y=function(t){g.call(t.data)};d&&h||(d=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return m[++_]=function(){s("function"==typeof t?t:Function(t),e)},i(_),_},h=function(t){delete m[t]},"process"==n(244)(f)?i=function(t){f.nextTick(a(g,t,1))}:p&&p.now?i=function(t){p.now(a(g,t,1))}:v?(o=new v,r=o.port2,o.port1.onmessage=y,i=a(r.postMessage,r,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(t){c.postMessage(t+"","*")},c.addEventListener("message",y,!1)):i="onreadystatechange"in u("script")?function(t){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),g.call(t)}}:function(t){setTimeout(a(g,t,1),0)}),t.exports={set:d,clear:h}},function(t,e,n){"use strict";function i(t,e,n){var i,o,r,a=new Array(n),s=8*n-e-1,l=(1<<s)-1,u=l>>1,c=23===e?z(2,-24)-z(2,-77):0,f=0,d=t<0||0===t&&1/t<0?1:0;for(t=D(t),t!=t||t===N?(o=t!=t?1:0,i=l):(i=F(V(t)/Y),t*(r=z(2,-i))<1&&(i--,r*=2),t+=i+u>=1?c/r:c*z(2,1-u),t*r>=2&&(i++,r/=2),i+u>=l?(o=0,i=l):i+u>=1?(o=(t*r-1)*z(2,e),i+=u):(o=t*z(2,u-1)*z(2,e),i=0));e>=8;a[f++]=255&o,o/=256,e-=8);for(i=i<<e|o,s+=e;s>0;a[f++]=255&i,i/=256,s-=8);return a[--f]|=128*d,a}function o(t,e,n){var i,o=8*n-e-1,r=(1<<o)-1,a=r>>1,s=o-7,l=n-1,u=t[l--],c=127&u;for(u>>=7;s>0;c=256*c+t[l],l--,s-=8);for(i=c&(1<<-s)-1,c>>=-s,s+=e;s>0;i=256*i+t[l],l--,s-=8);if(0===c)c=1-a;else{if(c===r)return i?NaN:u?-N:N;i+=z(2,e),c-=a}return(u?-1:1)*i*z(2,c-e)}function r(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function a(t){return[255&t]}function s(t){return[255&t,t>>8&255]}function l(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function u(t){return i(t,52,8)}function c(t){return i(t,23,4)}function f(t,e,n){A(t[k],e,{get:function(){return this[n]}})}function d(t,e,n,i){var o=+n,r=E(o);if(r+e>t[j])throw B(L);var a=t[U]._b,s=r+t[G],l=a.slice(s,s+e);return i?l:l.reverse()}function h(t,e,n,i,o,r){var a=+n,s=E(a);if(s+e>t[j])throw B(L);for(var l=t[U]._b,u=s+t[G],c=i(+o),f=0;f<e;f++)l[u+f]=c[r?f:e-f-1]}var v=n(62),p=n(103),_=n(263),m=n(354),g=n(215),y=n(286),x=n(61),b=n(284),S=n(234),w=n(88),E=n(545),T=n(265).f,A=n(104).f,P=n(421),I=n(288),k="prototype",L="Wrong index!",M=v.ArrayBuffer,C=v.DataView,R=v.Math,B=v.RangeError,N=v.Infinity,O=M,D=R.abs,z=R.pow,F=R.floor,V=R.log,Y=R.LN2,U=p?"_b":"buffer",j=p?"_l":"byteLength",G=p?"_o":"byteOffset";if(m.ABV){if(!x(function(){M(1)})||!x(function(){new M(-1)})||x(function(){return new M,new M(1.5),new M(NaN),"ArrayBuffer"!=M.name})){M=function(t){return b(this,M),new O(E(t))};for(var Z,H=M[k]=O[k],W=T(O),X=0;W.length>X;)(Z=W[X++])in M||g(M,Z,O[Z]);_||(H.constructor=M)}var Q=new C(new M(2)),q=C[k].setInt8;Q.setInt8(0,2147483648),Q.setInt8(1,2147483649),!Q.getInt8(0)&&Q.getInt8(1)||y(C[k],{setInt8:function(t,e){q.call(this,t,e<<24>>24)},setUint8:function(t,e){q.call(this,t,e<<24>>24)}},!0)}else M=function(t){b(this,M,"ArrayBuffer");var e=E(t);this._b=P.call(new Array(e),0),this[j]=e},C=function(t,e,n){b(this,C,"DataView"),b(t,M,"DataView");var i=t[j],o=S(e);if(o<0||o>i)throw B("Wrong offset!");if(n=void 0===n?i-o:w(n),o+n>i)throw B("Wrong length!");this[U]=t,this[G]=o,this[j]=n},p&&(f(M,"byteLength","_l"),f(C,"buffer","_b"),f(C,"byteLength","_l"),f(C,"byteOffset","_o")),y(C[k],{getInt8:function(t){return d(this,1,t)[0]<<24>>24},getUint8:function(t){return d(this,1,t)[0]},getInt16:function(t){var e=d(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=d(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return r(d(this,4,t,arguments[1]))},getUint32:function(t){return r(d(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return o(d(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return o(d(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){h(this,1,t,a,e)},setUint8:function(t,e){h(this,1,t,a,e)},setInt16:function(t,e){h(this,2,t,s,e,arguments[2])},setUint16:function(t,e){h(this,2,t,s,e,arguments[2])},setInt32:function(t,e){h(this,4,t,l,e,arguments[2])},setUint32:function(t,e){h(this,4,t,l,e,arguments[2])},setFloat32:function(t,e){h(this,4,t,c,e,arguments[2])},setFloat64:function(t,e){h(this,8,t,u,e,arguments[2])}});I(M,"ArrayBuffer"),I(C,"DataView"),g(C[k],m.VIEW,!0),e.ArrayBuffer=M,e.DataView=C},function(t,e,n){e.f=n(78)},function(t,e,n){var i=n(320),o=n(78)("iterator"),r=n(285);t.exports=n(102).getIteratorMethod=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||r[i(t)]}},function(t,e,n){"use strict";var i=n(262),o=n(531),r=n(285),a=n(216);t.exports=n(430)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,o(1)):"keys"==e?o(0,n):"values"==e?o(0,t[n]):o(0,[n,t[n]])},"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},function(t,e,n){!function(i,o){t.exports=e=o(n(50))}(0,function(t){!function(){var e=t,n=e.lib,i=n.Base,o=e.enc,r=o.Utf8,a=e.algo;a.HMAC=i.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=r.parse(e));var n=t.blockSize,i=4*n;e.sigBytes>i&&(e=t.finalize(e)),e.clamp();for(var o=this._oKey=e.clone(),a=this._iKey=e.clone(),s=o.words,l=a.words,u=0;u<n;u++)s[u]^=1549556828,l[u]^=909522486;o.sigBytes=a.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(n))}})}()})},function(t,e,n){!function(i,o){t.exports=e=o(n(50))}(0,function(t){return function(){var e=t,n=e.lib,i=n.WordArray,o=n.Hasher,r=e.algo,a=[],s=r.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],o=n[1],r=n[2],s=n[3],l=n[4],u=0;u<80;u++){if(u<16)a[u]=0|t[e+u];else{var c=a[u-3]^a[u-8]^a[u-14]^a[u-16];a[u]=c<<1|c>>>31}var f=(i<<5|i>>>27)+l+a[u];f+=u<20?1518500249+(o&r|~o&s):u<40?1859775393+(o^r^s):u<60?(o&r|o&s|r&s)-1894007588:(o^r^s)-899497514,l=s,s=r,r=o<<30|o>>>2,o=i,i=f}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+r|0,n[3]=n[3]+s|0,n[4]=n[4]+l|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA1=o._createHelper(s),e.HmacSHA1=o._createHmacHelper(s)}(),t.SHA1})},,,,,function(t,e,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},,,,,,,,,,,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(t&&e)return e.y-t.y<=x&&e.x-t.x<=x}var r=n(27),a=i(r),s=n(0),l=i(s),u=n(1),c=i(u),f=n(742),d=i(f),h=n(210),v=n(74),p=n(106),_=n(28),m=n(10),g=m.forIn,y={scrollZoom:n(744),touchZoomRotate:n(746),touchTilt:n(745),doubleClickZoom:n(739),dragRotate:n(741),dragPan:n(740),longPress:n(743)},x=10,b=function(){function t(e,n){(0,l.default)(this,t),e.handler||(this.members=[e],this.map=e,this.eventHandlers=[],this.eventHandlers.push(_.on(window,"resize",this.onWindowResize.bind(this))),this.el=e.getContainer(),this.rl=e.getRenderContainer(),this.transform=e.transform,this.controlManager=e.controlManager,this.idleHandler=new d.default(this.transform),this.contextMenuEvent=null,this.mouseDown=!1,this.startPos=null,this.startTouchPoints=null,this.tapped=null,g(y,function(t,i){e[t]=new i(e,n),n&&n.disInteractive||e[t].enable()}),this.eventHandlers.push(_.on(this.controlManager,{control_added:function(t){e._fire("control_added",t,!0)},control_removed:function(t){e._fire("control_removed",t,!0)}})),this.eventHandlers.push(_.on(this.idleHandler,"idle",function(){e._fire("idle",null,!0)})),this.eventHandlers.push(_.on(e.canvasContainer,{webglcontextlost:e._onContextError.bind(e,"lost"),webglcontaxtrestored:e._onContextError.bind(e,"restored")})),this.eventHandlers.push(_.on(this.el,{mouseout:this.onMouseOut.bind(this),mousedown:this.onMouseDown.bind(this),mouseup:this.onMouseUp.bind(this),mousemove:this.onMouseMove.bind(this),touchstart:this.onTouchStart.bind(this),touchend:this.onTouchEnd.bind(this),touchmove:this.onTouchMove.bind(this),touchcancel:this.onTouchCancel.bind(this),click:this.onClick.bind(this),dblclick:this.onDblClick.bind(this),contextmenu:this.onContextMenu.bind(this)})))}return(0,c.default)(t,[{key:"destroy",value:function(){var t=this;g(y,function(e){t.map[e]&&(t.map[e].disable(),delete t.map[e])}),this.eventHandlers.forEach(function(t){t&&t.remove&&t.remove()}),this.members=null,this.map=null,this.eventHandlers=[],this.el=null,this.rl=null,this.transform=null,this.idleHandler=null,this.contextMenuEvent=null,this.mouseDown=!1,this.startPos=null,this.tapped=null}},{key:"onWindowResize",value:function(){var t=this.rl.clientWidth,e=this.rl.clientHeight;this.map.resize(t,e)}},{key:"onMouseOut",value:function(t){this.fireMouseEvent("mouseout",t)}},{key:"onMouseDown",value:function(t){this.map.stopMoving(),this.startPos=h.mousePos(this.el,t),this.fireMouseEvent("mousedown",t),this.mouseDown=!0}},{key:"onMouseUp",value:function(t){if(this.contextMenuEvent&&!this.rotating&&this.fireMouseEvent("contextmenu",this.contextMenuEvent),this.contextMenuEvent=null,this.mouseDown=!1,this.fireMouseEvent("mouseup",t),t&&2===t.button){var e=h.mousePos(this.el,t);this.startPos&&e.equals(this.startPos)&&this.fireMouseEvent("rightclick",t)}}},{key:"onMouseMove",value:function(t){if(!(this.map.dragPan&&this.map.dragPan.isActive()||this.map.dragRotate&&this.map.dragRotate.isActive())){for(var e=t.toElement||t.target;e&&e!==this.el;)e=e.parentNode;e===this.el&&this.fireMouseEvent("mousemove",t)}}},{key:"onTouchStart",value:function(t){if(t.preventDefault(),this.map.stopMoving(),this.fireTouchEvent("touchstart",t),t.touches&&!(t.touches.length>1)){var e=this.startTouchPoints;if(this.startTouchPoints=h.touchPos(this.el,t),this.tapped){clearTimeout(this.tapped),this.tapped=null;var n=e&&e[0],i=this.startTouchPoints&&this.startTouchPoints[0];n&&i&&(this.maybeDoubleTap=o(n,i)),this.tapped=setTimeout(this.onTouchTimeout.bind(this),300)}else this.tapped=setTimeout(this.onTouchTimeout.bind(this),300)}}},{key:"onTouchMove",value:function(t){this.fireTouchEvent("touchmove",t);var e=this.startTouchPoints[0],n=h.touchPos(this.el,t)[0];this.maybeDoubleTap&&e&&n&&(this.maybeDoubleTap=o(e,n))}},{key:"onTouchEnd",value:function(t){var e=this;this.fireTouchEvent("touchend",t),setTimeout(function(){if(e.tapped){var n=e.startTouchPoints[0],i=h.touchPos(e.el,t)[0];if(n&&i){var r=o(n,i);r&&e.fireTouchEvent("click",t),r&&e.maybeDoubleTap&&setTimeout(function(){e.fireTouchEvent("dblclick",t),e.maybeDoubleTap=!1},50)}}},50)}},{key:"onTouchCancel",value:function(t){this.maybeDoubleTap=!1,this.fireTouchEvent("touchcancel",t)}},{key:"onTouchTimeout",value:function(){this.maybeDoubleTap=!1,this.tapped=null}},{key:"onClick",value:function(t){var e=h.mousePos(this.el,t);this.startPos&&e.dist(this.startPos)<x&&this.fireMouseEvent("click",t)}},{key:"onDblClick",value:function(t){this.fireMouseEvent("dblclick",t),t.preventDefault()}},{key:"onContextMenu",value:function(t){var e=this.map.dragRotate&&this.map.dragRotate.isActive();this.mouseDown||e?this.mouseDown&&(this.contextMenuEvent=t):this.fireMouseEvent("contextmenu",t),t.preventDefault()}},{key:"fireMouseEvent",value:function(t,e){var n=h.mousePos(this.el,e),i={latLng:this.map.unprojectFromContainer(n),point:n,originalEvent:e};"click"===t&&(i.poi=this.map._getPoiInfo(n));var o=!0,r=!1,s=void 0;try{for(var l,u=(0,a.default)(this.members);!(o=(l=u.next()).done);o=!0){l.value._fire(t,i)}}catch(t){r=!0,s=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw s}}}},{key:"fireTouchEvent",value:function(t,e){var n=this,i=h.touchPos(this.el,e),o=i.reduce(function(t,e,n,i){return t.add(e.div(i.length))},new v(0,0)),r={latLng:this.map.unprojectFromContainer(o),point:o,latLngs:i.map(function(t){return n.map.unprojectFromContainer(t)},this),points:i,originalEvent:e};"click"===t&&(r.poi=this.map._getPoiInfo(i[0]));var s=!0,l=!1,u=void 0;try{for(var c,f=(0,a.default)(this.members);!(s=(c=f.next()).done);s=!0){c.value._fire(t,r)}}catch(t){l=!0,u=t}finally{try{!s&&f.return&&f.return()}finally{if(l)throw u}}}},{key:"registe",value:function(t){if(!(t instanceof p))throw new Error("illegal event type!");var e=!0,n=!1,i=void 0;try{for(var o,r=(0,a.default)(this.members);!(e=(o=r.next()).done);e=!0){if(o.value===t)return}}catch(t){n=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(n)throw i}}this.members.push(t)}},{key:"cancel",value:function(t){if(!(t instanceof p))throw new Error("illegal event type!");for(var e=this.members,n=e.length-1;n>-1;n--)e[n]===t&&e.splice(n,1)}}]),t}();t.exports=b},function(t,e,n){"use strict";n(801),n(803),n(802),n(809),n(808),n(811),n(810),n(812),n(805),n(806),n(804),n(807),n(982),n(1025)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.imageVertex="\nprecision mediump float;\n\nattribute vec2 a_position;\n\nuniform mat4 u_matrix;\nuniform vec2 u_size;\nuniform vec4 u_texInfo;\nvarying vec2 v_texCoord;\n\nvoid main() {\n\t\n\tv_texCoord = vec2(u_texInfo[0] + a_position.x * u_texInfo[2], u_texInfo[1] + a_position.y * u_texInfo[3]);\n\t\n\tvec2 position = vec2(a_position.x * u_size.x, (a_position.y - 1.0) * u_size.y);\n\n\tgl_Position = u_matrix * vec4(position, 0.0, 1.0);\n}\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.INSTANCE_PARTS="\nattribute vec2 positions;\n        \nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute vec2 instanceSizes;\nattribute vec4 instanceInfos;\n\n\nattribute vec3 instancePickingColors;\nattribute vec4 instanceFrames;\nattribute vec3 instancePixelOffset;\n",e.UNIFORM_PARTS="\nuniform float u_sizeScale;\nuniform float u_sizeMinPixels;\nuniform float u_sizeMaxPixels;\nuniform vec2 u_textureDim;\nuniform float u_opacity;\nuniform float u_mapScale;\n\n",e.generateMainPart=function(t,e){return"\n    \n    vec2 imageSize = instanceFrames.zw;\n            \n    vec2 sizePixels = clamp(instanceSizes * u_sizeScale, vec2(u_sizeMinPixels), vec2(u_sizeMaxPixels));\n    \n    "+t+"\n\n    vec3 latlngPoint = instancePositions;\n     float delta  = latlngPoint.x - uCenter.x;\n\n\n\n\n\n\n     latlngPoint.x = mix( mix(latlngPoint.x,latlngPoint.x + 360.0,step(delta,-180.)), latlngPoint.x - 360.0, step(180., delta));\n     \n    if (bool(instanceInfos.w))  {\n        vec4 center_proj = uMatrix * vec4(project_view_local_position_precision(latlngPoint, instancePositions64xyLow.xy), 1.0);\n        vec2 center_screen = proj_position_to_screen(center_proj);\n        vec2 corner_screen = center_screen + pixelOffset * u_mapScale;\n    \n        gl_Position = screen_to_proj_position(corner_screen, center_proj.z, center_proj.w);\n    } else {\n        gl_Position = uMatrix * vec4(project_view_local_position_precision(latlngPoint.xy, instancePositions64xyLow.xy) + pixelOffset, 0.0, 1.0);\n    }\n    \n    vTextureCoords = mix(\n        instanceFrames.xy,\n        instanceFrames.xy + imageSize,\n        (positions.xy + 1.0) / 2.0\n    ) / u_textureDim;\n    \n    vTextureCoords.y = 1.0 - vTextureCoords.y;\n    \n\n    "+e+"\n    vColor = picking_getFinalColor(vColor, instancePickingColors);\n    vOpacity = instancePixelOffset.z;\n    "}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(217),o=n(292),r=n(276);e.default={v:"\n\t\t#define SHADER_NAME polygon-vertex-shader\n\n\t\tattribute vec2 vertexPositions;\n\t\t\n\t\tattribute float vertexValid;\n\t\tattribute vec3 positions;\n\t\tattribute vec2 positions64xyLow;\n\t\tattribute vec3 nextPositions;\n\t\tattribute vec2 nextPositions64xyLow;\n\t\tattribute float elevations;\n\t\tattribute vec4 fillColors;\n\t\tattribute vec4 lineColors;\n\t\tattribute vec3 pickingColors;\n\n\t\t"+i.UNIFORM_PART+"\n        \n\t\t"+o.PICK_UNIFORM+"\n\t\t\n\t\t"+r.LIGHT_UNIFORM+"\n\t\t\n\t\tuniform bool u_isSideVertex;\n\t\tuniform bool u_extruded;\n\t\tuniform bool u_isWireframe;\n\t\tuniform float u_elevationScale;\n\t\tuniform float u_opacity;\n\t\t\n\t\tvarying vec4 vColor;\n\t\tvarying float isValid;\n\n\t\t"+r.LIGHT_VARYING+"\n\n\t\t"+i.PROJECTION_PART+"\n        \n\t\t"+o.PICK_FUNCTION+"\n\t\t\n\t\t"+r.LIGHT_VERTEX+"\n\t\t"+r.LIGHT_FRAG+"\n\t\t\n\t\tvoid main(void) {\n\t\t\tvec3 pos;\n\t\t\tvec2 pos64xyLow;\n\t\t\tvec3 normal;\n\t\t\tvec4 colors = mix(fillColors, lineColors, float(u_isWireframe));\n\n\t\t\tfloat isSideVertex = float(u_isSideVertex);\n\t\t\tfloat extruded = float(u_extruded);\n\n\t\t\tpos = mix(\n\t\t\t\tpositions,\n\t\t\t\t\n\t\t\t\tmix(positions, nextPositions, vertexPositions.x),\n\t\t\t\tisSideVertex\n\t\t\t);\n\t\t\tpos64xyLow = mix(\n\t\t\t\tpositions64xyLow,\n\t\t\t\tmix(positions64xyLow, nextPositions64xyLow, vertexPositions.x),\n\t\t\t\tisSideVertex\n\t\t\t);\n\t\t\tisValid = mix(1.0, vertexValid, isSideVertex);\n\t\t\tpos.z += mix(\n\t\t\t\t0.0,\n\t\t\t\tabs(elevations) * mix(1.0, vertexPositions.y, isSideVertex),\n\t\t\t\textruded\n\t\t\t) * u_elevationScale;\n\t\t\t\n\t\t\t\n\t\t\tpos.z = mix(pos.z, mix(pos.z - abs(elevations), pos.z, float(elevations >= 0.0)), extruded);\n\t\t\t\n\t\t\tvec3 local_position = project_view_local_position_precision(pos.xyz, pos64xyLow.xy);\n\t\t\tvec3 current_local_position = project_view_local_position_precision(positions.xyz, positions64xyLow.xy);\n\t\t\tvec3 next_local_position = project_view_local_position_precision(nextPositions.xyz, nextPositions64xyLow.xy);\n\n\t\t\tgl_Position = uMatrix * vec4(local_position, 1.0);\n\t\t\t\n\t\t\tnormal = mix(\n\t\t\t\tvec3(0., 0., 1.),\n\t\t\t\tmix(\n\t\t\t\t\tvec3(0.0, 0.0, 1.0),\n\t\t\t\t\tnormalize(\n\t\t\t\t\t\tcross(\n\t\t\t\t\t\t\tnormalize(vec3(next_local_position.xy - current_local_position.xy, 0.0)),\n\t\t\t\t\t\t\tvec3(0.0, 0.0, 1.0)\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\t\tfloat(u_isSideVertex && !u_isWireframe)\n\t\t\t\t),\n\t\t\t\textruded\n\t\t\t);\n\n\t\t\tlighting_apply_on_vertex(local_position.xyz, normal, mat4(1.0));\n\t\t\tvec4 color = vec4(colors.rgb, colors.a * u_opacity) / 255.0;\n\t\t\tvec4 lightingColor = mix(\n\t\t\t\tcolor,\n\t\t\t\tlighting_apply_on_color(color),\n\t\t\t\t\n\t\t\t\textruded\n\t\t\t);\n\t\t\tvColor = picking_getFinalColor(lightingColor, pickingColors);\n\t\t}\n\t",f:"\n\t\t#define SHADER_NAME polygon-fragment-shader\n\n\t\tprecision highp float;\n\t\t\n\t\tvarying vec4 vColor;\n\t\tvarying float isValid;\n\t\t\n\t\tvoid main(void) {\n\t\t\tif (isValid < 0.5) {\n\t\t\t\tdiscard;\n\t\t\t}\n\t\t\tgl_FragColor = vColor;\n\t\t}\n\t",name:"polygon"}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(17),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(41),f=i(c),d=n(29),h=f.default.isNumber,v=f.default.isValidColor,p=f.default.isObject,_=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s.default)(this,t);var n=e.stops,i=void 0===n?{}:n,o=e.angle,r=void 0===o?0:o;if(this.stops={},!p(i))return void new d.BaseTypeError("stops","object",i).error();for(var a in i){var l=i[a];if(!v(l))return void console.error("GradientColorOptions.stops中key为 "+a+" 的color属性无效",l);this.stops[a]=l}if(!h(r))return void new d.BaseTypeError("GradientColorOptions.angle","number",r).error();this.angle=r}return(0,u.default)(t,[{key:"addColorStop",value:function(t,e){return h(t)?v(e)?void(this.stops[t]=e):void console.error("addColorStop中key为 "+t+" 的color属性无效",e):void new d.BaseTypeError("offset","number",e).error()}},{key:"setAngle",value:function(t){if(!h(t))return void new d.BaseTypeError("setAngle.angle","number",t).error();this.angle=t}},{key:"getAngle",value:function(){return this.angle}},{key:"isEmpty",value:function(){return(0,r.default)(this.stops).length<=0}}],[{key:"createDoubleColorGradient",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!v(e))return console.error("参数错误：createDoubleColorGradient.color1 颜色值不合法。"),null;if(!v(n))return console.error("参数错误：createDoubleColorGradient.color2 颜色值不合法。"),null;if(!h(i))return new d.BaseTypeError("createDoubleColorGradient.angle","number",i).error(),null;var o=new t;return o.addColorStop(0,e),o.addColorStop(1,n),o.setAngle(i),o}},{key:"convert",value:function(e){var n=e.constructor===Array?e:[];if(e.constructor===Object&&2===(0,r.default)(e).length)for(var i in e)n.push(e[i]);if(2===n.length&&v(n[0])&&v(n[1])){var o=new t;return o.addColorStop(0,n[0]),o.addColorStop(1,n[1]),o}return null}}]),t}();t.exports=_},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(0),r=i(o),a=n(1),s=i(a),l=n(10),u=i(l),c=function(){function t(e,n,i){(0,r.default)(this,t),this.worker=e,this.parent=n,this.mapId=i,this.callbacks={},this.callbackID=0,this.receive=this.receive.bind(this),this.worker.addEventListener("message",this.receive,!1)}return(0,s.default)(t,[{key:"send",value:function(t,e,n,i){var o=this;if(this.worker){var r=n?u.default.uniqueId()+":"+this.callbackID:null;if(this.callbackID+=1,n&&(this.callbacks[r]=n),e.dataFinishCallback){var a=e.dataFinishCallback;a.finishPromise().then(function(t){o.worker&&o.worker.postMessage({targetMapId:i,sourceMapId:o.mapId,type:a.type,id:String(r),data:t})}),e.dataFinishCallback=null}this.worker&&this.worker.postMessage({targetMapId:i,sourceMapId:this.mapId,type:t,id:String(r),data:e})}}},{key:"receive",value:function(t){var e=this,n=t.data,i=n.id,o=void 0;if(!n.targetMapId||this.mapId===n.targetMapId){var r=function(t,n,o){if(e.worker){var r=null;n&&n.transferableList&&(r=n.transferableList,delete n.transferableList),e.worker.postMessage({sourceMapId:e.mapId,type:"<response>",id:String(i),error:t,data:n,time:o},r||[])}};if("<response>"===n.type)o=this.callbacks[n.id],n.data&&n.data.baseData||delete this.callbacks[n.id],o&&o(n.error||null,n.data,n.time);else if(void 0!==n.id&&this.parent[n.type])this.parent[n.type](n.sourceMapId,n.data,r);else if(void 0!==n.id&&this.parent.getWorkerSource){var a=n.type.split("."),s=this.parent.getWorkerSource(n.sourceMapId,a[0]);s[a[1]](n.data,r)}}}},{key:"remove",value:function(){this.worker.removeEventListener("message",this.receive,!1),this.worker=null}}]),t}();t.exports=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){var i={};return d.default.forIn(t,function(t,o){if(e.hasOwnProperty(t)){var r=e[t];if(_.default.isNumber(o))i[t]="rotation"===t||"heading"===t?v.default.rotation(o,r,n):(0,v.default)(o,r,n);else if(o instanceof g.default){var a=v.default.latlng(o,r,n);i[t]=new g.default(a[0],a[1])}else o instanceof Array&&(i[t]=v.default.array(o,r,n))}}),i}function r(t,e){for(var n=1;n<t.length;n++){var i=t[n];if(i.percentage>=e){var r=t[n-1];return o(r,i,(e-r.percentage)/(i.percentage-r.percentage))}}}function a(t,e){t.sort(function(t,e){return t.percentage-e.percentage}),0!==t[0].percentage&&t.unshift((0,u.default)({},e,{percentage:0}));var n=t[t.length-1];1!==n.percentage&&t.push((0,u.default)({},n,{percentage:1}))}function s(){delete this._onAnimateFrame,delete this._onAnimateLoopEnd,delete this._onAnimateResume,delete this._onStop,delete this._onPause,delete this._abortTimeProcess}Object.defineProperty(e,"__esModule",{value:!0}),e.animatableMixin=void 0;var l=n(16),u=i(l),c=n(28),f=n(10),d=i(f),h=n(399),v=i(h),p=n(41),_=i(p),m=n(47),g=i(m);e.animatableMixin={_animateStatus:"done",_animate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=e.onFrame,i=void 0===n?function(){}:n,o=e.onEnd,l=void 0===o?function(){}:o,u=e.onLoop,c=void 0===u?function(){}:u,f=e.onStop,h=void 0===f?function(){}:f,v=e.onPause,p=void 0===v?function(){}:v,m=e.onResume,g=void 0===m?function(){}:m,y=this,x=arguments[2],b=x.duration,S=void 0===b?1e3:b,w=x.loop,E=void 0===w?1:w,T=x.initTick,A=void 0===T?0:T,P=x.id,I=void 0===P?d.default.uniqueId():P,k=x.easing,L=void 0===k?d.default.linearEase:k,M=arguments[3];if(this._isIdle()||this._stopAnimate(),t.length<2)return void console.error("参数错误：关键帧数量不足2："+t.length+"。");if(a(t,M),!((E=Number(E))<1)&&_.default.isNumber(E)){var C=1,R=A;return c.call(this,C),this._onAnimateLoopEnd=function(){C<E?(C+=1,c.call(y,C),y._startLoop(S,0)):(y._animateStatus="done",l.call(y),s.call(y))},this._onAnimateFrame=function(e){R=e,e=L(e);var n=r(t,e);i.call(y,{percentage:e,frame:n}),1===e&&y._onAnimateLoopEnd()},this._onAnimateResume=function(){y._startLoop(S,R),g.call(y)},this._onStop=h,this._onPause=p,this._animateStatus="doing",this._startLoop(S,A),i.call(this,{percentage:0,frame:t[0]}),I}},_startLoop:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._abortTimeProcess=(0,c.timed)(this._onAnimateFrame,null,t,this,e)},_stopAnimate:function(){this._isIdle()||(this._animateStatus="done",this._abortTimeProcess&&this._abortTimeProcess(),this._onStop&&this._onStop.call(this),s.call(this))},_pauseAnimate:function(){this._isAnimating()&&(this._animateStatus="paused",this._abortTimeProcess&&this._abortTimeProcess(),this._onPause&&this._onPause.call(this))},_resumeAnimate:function(){this._isPaused()&&(this._animateStatus="doing",this._onAnimateResume&&this._onAnimateResume())},_isAnimating:function(){return"doing"===this._animateStatus},_isPaused:function(){return"paused"===this._animateStatus},_isIdle:function(){return"done"===this._animateStatus}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(105),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=o.default.key||""},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(256),p=i(v),_={Scale:{m:"米",km:"公里",mile:"英里",feet:"英尺"}},m=function(t,e){"[object String]"===Object.prototype.toString.call(t.innerText)?t.innerText=e:t.textContent=e},g="position:absolute;border:1px solid #ffffff;width:2px;height:6px;background:#000;font-size:0;line-height:0;",y=g+"border-bottom-width:0px;",x=g+"border-top-width:0px;",b=function(t){var e=Math.pow(10,(""+Math.floor(t)).length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=2?2:1,e*n},S=function(t){return Math.round(125*t)-10},w=function(t,e,n){if(t&&e&&n)return Math.abs(156543.04/n*Math.cos(t.lat*Math.PI/180))/Math.pow(2,e)},E=function(t){var e=document.createElement("div");return"up"===t?(e.style.cssText=y+";border-right-width:0px",e.style.top="7px",e.style.height="9px"):"down"===t&&(e.style.cssText=x+";border-right-width:0px",e.style.top="17px",e.style.height="6px"),e.style.left=0,e.style.zIndex=0,e.className="tmap-scale-line",e},T=function(t){var e=document.createElement("div");return"up"===t?(e.style.cssText=y,e.style.top="0px"):"down"===t&&(e.style.cssText=x,e.style.top="9px"),e.style.left="81px",e.style.zIndex=2,e.className="tmap-scale-line",e},A=function(){var t=document.createElement("div");return t.style.cssText="position:absolute;border:1px solid #ffffff;width:2px;height:6px;background:#000;font-size:0;line-height:0;z-index:1;border-left-width:0px;",t.style.left="3px",t.style.width="80px",t.style.height="2px",t.style.top="6px",t.className="tmap-scale-line",t},P=function(t){var e=document.createElement("div"),n="up"===t?"top: 0px;":"bottom:-17px;";return e.style.cssText="position:relative; "+n+" font:11px arial,simsun;color:#000;text-align:left; left:5px;",e.className="tmap-scale-text",e},I=function(t){for(var e=[],n=["up","down"],i=0;i<2;i++){var o=n[i],r=document.createElement("div");r.style.cssText="width:100px;position:absolute;";var a=document.createElement("div");a.style.cssText="position:absolute;height:7px;width:84px;bottom:0px;";var s=E(o),l=T(o),u=A(),c=P(o);r.appendChild(s),a.appendChild(l),a.appendChild(u),r.appendChild(c),r.appendChild(a),e[o+"_rr"]=l,e[o+"_rl"]=s,e[o+"_rm"]=u,e[o+"_ruler"]=a,e[o+"_text"]=c,e[o+"_rl"]=s,t.appendChild(r)}var f=void 0;return{getMaxWidth:function(){return f},refresh:function(t){var n=void 0,i=void 0,o=e.up_rr,r=e.up_rm,a=e.up_text,s=e.up_ruler,l=e.down_rr,u=e.down_rm,c=e.down_ruler,d=e.down_text,h=b(t);n=S(h/t);var v=n;i=h<1e3?h+" "+_.Scale.m:h/1e3+" "+_.Scale.km,m(a,i),a.style.width="80px",r.style.width=n+"px",o.style.left=n+0+"px";var p=3.2808399*t,g=void 0,y=void 0,x=void 0;p>5280?(g=p/5280,y=b(g),n=S(y/g),i=y+" "+_.Scale.mile):(x=b(p),n=S(x/p),i=x+" "+_.Scale.feet),m(d,i);var w=parseInt(r.style.width,10),E=n>w?n:w;d.style.width="80px",u.style.width=E+"px",l.style.left=n+"px",u.style.visibility=n>w?"":"hidden",r.style.visibility=n>w?"hidden":"",c.style.zIndex=n>w?0:1,s.style.zIndex=n>w?1:0,f=Math.max(v,E)}}},k=function(t,e,n,i){var o=document.createElement("div");o.style.cssText="position:absolute;";var r=I(o),a=function(e,n,i){var o=w(e,n,i);if(o){var a=125*o;r.refresh(a),t.style.width=r.getMaxWidth()+10+"px"}};return a(e,n,i),t.style.width="100px",t.style.height="35px",t.appendChild(o),{node:t,updateZoom:a}},L=function(t,e,n){var i=document.createElement("div");return i.className="tmap-scale-control",k(i,t,e,n)},M=function(t){function e(t){return(0,s.default)(this,e),(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t))}return(0,h.default)(e,t),(0,u.default)(e,[{key:"createDOM",value:function(t){var e=t.center,n=t.zoom,i=t.scale,o=document.createElement("div");return o.style.width="125px",o.style.height="35px",this.scaleControlView=L(e,n,i),o.appendChild(this.scaleControlView.node),o}},{key:"onAdd",value:function(){this.updateControl=this.updateControl.bind(this),this.map.on("zoom_changed",this.updateControl),this.map.on("scale_changed",this.updateControl)}},{key:"onRemove",value:function(){this.map.off("zoom_changed",this.updateControl),this.map.off("scale_changed",this.updateControl)}},{key:"updateControl",value:function(){var t=this.map.getCenter(),e=this.map.getZoom(),n=this.map.getScale();this.scaleControlView.updateZoom(t,e,n)}}]),e}(p.default);e.default=M},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(256),p=i(v),_=n(297),m=n(296),g=n(28),y=i(g),x=n(137),b=n(1027),S=n(1041),w=n(1042),E=n(1040);n(1031);var T=function(t){function e(t){(0,s.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t));return n.clickStrategy={compassCircle:function(t){if("end"!==t&&"2D"!==n.getViewMode())return!n.getPitchable()&&n.getRotatable()?void(n.map&&n.map.easeTo({heading:0})):n.getPitchable()&&!n.getRotatable()?void(n.map&&n.map.easeTo({pitch:0})):void(n.map&&n.map.easeTo({pitch:0,heading:0,roll:0}))},rotateTop:function(t){"2D"!==n.getViewMode()&&n.getPitchable()&&n.map&&(n.pitchHandle||(n.pitchHandle=n.map.getNonStopPitch()),"start"===t?n.pitchHandle.begin(1):"end"===t&&n.pitchHandle.cancel())},rotateBottom:function(t){"2D"!==n.getViewMode()&&n.getPitchable()&&n.map&&(n.pitchHandle||(n.pitchHandle=n.map.getNonStopPitch()),"start"===t?n.pitchHandle.begin(-1):"end"===t&&n.pitchHandle.cancel())},rotateLeft:function(t){"2D"!==n.getViewMode()&&n.getRotatable()&&n.map&&(n.rotateHandle||(n.rotateHandle=n.map.getNonStopRotate()),"start"===t?n.rotateHandle.begin(1):"end"===t&&n.rotateHandle.cancel())},rotateRight:function(t){"2D"!==n.getViewMode()&&n.getRotatable()&&n.map&&(n.rotateHandle||(n.rotateHandle=n.map.getNonStopRotate()),"start"===t?n.rotateHandle.begin(-1):"end"===t&&n.rotateHandle.cancel())}},n._bindEvents(),n._construct(),n}return(0,h.default)(e,t),(0,u.default)(e,[{key:"_construct",value:function(){this.compassImg=this.dom.querySelector(".compass-img"),this.compassCircle=this.dom.querySelector(".compass-circle"),this.rotateLeftImg=this.dom.querySelector(".rotate-left-img"),this.rotateRightImg=this.dom.querySelector(".rotate-right-img"),this.rotateTopImg=this.dom.querySelector(".rotate-top-img"),this.rotateBottomImg=this.dom.querySelector(".rotate-bottom-img"),this.compassImg.src=E,this.rotateLeftImg.src=w,this.rotateRightImg.src=w,this.rotateTopImg.src=S,this.rotateBottomImg.src=S}},{key:"createDOM",value:function(){var t=document.createElement("div"),e=(0,_.Template)(b,{});return t.innerHTML?t.insertAdjacentHTML("afterbegin",e):t.innerHTML=e,t}},{key:"onAdd",value:function(){var t=this.onRotateChange.bind(this),e=this.onPitchChange.bind(this);if(this.throttleRotateChange=y.default.throttle(t,50),this.throttlePitchChange=y.default.throttle(e,50),this.map.on("rotate",this.throttleRotateChange),this.map.on("pitch",this.throttlePitchChange),"3D"===this.getViewMode()){var n=this.map.getPitch(),i=this.map.getRotation();this.setButtonUseful(!0),this.checkButtonState(n),this.checkCompassState(n,i)}else this.setButtonUseful(!1)}},{key:"_bindEvents",value:function(){var t=this;this.handlers=[],["compass-circle","rotate-left","rotate-right","rotate-top","rotate-bottom"].forEach(function(e){t.handleListen(e)}),this.handlers.push((0,g.on)(this.dom,"dblclick",function(t){t.stopPropagation()})),this.handlers.push((0,g.on)(this.dom,"mousedown,mousemove,mouseup,mouseover,mouseleave,click,dblclick, touchstart,touchmove,touchend",function(t){t.stopPropagation()}))}},{key:"onRotateChange",value:function(t){var e=t.target.getRotation();this.compassImg.style.transform="rotateZ("+e+"deg)"}},{key:"onPitchChange",value:function(t){var e=Math.round(t.target.getPitch());this.compassCircle.style.transform="rotatex("+e+"deg)",this.checkButtonState(e)}},{key:"handleListen",value:function(t){var e=this,n=this.toCamel(t),i=this.dom.querySelector("."+t),o=new m.Finger(i,{preventDefaultMove:!0,preventDefaultEnd:!0,stopPropagation:!0});this.handlers.push((0,g.on)(o,"touch-start",function(){e.clickStrategy[n]&&e.clickStrategy[n]("start")})),this.handlers.push((0,g.on)(o,"touch-end",function(){e.clickStrategy[n]&&e.clickStrategy[n]("end")}))}},{key:"toCamel",value:function(t){return t&&t.replace(/\-(\w)/g,function(t,e){return e.toUpperCase()})}},{key:"setButtonUseful",value:function(t){if(!t){return void["rotate-bottom","rotate-top","rotate-left","rotate-right"].forEach(function(t){document.getElementsByClassName(t)[0].classList.add("unclickable-"+t),document.getElementsByClassName(t)[0].classList.remove("clickable-"+t)})}var e=this.getPitchable(),n=this.getRotatable(),i=[],o=[];e?i=i.concat(["rotate-bottom","rotate-top"]):o=o.concat(["rotate-bottom","rotate-top"]),n?i=i.concat(["rotate-left","rotate-right"]):o=o.concat(["rotate-left","rotate-right"]),i.forEach(function(t){document.getElementsByClassName(t)[0].classList.add("clickable-"+t),document.getElementsByClassName(t)[0].classList.remove("unclickable-"+t)}),o.forEach(function(t){document.getElementsByClassName(t)[0].classList.add("unclickable-"+t),document.getElementsByClassName(t)[0].classList.remove("clickable-"+t)})}},{key:"checkButtonState",value:function(t){0===t&&this.lastPitch!==t?(document.getElementsByClassName("rotate-bottom")[0].classList.add("unclickable-rotate-bottom"),document.getElementsByClassName("rotate-bottom")[0].classList.remove("clickable-rotate-bottom")):0===this.lastPitch&&0!==t?(document.getElementsByClassName("rotate-bottom")[0].classList.add("clickable-rotate-bottom"),document.getElementsByClassName("rotate-bottom")[0].classList.remove("unclickable-rotate-bottom")):80===t&&this.lastPitch!==t?(document.getElementsByClassName("rotate-top")[0].classList.add("unclickable-rotate-top"),document.getElementsByClassName("rotate-top")[0].classList.remove("clickable-rotate-top")):80===this.lastPitch&&80!==t&&(document.getElementsByClassName("rotate-top")[0].classList.add("clickable-rotate-top"),document.getElementsByClassName("rotate-top")[0].classList.remove("unclickable-rotate-top")),this.lastPitch=t}},{key:"checkCompassState",value:function(t,e){this.compassImg.style.transform="rotateZ("+e+"deg)",this.compassCircle.style.transform="rotatex("+t+"deg)"}},{key:"getViewMode",value:function(){return this.map.getViewMode()}},{key:"getPitchable",value:function(){return this.map.getPitchable()}},{key:"getRotatable",value:function(){return this.map.getRotatable()}},{key:"setViewMode",value:function(t){t===x.VIEW_MODE.MAP_2D?this.setButtonUseful(!1):this.setButtonUseful(!0)}},{key:"onRemove",value:function(){this.map.off("rotate",this.throttleRotateChange),this.map.off("pitch",this.throttlePitchChange),this.rotateHandle=null,this.lastPitch=null,this.throttleRotateChange=null,this.throttlePitchChange=null}},{key:"onDestroy",value:function(){this.handlers.forEach(function(t){t&&t.remove()})}}]),e}(p.default);e.default=T},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(256),p=i(v),_=n(297),m=n(296),g=n(28),y=n(1028),x=n(1043),b=n(1044);n(1032);var S=function(t){function e(t){(0,s.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t));return n.dom.querySelector(".tmap-zoom-in-image").src=x,n.dom.querySelector(".tmap-zoom-out-image").src=b,n._bindEvents(),n}return(0,h.default)(e,t),(0,u.default)(e,[{key:"createDOM",value:function(){var t=document.createElement("div"),e=(0,_.Template)(y,{});return t.innerHTML?t.insertAdjacentHTML("afterbegin",e):t.innerHTML=e,t}},{key:"setNumVisible",value:function(t){t?(this.dom.querySelector(".tmap-zoom-control").style.height="102px",this.dom.querySelector(".tmap-zoom-number").style.display="block",this.dom.querySelector(".tmap-zoom-spliter").style.display="none",this.dom.querySelector(".tmap-zoom-out").style.top="70px"):(this.dom.querySelector(".tmap-zoom-control").style.height="80px",this.dom.querySelector(".tmap-zoom-number").style.display="none",this.dom.querySelector(".tmap-zoom-spliter").style.display="block",this.dom.querySelector(".tmap-zoom-out").style.top="48px")}},{key:"_bindEvents",value:function(){var t=this;this.zoomIn=this.dom.querySelector(".tmap-zoom-in"),this.zoomOut=this.dom.querySelector(".tmap-zoom-out"),this.zoomNumberShow=this.dom.querySelector(".tmap-zoom-number"),this.updateZoomNumberDisplay=function(){t.zoomNumberShow.innerHTML=t.map.getZoom().toFixed(1)},this.handlers=[],this.zoomInFinger=new m.Finger(this.zoomIn,{preventDefaultMove:!0,preventDefaultEnd:!0,stopPropagation:!0}),this.zoomOutFinger=new m.Finger(this.zoomOut,{preventDefaultMove:!0,preventDefaultEnd:!0,stopPropagation:!0}),this.handlers.push((0,g.on)(this.zoomInFinger,"tap",function(){t.map&&t.map.zoomBy(1)})),this.handlers.push((0,g.on)(this.zoomOutFinger,"tap",function(){t.map&&t.map.zoomBy(-1)})),this.handlers.push((0,g.on)(this.dom,"dblclick",function(t){t.stopPropagation()})),this.handlers.push((0,g.on)(this.dom,"mousedown,mousemove,mouseup,mouseover,mouseleave,click,dblclick, touchstart,touchmove,touchend",function(t){t.stopPropagation()}))}},{key:"onAdd",value:function(){this.updateZoomNumberDisplay(),this.map.on("zoom",this.updateZoomNumberDisplay)}},{key:"onRemove",value:function(){this.updateZoomNumberDisplay&&this.map.off("zoom",this.updateZoomNumberDisplay)}},{key:"onDestroy",value:function(){this.handlers.forEach(function(t){t&&t.remove()})}}]),e}(p.default);e.default=S},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(74),p=i(v),_=function(t){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,s.default)(this,e);var o=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t,n));return o.z=i,o}return(0,h.default)(e,t),(0,u.default)(e,[{key:"getZ",value:function(){return this.z}},{key:"clone",value:function(){return new e(this.x,this.y,this.z)}}]),e}(p.default);e.default=_},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var n=(0,l.latLngToMercator)(t),i=[],o=0;o<=f;o++){var r=o*d,a=new c.default(0,0);a.x=Math.cos(r),a.y=Math.sin(r),i.push(a)}for(var s=i.length-1;s>=0;s--){var u=i[s];i.push(new c.default(u.y,u.x))}for(var h=i.length-1;h>=0;h--){var v=i[h];i.push(new c.default(-v.x,v.y))}for(var p=i.length-1;p>=0;p--){var _=i[p];i.push(new c.default(_.x,-_.y))}var m=t.getLat()*Math.PI/180;return i.map(function(t){return t.x=n.x+e/Math.cos(m)*t.x,t.y=n.y+e/Math.cos(m)*t.y,(0,l.mercatorToLatLng)(t)})}function r(t){return(0,s.default)(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.getCirclePath=o;var a=n(277),s=i(a),l=n(112),u=n(74),c=i(u),f=9,d=5*Math.PI/180;e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){for(var i=(0,l.latLngToMercator)(t),o=[],r=0;r<=f;r++){var a=r*d,s=new c.default(0,0);s.x=Math.cos(a),s.y=Math.sin(a),o.push(s)}for(var u=o.length-1;u>=0;u--){var h=o[u];o.push(new c.default(h.y,h.x))}for(var v=o.length-1;v>=0;v--){var p=o[v];o.push(new c.default(-p.x,p.y))}for(var _=o.length-1;_>=0;_--){var m=o[_];o.push(new c.default(m.x,-m.y))}var g=t.getLat()*Math.PI/180;return o.map(function(t){return t.x=i.x+e/Math.cos(g)*t.x,t.y=i.y+n/Math.cos(g)*t.y,(0,l.mercatorToLatLng)(t)})}function r(t){return(0,s.default)(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.getEllipsePath=o;var a=n(277),s=i(a),l=n(112),u=n(74),c=i(u),f=9,d=5*Math.PI/180;e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=i(o),a=n(1),s=i(a),l=n(47),u=i(l),c=n(209),f=i(c),d=function(){function t(e,n){(0,r.default)(this,t),this.markerCluster=e,this.gridSize=e.gridSize,this.averageCenter=e.averageCenter,this.zoom=n,this.center=null,this.geometries=[],this.geometrySet={},this.bounds=null}return(0,s.default)(t,[{key:"getClusterInfo",value:function(){return{center:this.center,geometries:this.geometries,bounds:this.bounds}}},{key:"getCenter",value:function(){return this.center}},{key:"add",value:function(t){if(!this.geometrySet[t.id]){if(this.center){if(this.averageCenter){var e=this.geometries.length+1,n=(this.center.lat*(e-1)+t.position.lat)/e,i=(this.center.lng*(e-1)+t.position.lng)/e;this.center=new u.default(n,i),this._calculateBounds()}}else this.center=t.position,this._calculateBounds();this.geometrySet[t.id]=t,this.geometries.push(t)}}},{key:"_calculateBounds",value:function(){var t=new f.default(this.center,this.center);this.bounds=this.markerCluster._getExtendedBounds(t,this.zoom)}},{key:"getBounds",value:function(){var t=new f.default(this.center,this.center);return this.geometries.forEach(function(e){t.extend(new u.default(e.position.lat,e.position.lng))}),t}},{key:"getGeometries",value:function(){return this.geometries}},{key:"isInBounds",value:function(t){return this.bounds.contains(t.position)}},{key:"remove",value:function(){this.markerCluster=null,this.gridSize=null,this.averageCenter=null,this.center=null,this.geometries=[],this.geometrySet={},this.bounds=null}}],[{key:"normalizeClusterInfo",value:function(t){return{center:u.default.convert(t.center),geometries:t.geometries.map(function(t){return t.position=u.default.convert(t.position),t}),bounds:f.default._convertFromWorker(t.bounds)}}}]),t}();e.default=d},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(27),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=/^[og]\s*(.+)?/,f=/^mtllib /,d=/^usemtl /,h=function(){function t(e){var n=e.index,i=e.name,o=void 0===i?"":i,r=e.mtllib,a=e.smooth,l=e.groupStart;(0,s.default)(this,t),this.index=n,this.name=o,this.mtllib=r,this.smooth=a,this.groupStart=l,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}return(0,u.default)(t,[{key:"clone",value:function(){return new t({index:arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}]),t}(),v=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,s.default)(this,t),this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0}return(0,u.default)(t,[{key:"startMaterial",value:function(t,e){var n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);var i=new h({index:this.materials.length,name:t,mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0});return this.materials.push(i),i}},{key:"currentMaterial",value:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]}},{key:"_finalize",value:function(t){var e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(var n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}}]),t}(),p=function(){function t(){(0,s.default)(this,t),this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}return(0,u.default)(t,[{key:"startObject",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.object&&!this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=e);var n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object=new v(t),this.object.fromDeclaration=e,n&&n.name&&"function"==typeof n.clone){var i=n.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)}},{key:"finalize",value:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)}},{key:"parseVertexIndex",value:function(t,e){var n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)}},{key:"parseNormalIndex",value:function(t,e){var n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)}},{key:"parseUVIndex",value:function(t,e){var n=parseInt(t,10);return 2*(n>=0?n-1:n+e/2)}},{key:"addVertex",value:function(t,e,n){var i=this.vertices,o=this.object.geometry.vertices;o.push(i[t+0],i[t+1],i[t+2]),o.push(i[e+0],i[e+1],i[e+2]),o.push(i[n+0],i[n+1],i[n+2])}},{key:"addVertexPoint",value:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])}},{key:"addVertexLine",value:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])}},{key:"addNormal",value:function(t,e,n){var i=this.normals,o=this.object.geometry.normals;o.push(i[t+0],i[t+1],i[t+2]),o.push(i[e+0],i[e+1],i[e+2]),o.push(i[n+0],i[n+1],i[n+2])}},{key:"addColor",value:function(t,e,n){var i=this.colors,o=this.object.geometry.colors;o.push(i[t+0],i[t+1],i[t+2]),o.push(i[e+0],i[e+1],i[e+2]),o.push(i[n+0],i[n+1],i[n+2])}},{key:"addUV",value:function(t,e,n){var i=this.uvs,o=this.object.geometry.uvs;o.push(i[t+0],i[t+1]),o.push(i[e+0],i[e+1]),o.push(i[n+0],i[n+1])}},{key:"addUVLine",value:function(t){var e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])}},{key:"addFace",value:function(t,e,n,i,o,r,a,s,l){var u=this.vertices.length,c=this.parseVertexIndex(t,u),f=this.parseVertexIndex(e,u),d=this.parseVertexIndex(n,u);if(this.addVertex(c,f,d),void 0!==i&&""!==i){var h=this.uvs.length;c=this.parseUVIndex(i,h),f=this.parseUVIndex(o,h),d=this.parseUVIndex(r,h),this.addUV(c,f,d)}if(void 0!==a&&""!==a){var v=this.normals.length;c=this.parseNormalIndex(a,v),f=a===s?c:this.parseNormalIndex(s,v),d=a===l?c:this.parseNormalIndex(l,v),this.addNormal(c,f,d)}this.colors.length>0&&this.addColor(c,f,d)}},{key:"addPointGeometry",value:function(t){this.object.geometry.type="Points";var e=this.vertices.length,n=!0,i=!1,o=void 0;try{for(var a,s=(0,r.default)(t);!(n=(a=s.next()).done);n=!0){var l=a.value;this.addVertexPoint(this.parseVertexIndex(l,e))}}catch(t){i=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}}},{key:"addLineGeometry",value:function(t,e){this.object.geometry.type="Line";var n=this.vertices.length,i=this.uvs.length,o=!0,a=!1,s=void 0;try{for(var l,u=(0,r.default)(t);!(o=(l=u.next()).done);o=!0){var c=l.value;this.addVertexLine(this.parseVertexIndex(c,n))}}catch(t){a=!0,s=t}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}var f=!0,d=!1,h=void 0;try{for(var v,p=(0,r.default)(e);!(f=(v=p.next()).done);f=!0){var _=v.value;this.addUVLine(this.parseUVIndex(_,i))}}catch(t){d=!0,h=t}finally{try{!f&&p.return&&p.return()}finally{if(d)throw h}}}}]),t}();e.default=function(t){var e=new p;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));for(var n=t.split("\n"),i="",o="",a=[],s="function"==typeof"".trimLeft,l=0,u=n.length;l<u;l++)if(i=n[l],i=s?i.trimLeft():i.trim(),0!==i.length&&"#"!==(o=i.charAt(0)))if("v"===o){var h=i.split(/\s+/);switch(h[0]){case"v":e.vertices.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])),8===h.length&&e.colors.push(parseFloat(h[4]),parseFloat(h[5]),parseFloat(h[6]));break;case"vn":e.normals.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]));break;case"vt":e.uvs.push(parseFloat(h[1]),parseFloat(h[2]))}}else if("f"===o){for(var v=i.substr(1).trim(),_=v.split(/\s+/),m=[],g=0,y=_.length;g<y;g++){var x=_[g];if(x.length>0){var b=x.split("/");m.push(b)}}for(var S=m[0],w=1,E=m.length-1;w<E;w++){var T=m[w],A=m[w+1];e.addFace(S[0],T[0],A[0],S[1],T[1],A[1],S[2],T[2],A[2])}}else if("l"===o){var P=i.substring(1).trim().split(" "),I=void 0,k=[];if(-1===i.indexOf("/"))I=P;else{I=[];for(var L=0,M=P.length;L<M;L++){var C=P[L].split("/");""!==C[0]&&I.push(C[0]),""!==C[1]&&k.push(C[1])}}e.addLineGeometry(I,k)}else if("p"===o){var R=i.substr(1).trim(),B=R.split(" ");e.addPointGeometry(B)}else if(null!==(a=c.exec(i))){var N=(" "+a[0].substr(1).trim()).substr(1);e.startObject(N)}else if(d.test(i))e.object.startMaterial(i.substring(7).trim(),e.materialLibraries);else if(f.test(i))e.materialLibraries.push(i.substring(7).trim());else{if("s"!==o){if("\0"===i)continue;throw new Error('Unexpected line: "'+i+'"')}if(a=i.split(" "),a.length>1){var O=a[1].trim().toLowerCase();e.object.smooth="0"!==O&&"off"!==O}else e.object.smooth=!0;var D=e.object.currentMaterial();D&&(D.smooth=e.object.smooth)}e.finalize();var z=[],F=[],V=!0,Y=!1,U=void 0;try{for(var j,G=(0,r.default)(e.objects);!(V=(j=G.next()).done);V=!0){var Z=j.value,H=Z.geometry;if(0!==H.vertices.length){var W={header:{vertexCount:H.vertices.length/3},attributes:{}};switch(H.type){case"Points":W.mode=0;break;case"Line":W.mode=1;break;default:W.mode=4}W.attributes.POSITION={value:new Float32Array(H.vertices),size:3},H.normals.length>0&&(W.attributes.NORMAL={value:new Float32Array(H.normals),size:3}),H.colors.length>0&&(W.attributes.COLOR_0={value:new Float32Array(H.colors),size:3}),H.uvs.length>0&&(W.attributes.TEXCOORD_0={value:new Float32Array(H.uvs),size:2}),W.materials=[];var X=!0,Q=!1,q=void 0;try{for(var K,J=(0,r.default)(Z.materials);!(X=(K=J.next()).done);X=!0){var $=K.value,tt={name:$.name,flatShading:!$.smooth};W.materials.push(tt),F.push(tt)}}catch(t){Q=!0,q=t}finally{try{!X&&J.return&&J.return()}finally{if(Q)throw q}}W.name=Z.name,z.push(W)}}}catch(t){Y=!0,U=t}finally{try{!V&&G.return&&G.return()}finally{if(Y)throw U}}return{meshes:z,materials:F}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return t.length>=2&&(0,h.default)(t[0].lat)&&(0,h.default)(t[0].lng)}function r(t){return t.length>=1&&t.every(function(t){return o(t)})}function a(t){return(o(t)?[t]:t).map(function(t){return s(t)})}function s(t){var e=t.length>0?[t[0]]:[];return t.forEach(function(t){var n=e[e.length-1];t.lat===n.lat&&t.lng===n.lng||e.push(t)}),e}function l(t){var e=[];return t.forEach(function(n,i){if(i>0){var o=t[i-1],r=[o.lng,o.lat],a=[n.lng,n.lat],s=u(n.lng,o.lng);if(s<5){var l=n.lng,c=n.lat;e.push({lng:l,lat:c,height:0})}else{(0,p.default)(r,a,{npoints:Math.ceil(s/5)}).geometry.coordinates.forEach(function(t){if(Array.isArray(t[0]))t.forEach(function(t){var n=(0,f.default)(t,2),i=n[0],o=n[1];e.push({lng:i,lat:o,height:0})});else{var n=(0,f.default)(t,2),i=n[0],o=n[1];e.push({lng:i,lat:o,height:0})}})}return!0}var d=n.lng,h=n.lat;e.push({lng:d,lat:h,height:0})}),e}function u(t,e){return Math.abs(e-t)<180?Math.abs(e-t):360-Math.abs(e-t)}Object.defineProperty(e,"__esModule",{value:!0});var c=n(32),f=i(c),d=n(343),h=i(d);e.isSimple=o,e.isComplexLine=r,e.normalize=a,e.deduplicatePoint=s,e.cross180=l;var v=n(649),p=i(v)},function(t,e,n){"use strict";function i(t,e){return function(n){return new r.default(n,t,e)}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(651),r=function(t){return t&&t.__esModule?t:{default:t}}(o);e.default=i},function(t,e,n){"use strict";function i(t,e){return f.default.batchRender&&(e+=1),e===f.default.maxDataZoom&&t>e}function o(t,e){return e<f.default.maxDataZoom&&t<=e}function r(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return f.default.batchRender&&(e+=1),Math.abs(t-e)<=n}function a(t,e,n){return!(r(t,e,1)||n&&o(e,n)||i(t,e))}function s(t,e,n){return!(r(Math.round(t),e)||n&&o(e,n)||i(t,e))}function l(t,e,n){return s(t,e,n)}function u(t,e){return s(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.isInterceptForBase64=a,e.isInterceptForGPU=s,e.isInterceptForTileData=l,e.isInterceptForPlacement=u;var c=n(23),f=function(t){return t&&t.__esModule?t:{default:t}}(c)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(){return[{name:"a_Position",components:2,type:"UNSIGNED_SHORT",offset:0},{name:"a_Color",components:4,type:"UNSIGNED_BYTE",offset:4},{name:"a_Normal",components:2,type:"UNSIGNED_BYTE",offset:8},{name:"a_LineInfo",components:2,type:"UNSIGNED_BYTE",offset:10},{name:"a_LineDistance",components:1,type:"UNSIGNED_SHORT",offset:12},{name:"a_SideInfo",components:2,type:"UNSIGNED_BYTE",offset:14},{name:"a_PickingColor",components:4,type:"UNSIGNED_BYTE",offset:16}]}function r(){return["Uint16","Uint16","Uint8","Uint8","Uint8","Uint8","Uint8","Uint8","Uint8","Uint8","Uint16","Uint8","Uint8","Uint8","Uint8","Uint8","Uint8"]}function a(t){var e=t.transX,n=void 0===e?0:e,i=t.transY,o=void 0===i?0:i,r=t.scale,a=void 0===r?1:r;return Math.round(n/256)+4*Math.round(o/256)+16*Math.round(1/a)}Object.defineProperty(e,"__esModule",{value:!0});var s=n(0),l=i(s),u=n(1),c=i(u),f=n(74),d=i(f),h=n(481),v=i(h),p=n(278),_=i(p),m=n(237),g=i(m),y=n(381),x=(i(y),n(23)),b=i(x),S=b.default.batchRender?"Uint32":"Uint16",w=function(){function t(e){(0,l.default)(this,t),e=e||{},this.normalScale=63,this.type=e.type||"default",this.noTerminal=e.noTerminal||!1,this.lineDistance=e.startDistance||0;var n=(0,v.default)(r(),o()),i=(0,v.default)([S]);this.vertiesDataBuffer=n(4096),this.indicesDataBuffer=i(4096),this.lineCount=0}return(0,c.default)(t,[{key:"addLine",value:function(t,e,n,i,o,r,s,l){function u(t,e,o,r){x=e.sub(t);var a=x.perp().unit().mult(b)._round(),s=a.mult(-1),l=e.dist(t),u=Math.max(1,Math.floor(h+l)),c=o.length,d=1024+~~t.x+w,v=1024+~~t.y+E,p=1024+~~e.x+w,_=1024+~~e.y+E;a.x+=128,a.y+=128,s.x+=128,s.y+=128,o.add([[d,v,n[0],n[1],n[2],n[3],a.x,a.y,i,S,10*h+T,A,P,f[0],f[1],f[2],f[3]],[d,v,n[0],n[1],n[2],n[3],s.x,s.y,i,S,10*h+T,A,P,f[0],f[1],f[2],f[3]],[p,_,n[0],n[1],n[2],n[3],s.x,s.y,i,S,10*u+T,A,P,f[0],f[1],f[2],f[3]],[p,_,n[0],n[1],n[2],n[3],a.x,a.y,i,S,10*u+T,A,P,f[0],f[1],f[2],f[3]]]),r.add([[c+0],[c+1],[c+3],[c+1],[c+2],[c+3]]),h=u}function c(t,e,o){var r=1.732*b,a=e.length,s=1024+~~t.x+w,l=1024+~~t.y+E;e.add([[s,l,n[0],n[1],n[2],n[3],128,2*b+128,i-0,0,10+T,A,P,f[0],f[1],f[2],f[3]],[s,l,n[0],n[1],n[2],n[3],128-r,-1*b+128,i-0,0,10+T,A,P,f[0],f[1],f[2],f[3]],[s,l,n[0],n[1],n[2],n[3],r+128,-1*b+128,i-0,0,10+T,A,P,f[0],f[1],f[2],f[3]]]),o.add([[a+0],[a+1],[a+2]])}this.lineCount+=1,t=t||{};var f=t.pickingColor||[0,0,0,0],h=s||1,v=t,p=v.noTerminal,_=this.vertiesDataBuffer,m=this.indicesDataBuffer,g=void 0,y=void 0,x=void 0,b=this.normalScale,S=0;o&&r?S=Math.min(10*o,240)+Math.floor(10-r/o*10):(o=0,r=0);var w=2048*(t.preWidth||0),E=2048*(t.nextWidth||0),T=t.deltaSideWidth||0,A=t.isSide||0,P=a(t.transform);h=h%(o+r)||1;for(var I=[],k=0,L=e.length/2;k<L;k++)I.push(new d.default(2*e[2*k],2*-e[2*k+1]));if(l&&I.push(I[0],I[1]),!S&&!p&&I.length>2){p||c(I[0],_,m);for(var M=1,C=I.length;M<C;M++)y=I[M],c.bind(this)(y,_,m)}for(var R=1,B=I.length;R<B;R++)g=I[R-1],y=I[R],u.bind(this)(g,y,_,m)}},{key:"addPolygon",value:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.vertiesDataBuffer,o=this.indicesDataBuffer,r=n.pickingColor,s=a(n.transform),l=g.default.mixCoords(t,"polygon",e.concat([0,0,0,0,0,0,s]).concat(r||[0,0,0,0]),1024,2),u=_.default.flatten([l]),c=u.vertices,f=u.dimensions,d=(0,_.default)(c,u.holes,f,i.length),h=0,v=c.length/f;h<v;h++){for(var p=[],m=h*f,y=(h+1)*f;m<y;m++)p.push(c[m]);i.add([p])}o.add(d)}}]),t}();e.default=w},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return t===S.RENDER_LAYER_TYPE.marker||t===S.RENDER_LAYER_TYPE.label}function r(t){return t===S.RENDER_LAYER_TYPE.polygon||t===S.RENDER_LAYER_TYPE.circle||t===S.RENDER_LAYER_TYPE.ellipse||t===S.RENDER_LAYER_TYPE.rectangle}Object.defineProperty(e,"__esModule",{value:!0});var a=n(3),s=i(a),l=n(0),u=i(l),c=n(1),f=i(c),d=n(5),h=i(d),v=n(35),p=i(v),_=n(4),m=i(_);e.hasBorderLayer=r;var g=n(257),y=i(g),x=n(90),b=n(143),S=n(66),w=function(t){function e(t){return(0,u.default)(this,e),o(t.type)?t.level=b.LAYER_LEVEL.OVERLAY_NAA:t.level=b.LAYER_LEVEL.OVERLAY_AA,(0,h.default)(this,(e.__proto__||(0,s.default)(e)).call(this,t))}return(0,m.default)(e,t),(0,f.default)(e,[{key:"_initialize",value:function(t){(0,p.default)(e.prototype.__proto__||(0,s.default)(e.prototype),"_initialize",this).call(this,t),this.sourceData=t.sourceData,this.sourceId=this.id}},{key:"_addSource",value:function(){this.map&&!this.map.getSource(this.sourceId)&&this.map.addSource(this.sourceId,{type:x.SOURCE_TYPE.geojson,tileSize:this.tileSize,data:this.sourceData})}},{key:"_removeSource",value:function(){this.map&&this.map.removeSource(this.sourceId)}}]),e}(y.default);e.default=w},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(257),p=i(v),_=n(90),m=n(209),g=i(m),y=n(29),x=function(t){function e(t){return(0,s.default)(this,e),(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t))}return(0,h.default)(e,t),(0,u.default)(e,[{key:"_initialize",value:function(){this.sourceId=this.sourceId||this.id}},{key:"getBounds",value:function(){return this._bounds}},{key:"setBounds",value:function(t){return t instanceof g.default?(this._bounds=t,this._resetData(),this):(new y.BaseTypeError("bounds","LatLngBounds",t).error(),this)}},{key:"_updateMediaSource",value:function(t){this._mediaSource=t,this._resetData()}},{key:"_resetData",value:function(){this.map&&this.map.getSource(this.id).setData({mediaSource:this._mediaSource,bounds:this._bounds})}},{key:"_addSource",value:function(){this._mediaSource&&this._bounds&&this._mediaSource&&this._bounds&&this.map&&!this.map.getSource(this.sourceId)&&(this.map.addSource(this.sourceId,{type:_.SOURCE_TYPE.ground,tileSize:this.tileSize,data:{mediaSource:this._mediaSource,bounds:this._bounds}}),this._fire("layer",{}))}},{key:"_removeSource",value:function(){this.map&&this.map.removeSource(this.sourceId)}}]),e}(p.default);e.default=x},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){if(L(t)){var e=t.id,n=void 0===e?(0,b.uniqueId)():e,i=t.paths;return t.id=n,k(i)?i.flat(3).every(function(t,e){var n=M(t);return n||new P.ClassTypeError("MaskGeometry.path["+e+"]","LatLng",t).error(),n}):(new P.BaseTypeError("MaskGeometry.paths","Array",i).error(),!1)}return new P.BaseTypeError("MaskGeometry","Object",t).error(),!1}Object.defineProperty(e,"__esModule",{value:!0});var r=n(24),a=i(r),s=n(148),l=i(s),u=n(3),c=i(u),f=n(0),d=i(f),h=n(1),v=i(h),p=n(5),_=i(p),m=n(4),g=i(m),y=n(257),x=i(y),b=n(10),S=n(90),w=n(220),E=n(66),T=n(41),A=i(T),P=n(29),I=n(143),k=A.default.isArray,L=A.default.isObject,M=A.default.isValidLatLng,C=function(t){function e(t){return(0,d.default)(this,e),t.type=E.RENDER_LAYER_TYPE.mask,t.level=I.LAYER_LEVEL.UNDERGROUND,(0,_.default)(this,(e.__proto__||(0,c.default)(e)).call(this,t))}return(0,g.default)(e,t),(0,v.default)(e,[{key:"_initialize",value:function(t){var e=t.geometries,n=void 0===e?[]:e,i=new l.default;this.isMaskReverse=t.isMaskReverse||!1,this.sourceId=this.id,this.maskGeoMap=i,this.add(n)}},{key:"_addSource",value:function(){this.map&&!this.map.getSource(this.sourceId)&&this.map.addSource(this.sourceId,{type:S.SOURCE_TYPE.geojson,data:{type:w.GEOMETRY_TYPES.MASK,geometries:[].concat((0,a.default)(this.maskGeoMap.values()))}})}},{key:"_removeSource",value:function(){this.map&&this.map.removeSource(this.sourceId)}},{key:"add",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return k(e)?(e.forEach(function(e){if(o(e)){var n=e.id;t.maskGeoMap.has(n)?console.warn("MaskLayer.add: 已存在id为"+n+"的MaskGeometry对象。"):t.maskGeoMap.set(n,e)}}),this._updateData(),this):(new P.BaseTypeError("MaskLayer.add()传入参数","Array",e).error(),this)}},{key:"get",value:function(t){return this.maskGeoMap.get(t)}},{key:"getAll",value:function(){return[].concat((0,a.default)(this.maskGeoMap.values()))}},{key:"remove",value:function(t){if(!k(t))return new P.BaseTypeError("MaskLayer.remove()传入参数","Array",t).error(),this;var e=this.maskGeoMap;return t.forEach(function(t){e.has(t)?e.delete(t):console.warn("MaskLayer.remove: 不存在id为"+t+"的MaskGeometry对象。")}),this._updateData(),this}},{key:"clear",value:function(){return this.maskGeoMap.clear(),this._updateData(),this}},{key:"update",value:function(t){if(!k(t))return new P.BaseTypeError("MaskLayer.update()传入参数","Array",t).error(),this;var e=this.maskGeoMap;return t.forEach(function(t){o(t)&&e.set(t.id,t)}),this._updateData(),this}},{key:"_updateData",value:function(){this.map&&this.map.getSource(this.sourceId).setData({type:w.GEOMETRY_TYPES.MASK,geometries:[].concat((0,a.default)(this.maskGeoMap.values()))})}}]),e}(x.default);e.default=C},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var n=Array.isArray(e.features)?e.features:_.DEFAULT_BASEMAP.vector.features,i=[];if(n.includes(p.BASE_LAYER_TYPE.base)){var o=new d.default({map:t,id:_.VECTOR_LAYER_ID.base,features:[{type:p.BASE_LAYER_TYPE.base,filter:p.BASE_LAYER_TYPE.base},{type:p.BASE_LAYER_TYPE.ground,filter:p.BASE_LAYER_TYPE.ground}]});t.moveLayer(o.id,y.LAYER_LEVEL.BASE),i.push(o)}if(n.includes(p.BASE_LAYER_TYPE.arrow)){var r=new d.default({map:t,id:p.BASE_LAYER_TYPE.arrow,features:[{type:p.BASE_LAYER_TYPE.arrow,filter:p.BASE_LAYER_TYPE.arrow}]});r.setRank((0,y.getRank)(y.LAYER_LEVEL.GROUND)-1),i.push(r)}var a=n.includes(p.BASE_LAYER_TYPE.building3d)||n.includes("building"),s=n.includes(p.BASE_LAYER_TYPE.building2d);if(a||s){var l=new d.default({map:t,id:_.VECTOR_LAYER_ID.building,zIndex:1,features:[a?{type:p.BASE_LAYER_TYPE.building3d,filter:p.BASE_LAYER_TYPE.building3d}:{type:p.BASE_LAYER_TYPE.building2d,filter:p.BASE_LAYER_TYPE.building3d}]});t.moveLayer(l.id,y.LAYER_LEVEL.BUILDING),i.push(l)}var u=n.includes(p.BASE_LAYER_TYPE.point),c=n.includes(p.BASE_LAYER_TYPE.label);if(u||c){var f=new d.default({map:t,id:_.VECTOR_LAYER_ID.poi,features:[u?{type:p.BASE_LAYER_TYPE.point,filter:p.BASE_LAYER_TYPE.point}:null,c?{type:p.BASE_LAYER_TYPE.label,filter:p.BASE_LAYER_TYPE.label}:null,{type:p.BASE_LAYER_TYPE.text,filter:p.BASE_LAYER_TYPE.text}].filter(function(t){return!!t})});t.moveLayer(f.id,y.LAYER_LEVEL.TEXT),i.push(f)}return i}function r(t){var e=new v.default({map:t,id:_.DEFAULT_BASEMAP.handdraw.type,getTileUrl:function(t,e,n){e=Math.pow(2,n)-1-e;var i=g.default.handdrawSrc;return i[(t+e)%i.length]+"?z="+n+"&x="+t+"&y="+e+"&version="+g.default.dataVersion.scenic},maxDataZoom:20});return e.setZIndex(2),t.moveLayer(e.getId(),y.LAYER_LEVEL.BUILDING),e}function a(t){var e=t.map,n=t.tilesrc,i=t.encrypt,o=t.key;window.onbeforeunload=function(){var t=e.getSource(_.DEFAULT_BASEMAP.oversea.type),n=t&&t.overseaNum;(0,S.os)(o,n),t&&(t.overseaNum=0)};var r=function(){return 1===this.layerResource.getFinalUsedMapStyleId()?1:0}.bind(e);return new v.default({map:e,id:_.DEFAULT_BASEMAP.oversea.type,maxDataZoom:18,getTileUrl:function(t,e,a){var s=["z="+a,"x="+t,"y="+e,"styleid="+n.style,"scene="+r(),"version="+n.version,"size=256","ch=zh"],l=s.join("&"),u=i(l);return n.url+"&key="+o+"&param="+u}})}function s(t,e){var n=Array.isArray(e.features)?e.features:_.DEFAULT_BASEMAP.satellite.features,i=[];if(n.includes(_.SATELLITE_FEATURE.satellite)){var o=new v.default({map:t,id:_.SATELLITE_LAYER_ID[_.SATELLITE_FEATURE.satellite],getTileUrl:function(t,e,n){e=Math.pow(2,n)-1-e;var i=g.default.satelliteSrc;return i[(t+e)%i.length]+"/"+n+"/"+(t>>4)+"/"+(e>>4)+"/"+t+"_"+e+".jpg?version="+g.default.dataVersion.sat},maxDataZoom:18});t.moveLayer(o.id,y.LAYER_LEVEL.BASE),i.push(o)}if(n.includes(_.SATELLITE_FEATURE.road)){var r=new v.default({map:t,id:_.SATELLITE_LAYER_ID[_.SATELLITE_FEATURE.road],getTileUrl:function(t,e,n){e=Math.pow(2,n)-e-1;var i=g.default.roadSrc;return i[(t+e)%i.length]+"?z="+n+"&x="+t+"&y="+e+"&styleid=2&scene=0&version="+g.default.dataVersion.tile},maxDataZoom:18});t.moveLayer(r.id,y.LAYER_LEVEL.BASE),i.push(r)}return i}function l(t,e){var n=Array.isArray(e.features)?e.features:_.DEFAULT_BASEMAP.traffic.features,i=e.opacity,o=e.flowColor,r=e.flowSpeed,a=[],s=e.filter;if(e&&!e.hasOwnProperty("filter")&&(s=(0,c.default)(_.TRAFFIC_ROAD_TYPE)),n.includes(_.TRAFFIC_FEATURE.base)){var l=new b.default({map:t,id:_.TRAFFIC_LAYER_ID[_.TRAFFIC_FEATURE.base],type:p.RENDER_LAYER_TYPE.trafficBase,maxDataZoom:18,filter:s,opacity:i});t.moveLayer(l.id,y.LAYER_LEVEL.BASE),a.push(l)}if(n.includes(_.TRAFFIC_FEATURE.flow)){var u=new b.default({map:t,id:_.TRAFFIC_LAYER_ID[_.TRAFFIC_FEATURE.flow],type:p.RENDER_LAYER_TYPE.trafficFlow,maxDataZoom:18,filter:s,flowColor:o,flowSpeed:r});t.moveLayer(u.id,y.LAYER_LEVEL.BASE),a.push(u)}return a.forEach(function(e){var n=t.getSource(e.sourceId);e._interval=setInterval(function(){n.isFrozen||(n.reload(),n.once("tilesloaded",function(){if(e.type===p.RENDER_LAYER_TYPE.trafficFlow){t.renderEngine.getImageCache(e.id).clear()}else{t.renderEngine.painters.trafficBase.clearStore()}}))},6e4),e.once("source_removed",function(){clearInterval(e._interval),delete e._interval})}),a}Object.defineProperty(e,"__esModule",{value:!0}),e.createOverseaLayer=e.createHanddrawLayer=e.createTrafficLayer=e.createSatelliteLayer=e.createVectorLayer=void 0;var u=n(17),c=i(u),f=n(383),d=i(f),h=n(299),v=i(h),p=n(66),_=n(281),m=n(23),g=i(m),y=n(143),x=n(667),b=i(x),S=n(43);e.createVectorLayer=o,e.createSatelliteLayer=s,e.createTrafficLayer=l,e.createHanddrawLayer=r,e.createOverseaLayer=a},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(221),r=i(o),a=n(25),s=i(a),l=n(16),u=i(l),c=n(3),f=i(c),d=n(0),h=i(d),v=n(1),p=i(v),_=n(5),m=i(_),g=n(4),y=i(g),x=n(249),b=i(x),S=n(670),w=i(S),E=n(28),T=i(E),A=n(23),P=i(A),I=n(10),k=n(671),L=i(k),M=T.default.isPC()?800:200,C=function(t){function e(t,n,i){(0,h.default)(this,e);var o=(0,m.default)(this,(e.__proto__||(0,f.default)(e)).call(this,t,n,i)),r=n.tileSize,a=void 0===r?P.default.tileSize:r,s=n.minZoom,l=void 0===s?P.default.minZoom:s,c=n.maxZoom,d=void 0===c?P.default.maxZoom:c,v=n.isPixelGeo,p=void 0!==v&&v,_=n.tileManager,g=n.data;return(0,u.default)(o,{tileSize:a,minZoom:l,maxZoom:d,isPixelGeo:p}),o._items={},o._data=g,o.tileManager=_||new L.default({add:o.addTile.bind(o),remove:o.removeTile.bind(o),show:o.showTile.bind(o),minZoom:l,maxZoom:d}),o}return(0,y.default)(e,t),(0,p.default)(e,[{key:"getDrawItems",value:function(){return this._items}},{key:"onCacheRemove",value:function(t){this.unloadTile(t)}},{key:"onUpdate",value:function(t,e,n){this.updateCacheSize(t),this.tileManager.update(t.zoom,t,{reason:n})}},{key:"updateCacheSize",value:function(t){var e=Math.ceil(t.width/this.tileSize)+1,n=Math.ceil(t.height/this.tileSize)+1,i=e*n,o=Math.floor(5*i),r=Math.max(M,o);this.cache.setMaxSize(r)}},{key:"onClear",value:function(){this.clearTiles()}},{key:"clearTiles",value:function(){this.tileManager.clear()}},{key:"onReload",value:function(){var t=this;(0,I.forIn)(this._items,function(e,n){t.reloadTile(n)})}},{key:"addTile",value:function(t,e){var n=this.cache.get(t.id);if(n)return n.hide(),this._items[t.id]=n,s.default.resolve();n=new b.default(t,this.tileSize),n.hide(),this._items[t.id]=n,n.state=x.TILE_STATE.loading;var i=this.loadTile(n,e);return i.then(this._tileLoaded.bind(this,n)),i}},{key:"removeTile",value:function(t){var e=t.id,n=this._items[e];if(n)if(delete this._items[e],n.isLoading())n.aborted=!0,n.state=x.TILE_STATE.unloaded,this.abortTile(n);else if(n.hasData()){var i=n.coord.id;this.cache.add(i,n)}}},{key:"showTile",value:function(t){var e=this._items[t.id];e&&!e.visible&&(e.show(),this._fire("data",{dataType:"source",tile:e}))}},{key:"reloadTile",value:function(t){var e=this;t.isLoading()||(t.state=x.TILE_STATE.reloading,this.loadTile(t,{}).then(function(n){e._fire("data",{dataType:"source",tile:t}),e._tileLoaded.call(e,t,n)}))}},{key:"loadTile",value:function(){}},{key:"unloadTile",value:function(t){t.unloadData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type},null,t.workerID)}},{key:"abortTile",value:function(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type},null,t.workerID)}},{key:"_tileLoaded",value:function(t,e){e&&(t.state=x.TILE_STATE.loaded,404!==e.status&&this._fire("loaderror",{tile:t,error:e})),(0,r.default)(this._items).every(function(t){return t.isLoaded()})&&this._fire("tilesloaded",{dataType:"source",tiles:this._items})}}]),e}(w.default);e.default=C},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(106),p=n(23),_=function(t){function e(t,n,i){(0,s.default)(this,e);var o=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this));return o.id=t,o.dispatcher=i,o.minZoom=n.minZoom||p.minZoom,o.maxZoom=n.maxZoom||p.maxZoom,o.maxDataZoom=n.maxDataZoom||p.maxDataZoom,o._items={},o}return(0,h.default)(e,t),(0,u.default)(e,[{key:"getDrawItems",value:function(){return this._items}},{key:"clear",value:function(){}},{key:"freeze",value:function(){this.isFrozen=!0}},{key:"unfreeze",value:function(){this.isFrozen=!1}},{key:"onAdd",value:function(t){this.map=t}},{key:"onRemove",value:function(){this.map=null}},{key:"update",value:function(t,e){this.transform=t,this.camera=e}}]),e}(v);e.default=_},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(113),r=i(o),a=n(3),s=i(a),l=n(0),u=i(l),c=n(1),f=i(c),d=n(5),h=i(d),v=n(4),p=i(v),_=n(249),m=i(_),g=n(492),y=i(g),x=n(300),b=i(x),S=n(10),w=n(23),E=function(t){function e(t,n,i){(0,u.default)(this,e);var o=(0,h.default)(this,(e.__proto__||(0,s.default)(e)).call(this,t,n,i));return o._metaData=null,o._initialize(),o.workerOptions=S.extend({source:o.getUniqueId(),tileSize:o.tileSize},n.workerOptions),o}return(0,p.default)(e,t),(0,f.default)(e,[{key:"_initialize",value:function(){}},{key:"load",value:function(){var t=this;this._loadOriginData(function(){t._fire("data",{dataType:"source",sourceDataType:"metadata"})})}},{key:"onAdd",value:function(t){this.map=t,this.load()}},{key:"getMetaData",value:function(){return this._metaData}},{key:"update",value:function(t){this.transform=t;var e=new b.default(0,0,0,0);this.addItem(e)}},{key:"addItem",value:function(t){this.addTile(t,null,null)}},{key:"_loadOriginData",value:function(t){var e=this;this._fire("dataloading",{dataType:"source"}),this._updateWorkerData(function(){e.reload(),e.transform&&e.update(e.transform),t&&t()})}},{key:"_updateWorkerData",value:function(t){var e=this,n=S.extend({},this.workerOptions),i=this._data;n.data=(0,r.default)(i),this._onLoadDataStart(i),this.workerID=this.dispatcher.send(this.type+".loadData",n,function(n,i){n?(e._onLoadDataError(n),t(n)):(e._loaded=!0,e._metaData=i,e._onLoadDataEnd(),t(null))},this.workerID)}},{key:"_onLoadDataStart",value:function(){}},{key:"_onLoadDataEnd",value:function(){}},{key:"_onLoadDataError",value:function(t){this._fire("error",{error:t})}},{key:"addTile",value:function(t,e,n){var i=this._items[t.id];return i||((i=this._cache.get(t.id))?(this._items[t.id]=i,i):(i=new m.default(t,this.tileSize),this._items[t.id]=i,t.z<=w.maxDataZoom&&this.loadTile(i,e,n?n.bind(this):this._tileLoaded.bind(this,i)),i))}},{key:"loadTile",value:function(t,e,n){var i={type:this.type,uid:t.uid,coord:t.coord,zoom:t.coord.z,maxZoom:this.maxZoom,tileSize:this.tileSize,source:this.getUniqueId()};t.workerID=this.dispatcher.send("loadTile",i,function(e,i){if(t.clear(),!t.aborted)return e||!i?void(t.state=_.TILE_STATE.loaded):(t.setData(i),n(null))},this.workerID)}},{key:"abortTile",value:function(t){t.aborted=!0}},{key:"unloadTile",value:function(t){t.clear(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.getUniqueId()},function(){},t.workerID)}},{key:"onRemove",value:function(){this.dispatcher.broadcast("removeSource",{type:this.type,source:this.getUniqueId()},function(){}),this.map=null,this._metaData=null}}]),e}(y.default);e.default=E},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(20),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(79),f=function(){function t(e,n,i){(0,s.default)(this,t),i&&(this.loadGeoJSON=i),this._geoDataIndexes={},this.actor=e}return(0,u.default)(t,[{key:"loadVectorData",value:function(t,e){var n=t.source;if(!this._geoDataIndexes[n])return e(null,null);var i=this._geoDataIndexes[n];if(!i)return e(null,null);e(null,i)}},{key:"loadData",value:function(t,e){var n=function(n,i){var o=this;return n?e(n):"object"!==(void 0===i?"undefined":(0,r.default)(i))?e(new Error("Input data is not a valid GeoJSON object.")):void this._indexData(t,i,function(n,i){if(n)return e(n);o._geoDataIndexes[t.source]=i,e(null)})}.bind(this);this.loadGeoJSON(t,n)}},{key:"loadGeoJSON",value:function(t,e){if(t.url)c.getJSON(t.url,e);else{if("string"!=typeof t.data)return e(new Error("Input data is not a valid GeoJSON object."));try{return e(null,JSON.parse(t.data))}catch(t){return e(new Error("Input data is not a valid GeoJSON object."))}}}},{key:"removeSource",value:function(t){this._geoDataIndexes[t.source]&&delete this._geoDataIndexes[t.source]}},{key:"_indexData",value:function(){}}]),t}();e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(249),p=n(384),_=i(p),m=n(489),g=i(m),y=n(28),x=i(y),b=n(10),S=function(t){function e(t,n,i){(0,s.default)(this,e);var o=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t,n,i));return o.tileSize=n.tileSize||256,o._isPixelGeo=n.isPixelGeo||!1,o._data=n.data,o._cache=new _.default(0,o.unloadTile.bind(o)),o._maxTileCacheSize=x.default.isPC()?800:200,o._on("error",function(){o._sourceErrored=!0}),o}return(0,h.default)(e,t),(0,u.default)(e,[{key:"getUniqueId",value:function(){return this._uniqueId||(this._uniqueId=(this.map&&this.map.id||b.uniqueId())+"_"+this.id),this._uniqueId}},{key:"addTile",value:function(){}},{key:"loadTile",value:function(){}},{key:"unloadTile",value:function(){}},{key:"abortTile",value:function(){}},{key:"reload",value:function(){var t=this;this._cache.reset(),b.forIn(this._items,function(e,n){t.reloadTile(n)})}},{key:"reloadTile",value:function(t){t.state!==v.TILE_STATE.loading&&(t.state=v.TILE_STATE.reloading,this.loadTile(t,{},this._tileLoaded.bind(this,t)))}},{key:"removeTile",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this._items[t];if(n)if(delete this._items[t],n.hasData()){var i=n.coord.id;!e&&this._cache.add(i,n)}else n.aborted=!0,this.abortTile(n),this.unloadTile(n)}},{key:"clear",value:function(){this.clearTiles(),this._cache.reset()}},{key:"clearTiles",value:function(){var t=this;b.forIn(this._items,function(e){t.removeTile(e)})}},{key:"_tileLoaded",value:function(){}},{key:"getDrawItems",value:function(){return this._items}},{key:"onAdd",value:function(t){this.map=t}},{key:"onRemove",value:function(){this.map=null}},{key:"updateCacheSize",value:function(t){var e=Math.ceil(t.width/this.tileSize)+1,n=Math.ceil(t.height/this.tileSize)+1,i=e*n,o=Math.floor(5*i);if(x.default.isPC()){var r="number"==typeof this._maxTileCacheSize?Math.max(this._maxTileCacheSize,o):o;this._cache.setMaxSize(r)}else this._cache.setMaxSize(o)}},{key:"update",value:function(){}}]),e}(g.default);e.default=S},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(490),p=i(v),_=n(90),m=n(249),g=function(t){function e(t,n,i){(0,s.default)(this,e);var o=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t,n,i));return o.on("data",function(){o.hasGeoChanged_inLoading=!0}),o}return(0,h.default)(e,t),(0,u.default)(e,[{key:"_initialize",value:function(){this.type=_.SOURCE_TYPE.geojson}},{key:"setData",value:function(t){var e=this;return this._data=t,this._loadOriginData(function(){e._fire("data",{dataType:"source",sourceDataType:"content"})}),this}},{key:"reloadTile",value:function(t){var e=this;t.state!==m.TILE_STATE.loading?(t.state=m.TILE_STATE.reloading,this.hasGeoChanged_inLoading=!1,this.updateTileCallback?(this.updateTileCallback(),this.updateTileCallback=null):this.loadTile(t,{},this._tileLoaded.bind(this,t))):(this.hasGeoChanged_inLoading&&(this.updateTileCallback=function(){e.loadTile(t,{},function(){e._tileLoaded.bind(e,t),e._fire("data",{dataType:"source"}),e.hasGeoChanged_inLoading=!1})}),t.state=m.TILE_STATE.reloading)}},{key:"updateIndoorData",value:function(t,e){var n=this;arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(t=this.indoorOption);var i=this._data.geometries,o=this._data.type,r=0;i.forEach(function(i,a){var s=0;if("POLYLINE"===o&&(i.paths&&i.paths.forEach(function(t){s+=t.length||1}),s=s-1>0?s-1:0),!i.floorName||!i.buildingId)return void(r+=s);var l=1;l=t?t.floorName===i.floorName&&t.buildingId===i.buildingId?1:0:e?1:0;var u=n._items["0_0_0"];if("POINT"===o)u._data["0_0_0"].instancePixelOffsetList[3*a+2]=l,u._data["0_0_0"].uid=(new Date).getTime();else if("POLYLINE"===o){for(var c=r;c<r+s;c++)u._data["0_0_0"].instanceColorList[4*c+3]=255*l,u._data["0_0_0"].instanceBorderColorList[4*c+3]=255*l;r+=s,u._data["0_0_0"].uid=(new Date).getTime()}}),this.indoorOption=t}},{key:"_tileLoaded",value:function(){this.updateIndoorData&&this.updateIndoorData(null,!1,!0),this._fire("data_loaded")}},{key:"setStyle",value:function(t){var e=this;return this._data.styles=t,this._loadOriginData(function(){e._fire("data",{dataType:"source",sourceDataType:"content"})}),this}}]),e}(p.default);e.default=g},function(t,e,n){"use strict";function i(t){return 64===f.indexOf(t.charAt(t.length-1))?t.substring(0,t.length-1):t}function o(t){if(!t)return null;t=i(t),t=i(t);var e=parseInt(t.length/4*3,10),n=[];t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");var o=void 0,r=void 0,a=void 0,s=void 0,l=void 0,u=void 0,c=void 0,d=0,h=0;for(d=0;d<e;d+=3)s=f.indexOf(t.charAt(h)),h+=1,l=f.indexOf(t.charAt(h)),h+=1,u=f.indexOf(t.charAt(h)),h+=1,c=f.indexOf(t.charAt(h)),h+=1,o=s<<2|l>>4,r=(15&l)<<4|u>>2,a=(3&u)<<6|c,n.push(o),64!==u&&n.push(r),64!==c&&n.push(a);return n}function r(t,e){return t>>8-e&255|t<<e&255}function a(t){return r(t,2)^r(t,1)&r(t,3)}function s(t,e){return{x:e,y:t^a(e)}}function l(t){for(var e=t.length,n=[],i=0;i<e;i+=2){var o=t[i],r=0;i+1<e&&(r=t[i+1]);for(var a=0,l=0,u=0;u<3;u++){var c=s(o,r);a=c.x,o=a,l=c.y,r=l}n.push(a),n.push(l)}return n}function u(t){for(var e="",n=0;n<t.length;){var i=t[n],o=0,r=0;i<128?(e+=String.fromCharCode(i),n+=1):i>191&&i<224?(o=t[n+1],e+=String.fromCharCode((31&i)<<6|63&o),n+=2):(o=t[n+1],r=t[n+2],e+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&r),n+=3)}return e}function c(t){var e=t.lastIndexOf("}");return t.substring(0,e+1)}var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.decode=function(t){return c(u(l(o(t))))}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var n=t[t.length-1];return e===O.BASE_LAYER_TYPE.region?t.cidx+String(1e5*(n>>16&65535)):t.cidx+String(1e5*(n>>16&65535)+(65535&n))}function r(t,e){var n=void 0;return H.forIn(t,function(t,i){i.minScaleVal<=e&&i.maxScaleVal>=e&&(n=i)}),n}function a(t,e){if(e){for(var n=t[1],i=e.transX,o=e.transY,r=e.scale,a=0;a<n.length;a+=2)n[a]=(n[a]+i)*r,n[a+1]=(n[a+1]+o)*r;t[0]===J&&(t[2]=t[2]*r)}}function s(t,e){var n=e.enc,i=e.imgUploadHook,o=e.childIdx,r=void 0===o?0:o;if(t instanceof Array){var l=-1,u=[],c=[],f=[],d=[];return t.forEach(function(t,e){var i=s(t,{enc:n,childIdx:e});0===i.ret&&(l=0),u.push(i.img),c.push(i.ext_img),f=f.concat(i.features||[]),d=d.concat(i.pois||[])}),i&&(u.length||c.length)&&i(u,c),{ret:l,img:u,ext_img:c,features:f,pois:d}}if(!t.data)return{};var h=n?t:Z(Y(t.data));if(0!==h.ret)return{};i&&i(h.img,h.ext_img);var v=j(U(h.features))||[],p=j(U(h.pois))||[];return v.unshift([$,[0,0,256,0,256,256,0,256],"",0]),v.forEach(function(e){e[0]instanceof Array?e.forEach(function(e){a(e,t.tileTransform)}):a(e,t.tileTransform),e.cidx=r,e.transform=t.tileTransform||{}}),p.forEach(function(e){e[0]instanceof Array?e.forEach(function(e){a(e,t.tileTransform)}):a(e,t.tileTransform),e.cidx=r,e.transform=t.tileTransform||{}}),h.features=v,h.pois=p,h}var l=n(82),u=i(l),c=n(27),f=i(c),d=n(221),h=i(d),v=n(32),p=i(v),_=n(113),m=i(_),g=n(25),y=i(g),x=n(24),b=i(x),S=n(17),w=i(S),E=n(0),T=i(E),A=n(1),P=i(A),I=n(652),k=i(I),L=n(653),M=i(L),C=n(654),R=i(C),B=n(381),N=i(B),O=n(66),D=n(301),z=n(23),F=i(z),V=n(240),Y=n(494).decode,U=n(693).restores,j=n(692).merge,G=n(10),Z=G.parseJson,H=n(10),W=n(497),X=W.getVectorStyle,Q=n(10),q=Q.uniqueId,K={65536:O.BASE_LAYER_TYPE.point,131072:O.BASE_LAYER_TYPE.line,196608:O.BASE_LAYER_TYPE.region,262144:O.BASE_LAYER_TYPE.label,327680:O.BASE_LAYER_TYPE.arrow},J=196619,$=196613,tt=function(){function t(e){(0,T.default)(this,t),this.uid=e.uid,this.coord=e.coord,this.dataZoom=e.coord.z,this._needUploadTileImage=!1,this._billboardFeatures=[];var n=e.styleId;this.styleId=n,this.parse=(0,D.isDefaultStyle)(n)?this.parseForDefaultStyle.bind(this):this.parseForCustomStyle.bind(this)}return(0,P.default)(t,[{key:"parseForCustomStyle",value:function(t,e,n,i,o,r,a){function s(t){if(t){var e=t;return t.children&&(0,w.default)(t.children).length>0&&H.forIn(t.children,function(t,n){e=[].concat((0,b.default)(e),(0,b.default)(n))}),e}}function l(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getOriginalGroundFeatures(v.features,e,!0),o=(0,k.default)(i.ranks,t);E[e]=i,n&&h[O.BASE_LAYER_TYPE.base][t]?(!h[O.BASE_LAYER_TYPE.base][t].children&&(h[O.BASE_LAYER_TYPE.base][t].children={}),h[O.BASE_LAYER_TYPE.base][t].children[e]=o):(h[O.BASE_LAYER_TYPE.base]={},h[O.BASE_LAYER_TYPE.base][t]=o)}function u(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n){var o=(0,M.default)(n.buildings,t),r=(0,k.default)(n.ranksSide,t),a=this.parseInstanceArrow(h.arrow,t);i?(!h[O.BASE_LAYER_TYPE.building3d][t].children&&(h[O.BASE_LAYER_TYPE.building3d][t].children={}),h[O.BASE_LAYER_TYPE.building3d][t].children[e]={buildings:o,buildSideShapes:r},a&&(h[O.BASE_LAYER_TYPE.arrow][t].children[e]=h.arrow[t].slice()||[],h[O.BASE_LAYER_TYPE.arrow][t].children[e].instance=a)):(h[O.BASE_LAYER_TYPE.building3d]={},h[O.BASE_LAYER_TYPE.building3d][t]={},h[O.BASE_LAYER_TYPE.building3d][t].buildings=o,h[O.BASE_LAYER_TYPE.building3d][t].buildSideShapes=r,a&&(h[O.BASE_LAYER_TYPE.arrow]=h.arrow||{},h[O.BASE_LAYER_TYPE.arrow][t]=h.arrow[t]||[],h[O.BASE_LAYER_TYPE.arrow][t].instance=a))}}var c=this,f=this.coord.id,d=this.parseOriginData(t,e,n,i,null,a),h=d.layerstiles,v=d.jsonData;if(!h||!v)return void r(null,null);var _=s(h.point&&h.point[f]),g=s(h.label&&h.label[f]),x=[];_&&_.forEach(function(t){t&&t.datas&&t.datas[0].textName&&t.datas[0].textName.split("").forEach(function(e){x.findIndex(function(n){return n.text===e&&n.font_weight===t.datas[0].font_weight})<0&&x.push({text:e,font_weight:t.datas[0].font_weight})})}),g&&g.forEach(function(t){t&&t.roadName&&t.roadName.split("").forEach(function(e){x.findIndex(function(n){return n.text===e&&n.font_weight===t.roads[0].datas[0].font_weight})<0&&x.push({text:e,font_weight:t.roads[0].datas[0].font_weight})})});var S={},E={};if(l.call(this,f,this.dataZoom),this.dataZoom===F.default.maxDataZoom)for(var T=F.default.maxDataZoom+1;T<=F.default.maxZoom;T++)l.call(this,f,T,!0);if(S.base=h.base,delete h.base,S=this.transferData(f,S,"base",this.dataZoom),S.id=f,r(null,S),u.call(this,f,this.dataZoom,E[this.dataZoom]),this.dataZoom===F.default.maxDataZoom)for(var A=F.default.maxDataZoom+1;A<=F.default.maxZoom;A++)u.call(this,f,A,E[A],!0);new y.default(function(t){var e="";c._needUploadTileImage&&v.img&&(e={tileImage64:v.img,tileId:f,billboardData:(0,m.default)(c._billboardFeatures)}),o.send("uploadTileTexture",{zoom:c.coord.z,uid:c.uid,billboard:e,glyphs:x},function(e,n){if(e)console.error(e),t([{},{}]);else{var i=JSON.parse(n.billboardMapping),o=JSON.parse(n.glyphMapping[0]),r=JSON.parse(n.glyphMapping[1]);t([i,o,r])}})}).then(function(t){function e(t,e){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){var i=h.point[t].children&&h.point[t].children[e],o=h.label[t].children&&h.label[t].children[e],r={point:{},label:{}};r.point[t]=i,r.label[t]=o;var u=this.parseInstancePoint(r,t,n,{glyphMapping:s,glyphMappingBold:l,billboardMapping:a});i&&(h[O.BASE_LAYER_TYPE.point][t].children[e].instance=u),o&&(h[O.BASE_LAYER_TYPE.label][t].children[e].instance=u)}else{var c=this.parseInstancePoint(h,t,n,{glyphMapping:s,glyphMappingBold:l,billboardMapping:a});h[O.BASE_LAYER_TYPE.point]=h.point||{},h[O.BASE_LAYER_TYPE.point][t]=h.point[t]||[],h[O.BASE_LAYER_TYPE.point][t].instance=c,h[O.BASE_LAYER_TYPE.label]=h.label||{},h[O.BASE_LAYER_TYPE.label][t]=h.label[t]||[],h[O.BASE_LAYER_TYPE.label][t].instance=c}}var o=(0,p.default)(t,3),a=o[0],s=o[1],l=o[2];if(e.call(c,f,c.dataZoom),c.dataZoom===F.default.maxDataZoom)for(var u=F.default.maxDataZoom+1;u<=F.default.maxZoom;u++)e.call(c,f,u,!0);h=c.transferData(f,h,"increment"),h.id=f,h.styleId=i.styleId,r(null,h)})}},{key:"transferData",value:function(t,e,n){var i=[];return(0,w.default)(e).forEach(function(n){if(n===O.BASE_LAYER_TYPE.base){var o=e[n]&&e[n][t];if(!o)return;e[n][t]={id:t,children:o.children||null,indeices:{arrayBuffer:o.indeices.dataView,length:o.indeices.length},lineCount:o.lineCount,size:o.size,vertices:{arrayBuffer:o.vertices.dataView,attributes:o.vertices.attributes,bytesPerElement:o.vertices.bytesPerElement},vertiesCount:o.vertiesCount}}else if(n===O.BASE_LAYER_TYPE.region)delete e[O.BASE_LAYER_TYPE.region];else if(n===O.BASE_LAYER_TYPE.line)delete e[O.BASE_LAYER_TYPE.line];else if(n===O.BASE_LAYER_TYPE.building3d){var r=e[n]&&e[n][t]&&e[n][t].buildings;if(!r)return;e[n][t].buildings={id:t,children:r.children||null,indeices:{arrayBuffer:r.indeices.dataView,length:r.indeices.length},size:r.size,vertices:{arrayBuffer:r.vertices.dataView,attributes:r.vertices.attributes,bytesPerElement:r.vertices.bytesPerElement}};var a=e[n]&&e[n][t].buildSideShapes;if(!a)return;e[n][t].buildSideShapes={id:t,children:a.children||null,indeices:{arrayBuffer:a.indeices.dataView,length:a.indeices.length},lineCount:a.lineCount,size:a.size,vertices:{arrayBuffer:a.vertices.dataView,attributes:a.vertices.attributes,bytesPerElement:a.vertices.bytesPerElement},vertiesCount:a.vertiesCount}}else if(n===O.BASE_LAYER_TYPE.arrow){var s=e[O.BASE_LAYER_TYPE.arrow]&&e[O.BASE_LAYER_TYPE.arrow][t];if(!s)return;s.forEach(function(t){t.datas&&t.datas.forEach(function(t){t.coords&&(t.coords=new Int16Array(t.coords),i.push(t.coords.buffer)),t.color_fill&&(t.color_fill=new Uint8ClampedArray(t.color_fill),i.push(t.color_fill.buffer))})})}else if(n===O.BASE_LAYER_TYPE.point){var l=e[O.BASE_LAYER_TYPE.point]&&e[O.BASE_LAYER_TYPE.point][t];if(!l)return;l.forEach(function(t){t.translate&&!i.includes(t.translate.buffer)&&i.push(t.translate.buffer),t.vertices&&!i.includes(t.vertices.buffer)&&i.push(t.vertices.buffer),t.datas&&t.datas.forEach(function(t){t.coords&&(t.coords=new Int16Array(t.coords),i.push(t.coords.buffer)),t.icon_coords&&(t.icon_coords=new Int16Array(t.icon_coords),i.push(t.icon_coords.buffer)),t.text_bounds&&(t.text_bounds=new Int16Array(t.text_bounds),i.push(t.text_bounds.buffer)),t.text&&t.text.forEach(function(t){t.coords&&(t.coords=new Int16Array(t.coords),i.push(t.coords.buffer))}),t.font_color&&(t.font_color=new Uint8ClampedArray(t.font_color),i.push(t.font_color.buffer)),t.background_color&&(t.background_color=new Uint8ClampedArray(t.background_color),i.push(t.background_color.buffer))})});var u=e[O.BASE_LAYER_TYPE.point][t].instance;(0,w.default)(u).forEach(function(t){"count"!==t&&i.push(u[t].buffer)})}else if(n===O.BASE_LAYER_TYPE.label){var c=e[O.BASE_LAYER_TYPE.label]&&e[O.BASE_LAYER_TYPE.label][t];if(!c)return;c.forEach(function(t){t.roads&&t.roads.forEach(function(t){t.datas&&t.datas.forEach(function(t){t.coords&&(t.coords=new Int16Array(t.coords),i.push(t.coords.buffer)),t.text_bounds&&(t.text_bounds=new Int16Array(t.text_bounds),i.push(t.text_bounds.buffer)),t.glyph_text_bounds&&(t.glyph_text_bounds=new Int16Array(t.glyph_text_bounds),i.push(t.glyph_text_bounds.buffer)),t.font_color&&(t.font_color=new Uint8ClampedArray(t.font_color),i.push(t.font_color.buffer)),t.background_color&&(t.background_color=new Uint8ClampedArray(t.background_color),i.push(t.background_color.buffer))})})})}}),"base"===n?(i.push(e[O.BASE_LAYER_TYPE.base][t].vertices.arrayBuffer.buffer),i.push(e[O.BASE_LAYER_TYPE.base][t].indeices.arrayBuffer.buffer),e.baseData=!0):"increment"===n&&(i.push(e[O.BASE_LAYER_TYPE.building3d][t].buildings.vertices.arrayBuffer.buffer),i.push(e[O.BASE_LAYER_TYPE.building3d][t].buildings.indeices.arrayBuffer.buffer),i.push(e[O.BASE_LAYER_TYPE.building3d][t].buildSideShapes.vertices.arrayBuffer.buffer),i.push(e[O.BASE_LAYER_TYPE.building3d][t].buildSideShapes.indeices.arrayBuffer.buffer),e.incrementData=!0),e.transferableList=i,e}},{key:"getOriginalGroundFeatures",value:function(t,e,n){for(var i=e,a={},s={},l=[],u=void 0,c=void 0,f=void 0,d=void 0,v=void 0,_=void 0,m=void 0,g=void 0,y=0,x=t.length;y<x;y++){u=t[y];var b=u,S=(0,p.default)(b,3);if(c=S[0],v=S[1],f=S[2],m=this.mapStyle.layerMeta[c],(g=m?r(m.styles,i):void 0)&&(c===J&&f>0&&l.push({datas:v,h:u[2]*(i>=18?2:1),colorFill:g.color_fill,colorSide:g.color_side,transform:u.transform}),g&&g.color_fill[3])){var w=r(m.styles,i+1),E=r(m.styles,i-1);d=m.name,_=o(u,m.type);var T=void 0;if(m.type!==O.BASE_LAYER_TYPE.region&&m.type!==O.BASE_LAYER_TYPE.line)continue;if(v instanceof Array&&v.length&&"number"==typeof v[0]&&(v=[v]),m.type===O.BASE_LAYER_TYPE.region);else if(m.type===O.BASE_LAYER_TYPE.line){if(0===g.width)continue;T=u[u.length-2]}a[_]=a[_]||{};var A=a[_][d],P={};if(m.type===O.BASE_LAYER_TYPE.line&&"number"==typeof u[2]&&(P.startDistance=u[2]),A)if(A.datas[0]instanceof Array||(A.datas=[A.datas]),v[0]instanceof Array)for(var I=0,k=v.length;I<k;I++)A.datas.push(v[I]);else A.datas.push(v);else a[_][d]={id:this.coord.id+"_"+d,layerId:c,layerName:d,type:m.type,datas:v,style:g,nextStyle:w,preStyle:E,zLevel:T,transform:u.transform,options:P},A=a[_][d]}}return n&&(H.forIn(a,function(t,e){var n=(0,h.default)(e).sort(function(t,e){return t.style.layerseq-e.style.layerseq});H.forIn(n,function(e,i){i.layerId===J&&(s[t]={},s[t][e]=n[e],n.splice(e,1))}),a[t]=n}),H.forIn(s,function(t,e){var n=(0,h.default)(e).sort(function(t,e){return t.style.layerseq-e.style.layerseq});s[t]=n})),{ranks:a,ranksSide:s,buildings:l}}},{key:"parseOriginData",value:function(t,e,n,i,r,a){var l=this;this.status="parsing",this.data=e,this.mapStyle=i;var u=this.coord.id,c={},d={};N.default.setStyleTag(this.mapStyle.styleTag);var h=s(e,{enc:a,imgUploadHook:r});if(0!==h.ret)return{};for(var v=h.features,p=0,_=v.length;p<_;p++){var m=v[p],g=m[0]instanceof Array?m[0][0]:m[0];if(!g)return void console.warn("featureId is not exist",g);var y=983040&g;c[K[y]]?c[K[y]].push(m):(c[K[y]]=[],d[K[y]]={},c[K[y]].push(m))}var x=this.mapStyle.style;return H.forIn(x,function(t,e){function i(e,i){for(var l=[],u={},c=0,_=p.length;c<_;c++){var m=p[c],g=[];if(m[0]instanceof Array)(g=this.parseRoadName(m,a,s,v,i,e,this.coord.tileSize))&&l.push(g);else{var y=m[0],x=X(a,s,v,y,i);if(x){if(r===O.BASE_LAYER_TYPE.point){var b=""+m[2],S=this.parsePoi(m,x,this.coord);if(!S)continue;u[b]=!0,g.push(S)}else if(r===O.BASE_LAYER_TYPE.arrow){var w=this.parseArrow(m,x,this.coord);g.push(w)}else if(m[1][0]instanceof Array){var E=!0,T=!1,A=void 0;try{for(var P,I=(0,f.default)(m[1]);!(E=(P=I.next()).done);E=!0){var k=P.value,L={coords:k};g.push(L)}}catch(t){T=!0,A=t}finally{try{!E&&I.return&&I.return()}finally{if(T)throw A}}}else{var M={coords:m[1]};g.push(M)}var C={type:r,datas:g,id:e+"_"+c,rank:o(m,r)};l.push(C)}}}if(r===O.BASE_LAYER_TYPE.point&&h.pois&&h.pois.length>0&&h.ext_img)for(var B=0,N=h.pois.length;B<N;B++){var D=h.pois[B],z=[],V=""+D[2],Y=D[0],U=X(a,s,v,Y,i);if(U&&!u[V]){var j=this.parsePoi(D,U,this.coord,{isExt:!0});if(j){z.push(j);var G={type:r,datas:z,isExt:!0,id:e+"_ext_"+B,rank:o(D,r)};l.push(G)}}}var Z=void 0;switch(r){case O.BASE_LAYER_TYPE.point:Z=(0,R.default)(l,n);break;default:Z=l}i>F.default.maxDataZoom?(!d[t][e]&&(d[t][e]={}),!d[t][e].children&&(d[t][e].children={}),d[t][e].children[i]=Z):d[t][e]=Z}if(c[t]){var r=e.type,a=e.style,s=e.relyStyle,v=e.relyStyleField,p=c[t],_=l.dataZoom;if(i.call(l,u,_),_===F.default.maxDataZoom)for(var m=F.default.maxDataZoom+1;m<=F.default.maxZoom;m++)i.call(l,""+l.coord.id,m)}}),{layerstiles:d,jsonData:h}}},{key:"parseForDefaultStyle",value:function(t,e,n,i,o,r,a){function s(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getOriginalGroundFeatures(p.features,this.dataZoom,!0),o=(0,k.default)(i.ranks,t);m[e]=i,n&&v[O.BASE_LAYER_TYPE.base][t]?(!v[O.BASE_LAYER_TYPE.base][t].children&&(v[O.BASE_LAYER_TYPE.base][t].children={}),v[O.BASE_LAYER_TYPE.base][t].children[e]=o):(v[O.BASE_LAYER_TYPE.base]={},v[O.BASE_LAYER_TYPE.base][t]=o)}function l(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n){var o=(0,M.default)(n.buildings,t),r=(0,k.default)(n.ranksSide,t),a=this.parseInstanceArrow(v.arrow,t);i?(!v[O.BASE_LAYER_TYPE.building3d][t].children&&(v[O.BASE_LAYER_TYPE.building3d][t].children={}),v[O.BASE_LAYER_TYPE.building3d][t].children[e]={buildings:o,buildSideShapes:r},a&&(v[O.BASE_LAYER_TYPE.arrow][t].children[e]=v.arrow[t].slice()||[],v[O.BASE_LAYER_TYPE.arrow][t].children[e].instance=a)):(v[O.BASE_LAYER_TYPE.building3d]={},v[O.BASE_LAYER_TYPE.building3d][t]={},v[O.BASE_LAYER_TYPE.building3d][t].buildings=o,v[O.BASE_LAYER_TYPE.building3d][t].buildSideShapes=r,a&&(v[O.BASE_LAYER_TYPE.arrow]=v.arrow||{},v[O.BASE_LAYER_TYPE.arrow][t]=v.arrow[t]||[],v[O.BASE_LAYER_TYPE.arrow][t].instance=a))}}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];if(f&&v){var i=this.parseInstancePoint(v,d,n,t);v[O.BASE_LAYER_TYPE.point]=v.point||{},v[O.BASE_LAYER_TYPE.point][d]=v.point[d]||[],v[O.BASE_LAYER_TYPE.point][d].instance=i,v[O.BASE_LAYER_TYPE.label]=v.label||{},v[O.BASE_LAYER_TYPE.label][d]=v.label[d]||[],v[O.BASE_LAYER_TYPE.label][d].instance=i,v=this.transferData(d,v,"increment",e),v.id=d,r(null,v)}}var c=this,f=!1,d=this.coord.id,h=this.parseOriginData(t,e,n,i,function(e,n){e?o.send("uploadTileImage",{zoom:c.coord.z,maxDataZoom:t.maxDataZoom,sourceId:t.sourceId,uid:c.uid,tileId:d,imgBase64:e,extImgBase64:n},function(t,e){e&&(f=!0,u.call(c,e,c.dataZoom))}):f=!0},a),v=h.layerstiles,p=h.jsonData;if(!v||!p)return void r(null,null);var _={},m={};if(s.call(this,d,this.dataZoom),this.dataZoom===F.default.maxDataZoom)for(var g=F.default.maxDataZoom+1;g<=F.default.maxZoom;g++)s.call(this,d,g,!0);if(_.base=v.base,delete v.base,_=this.transferData(d,_,"base",this.dataZoom),_.id=d,r(null,_),l.call(this,d,this.dataZoom,m[this.dataZoom]),this.dataZoom===F.default.maxDataZoom)for(var y=F.default.maxDataZoom+1;y<=F.default.maxZoom;y++)l.call(this,d,y,m[y],!0);u.call(this)}},{key:"parseInstanceArrow",value:function(t,e){if(!t||!t[e])return null;var n=[],i=[],o=[];t[e].forEach(function(t){var e=t.datas[0];i.push(e.width),o.push.apply(o,(0,b.default)(e.color_fill)),n.push.apply(n,(0,b.default)(e.coords))});var r=new Float32Array(n),a=new Float32Array(o);return{instanceCoordsTypeArray:r,instanceWidthTypeArray:new Float32Array(i),instanceColorTypeArray:a,count:n.length/4}}},{key:"parseInstancePoint",value:function(t,e,n,i){var o=this,r=0,a=i.extOffset,s=void 0===a?0:a,l=i.yOffsetList,c=void 0===l?[]:l,f=i.glyphMapping,d=i.billboardMapping,h=i.glyphMappingBold,v=[],_=[],m=[],g=[],y=[],x=[],S=[],w=[],E=[],T=t.point&&t.point[e]||[],A=T.filter(function(t){return t&&t.datas&&t.datas[0]&&t.datas[0].icon_coords})||[],P=[];t.label&&t.label[e]&&t.label[e].forEach(function(t){P=P.concat(t.roads)}),A.forEach(function(t){var e=n.scale,i=n.info,o=t.datas[0];if(o&&o.icon&&o.icon_coords){var a=i[String(o.icon)];if(!a)return;var s=a.width/e/2,l=a.height/e/2,c=o.icon_coords[0],d=-o.icon_coords[1];if(v.push(c,d,0),m.push(a.left,a.bottom,a.right-a.left,a.top-a.bottom),o.stretching_len){for(var p=o.text,b=0,T=0,A=0,P=p.length;A<P;A++)!function(t,e){var n=p[t],i=n.text.length,r=[0],a=0;(0,u.default)(n.text).forEach(function(t){var e="normal"===o.font_weight?f[t]:h[t],n=o.font_size/e.fontSize;r.push(r[r.length-1]+e.width*n),a=Math.max(a,e.height*n)});var s=r[i],l=a;T=T>s?T:s,b+=l}(A);_.push(2*s,2*l,s,l),o.screenW=o.stretching_len[0]+T,o.screenH=o.stretching_len[1]+b;var I=(o.stretching_len[0]+T)/(2*s),k=(o.stretching_len[1]+b)/(2*l);g.push(I,k)}else _.push(2*s,2*l,s,l),g.push(1,1);y.push(0,1,1,1),x.push(1,1,1,1),w.push(0,0,0,0),S.push(0,0,0,0),E.push(0),t.iconSymbolIndex=r,r+=1}}),T.forEach(function(t){var e=t.datas[0];if(e.coords.length)for(var i=e.text,a=e.text_bounds,l=void 0,d=e.cidx||0,T=0,A=i.length;T<A;T++){l=2===A?a.slice(4*(1-T),4*(1-T)+4):a.slice(4*T,4*T+4);var P=0;if(P=t.isExt?c[d+s]||0:c[d]||0,l[1]+=P,!(l[2]<10||l[3]<10||0===l.length)){var I=i[T],k=(0,p.default)(I.coords,2),L=k[0],M=k[1],C=I.centerOffset,R=l[2]/n.scale,B=l[3]/n.scale,N={x:R/2,y:B/2};C&&(N={x:R/2-C.x,y:B/2-C.y}),(0,D.isDefaultStyle)(o.styleId)?(v.push(L,-M,0),_.push(R,B,N.x,N.y),m.push.apply(m,(0,b.default)(l)),y.push(0,1,0,1),I.textSymbolIndexList=[r],r+=1):"center"===e.text_align&&function(){var t=new Uint16Array(I.text.length),n=I.text.length,i=[0],o=0;(0,u.default)(I.text).forEach(function(t){var n="normal"===e.font_weight?f[t]:h[t],r=e.font_size/n.fontSize;i.push(i[i.length-1]+n.width*r),o=Math.max(o,n.height*r)});var a=i[n],s=o,l=Math.max(1,a/R,s/B);R=a,B=s,N={x:C?R/2-C.x*(e.stretching_len?1:l):R/2,y:C?B/2-C.y*(e.stretching_len?1:l):B/2};for(var c=0;c<n;c++){var d="normal"===e.font_weight?f[I.text[c]]:h[I.text[c]],p=e.font_size/d.fontSize;v.push(L,-M,0),g.push(1,1),_.push(d.width*p,d.height*p,N.x-i[c],N.y),m.push(d.x,d.y,d.width,d.height),y.push(0,1,0,1),x.push.apply(x,(0,b.default)(e.font_color)),S.push.apply(S,(0,b.default)((0,V.encodePickingColor)(e.style_id,!0))),w.push.apply(w,(0,b.default)(e.stroke_color)),E.push(e.stroke_width),t[c]=r,r+=1}I.textSymbolIndexList=t}(),I.instance_trans=[L,-M],I.instance_coords=[R,B,N.x,N.y]}}}),P.forEach(function(t){var e=t.datas[0];if(e){var i=e.text_bounds;i[1]+=c[e.cidx]||0;var a=null;if(a=e.isBillboard&&e.font_size?{w:i[2]/1.5,h:i[3]/1.5}:{w:e.font_size,h:e.font_size},v.push(e.coords[0],-e.coords[1],1),g.push(1,1),(0,D.isDefaultStyle)(o.styleId)){var s=i[2]/n.scale,l=i[3]/n.scale;_.push(s,l,s/2,l/2),m.push(i[0],i[1],i[2],i[3]),y.push(0,1,0,1)}else if(e.isBillboard){var u=d&&d[e.text];e.text_bounds=[u.x,u.y,u.width,u.height],t.datas[1].text_bounds=[u.x,u.y,u.width,u.height],m.push(u.x,u.y,u.width,u.height),_.push(a.w,a.h,a.w/2,a.h/2),y.push(0,1,-1,1),x.push(1,1,1,1),w.push(0,0,0,0),S.push(0,0,0,0),E.push(0)}else{var p="normal"===e.font_weight?f[e.text]:h[e.text],T=e.font_size/p.fontSize;e.glyph_text_bounds=[p.x,p.y,p.width,p.height],t.datas[1].glyph_text_bounds=[p.x,p.y,p.width,p.height],_.push(p.width*T,p.height*T,p.width*T/2,p.height*T/2),m.push(p.x,p.y,p.width,p.height),y.push(0,1,0,1),x.push.apply(x,(0,b.default)(e.font_color)),S.push.apply(S,(0,b.default)((0,V.encodePickingColor)(e.style_id,!0))),w.push.apply(w,(0,b.default)(e.stroke_color)),E.push(e.stroke_width)}t.roadSymbolIndex=r,r+=1}});var I=new Float32Array(v),k=new Float32Array(_),L=new Float32Array(m),M=new Float32Array(g),C=new Float32Array(y),R=new Uint8ClampedArray(x),B=new Uint8ClampedArray(S);return{instanceTransTypeArray:I,instanceCoordsTypeArray:k,instanceTextBoundsTypeArray:L,instanceStrentchinglensTypeArray:M,instanceInfosTypeArray:C,instanceColorsTypeArray:R,instanceStrokeColorsTypeArray:new Uint8ClampedArray(w),instanceStrokeWidthTypeArray:new Float32Array(E),instancePickingColorsTypeArray:B,count:y.length/4}}},{key:"parsePoi",value:function(t,e,n,i){var o=n.tileSize,r={};r.cidx=t.cidx,r.coords=t[1].slice(),r.text=[],r.text_mix=t[3]||0,r.text_align="center",r.text_bounds=t[5],r.style_id=t[0],r.font_size=e.font_size,r.font_color=e.font_color?[].concat((0,b.default)(e.font_color.slice(0,3)),[255*e.font_color[3]]):[0,0,0,0],r.stroke_color=e.background_color?[].concat((0,b.default)(e.background_color.slice(0,3)),[255*e.background_color[3]]):[0,0,0,0];var a=t.transform,s=a.transX,l=void 0===s?0:s,u=a.transY,c=void 0===u?0:u,f=a.scale,d=void 0===f?1:f,h=(0+l)*d,v=(o+l)*d,_=(0+c)*d,m=(o+c)*d,g=t[2];switch(r.textName=g,r.font_weight=1===e.font_weight?"bold":"normal",r.font_family=e.font_family?e.font_family:"",e.effect){case 5:r.stroke_width=e.effect_size+1;break;case 6:(0,D.isDefaultStyle)(this.styleId)?(r.isBillboard=!0,this._needUploadTileImage=!0):(r.stretching_len=e.stretching_len||[0,0],r.icon=e.icon_offset,r.icon_coords=[t[1][0],t[1][1]]);case 1:case 2:default:r.background_color=null,r.stroke_width=0}if(e.icon_offset&&"65535"!==e.icon_offset&&"-1"!==e.icon_offset&&6!==e.effect){var y=e.icon_offset;r.icon=y,r.icon_coords=[t[1][0],t[1][1]],r.coords.shift(),r.coords.shift(),i&&i.isExt&&e.font_size>0&&0===r.coords.length&&(r.coords.push(r.icon_coords[0]),r.coords.push(r.icon_coords[1]+(8+e.font_size/2+2)*d),/\//.test(r.textName)&&(r.coords.push(r.icon_coords[0]),r.coords.push(r.coords[1]+(e.font_size+2)*d)))}if(r.coords[0]<h||r.coords[0]>=v||r.coords[1]<_||r.coords[1]>=m)return null;if(!r.font_size||void 0===g||"@"===g)return r;var x=g.toString(),S=r.isBillboard?[x]:x.split(/\//),w=null;r.icon_coords&&!r.stretching_len?w={x:r.icon_coords[0],y:r.icon_coords[1]}:2===S.length&&(w={x:(r.coords[0]+r.coords[2])/2,y:(r.coords[1]+r.coords[3])/2},r.stretching_len&&(r.icon_coords=[w.x,w.y]));for(var E=0,T=S.length;E<T;E++){var A=r.coords[2*E],P=r.coords[2*E+1],I=r.text_bounds,k=null;if(r.stretching_len&&4===r.text_bounds.length){var L=(0,p.default)(r.text_bounds,4),M=L[0],C=L[1],R=L[2],B=L[3];k=2===T?[M,C/2-2,R,B/2]:[M,C,R,B/2],r.text_bounds=[M,C,R,B/2,M,C/2-2,R,B/2]}else k=2===T?I.slice(4*(1-E),4*(1-E)+4):I.slice(4*E,4*E+4);var N=w?{x:(A-w.x)/d,y:(P-w.y)/d}:null,O={text:S[E],coords:w?[w.x,w.y]:[A,P],centerOffset:N,rank:t[4]};if(!(A&&P||0===A||0===P))break;r.text.push(O),r.isBillboard&&this._billboardFeatures.push({text:S[E],bounds:k,cidx:r.cidx})}return r}},{key:"parseRoadName",value:function(t,e,n,i,o,r,a){var s=a||256,l=[],u="",c=t.transform,f=c.transX,d=void 0===f?0:f,h=c.transY,v=void 0===h?0:h,p=c.scale,_=void 0===p?1:p,m=(0+d)*_,g=(s+d)*_,y=(0+v)*_,x=(s+v)*_,S=t.length/2-.5,w=void 0;if(S%1==0)w=t[S][1];else{var E=t[Math.floor(S)][1],T=t[Math.ceil(S)][1];w=[(E[0]+T[0])/2,(E[1]+T[1])/2]}if(w[0]<m||w[0]>g||w[1]<y||w[1]>x)return null;for(var A=0,P=t.length;A<P;A++){var I=t[A],k=I[0],L=X(e,n,i,k,o);if(L){var M=[],C={};switch(C.coordScale=_,C.cidx=t.cidx,C.coords=I[1].slice(),C.text=I[2],C.text_mix=I[3]||0,C.text_bounds=I[5],C.rank=I[4],C.font_size=L.font_size,C.style_id=I[0],C.font_color=L.font_color?[].concat((0,b.default)(L.font_color.slice(0,3)),[255*L.font_color[3]]):[0,0,0,0],C.stroke_color=L.background_color?[].concat((0,b.default)(L.background_color.slice(0,3)),[255*L.background_color[3]]):[0,0,0,0],L.effect){case 5:C.stroke_width=L.effect_size+1;break;case 6:C.isBillboard=!0,this._needUploadTileImage=!0;case 1:case 2:default:C.background_color=null,C.stroke_width=0}u+=I[2],C.font_weight=1===L.font_weight?"bold":"normal",C.font_family=L.font_family?L.font_family:"",M.push(C),M.push(H.clone(C)),C.isBillboard&&this._billboardFeatures.push({text:C.text,bounds:C.text_bounds,cidx:C.cidx}),l.push({datas:M,font_size:L.font_size,id:r+"_"+q()})}}return{roads:l,roadName:u}}},{key:"parseArrow",value:function(t,e){var n={};return n.coords=[t[1][0],-t[1][1],t[1][2],-t[1][3]],n.color_fill=e.color_fill,n.width=e.width,n}}]),t}();t.exports=tt},function(t,e,n){"use strict";function i(t,e){f[t]={};for(var n=3;n<=20;n++){var i=a(e.regionStyles,null,null,u,n);i&&(f[t][n]="rgba("+l(i.color_fill).join(",")+")")}}function o(t,e){return f[t]&&f[t][Math.floor(e)]||c}Object.defineProperty(e,"__esModule",{value:!0}),e.setBgColor=i,e.getBgColor=o;var r=n(497),a=r.getVectorStyle,s=n(10),l=s.colorToRGBA,u="196613",c="rgba(0, 0, 0, 0)",f={}},function(t,e,n){"use strict";function i(t,e){if(t&&(!t||0!==t.length)){var n=t.length,i=void 0;if(1===n)e<=t[0].maxScaleVal&&e>=t[0].minScaleVal&&(i=a.objectClone(t[0]));else{var o=!0,s=!1,l=void 0;try{for(var u,c=(0,r.default)(t);!(o=(u=c.next()).done);o=!0){var f=u.value;if(e<=f.maxScaleVal&&e>=f.minScaleVal){i=a.objectClone(f);break}}}catch(t){s=!0,l=t}finally{try{!o&&c.return&&c.return()}finally{if(s)throw l}}}return i}}var o=n(27),r=function(t){return t&&t.__esModule?t:{default:t}}(o),a=n(10);e.getVectorStyle=function(t,e,n,o,r){var s=t[o];if(s){var l=i(s,r);if(l&&e&&n&&l[n]){var u=e[l[n]];if(u){var c=i(u,r);c&&"-1"===c.icon_offset&&6===c.effect&&(c.icon_offset=l.icon_offset||"-1"),l=a.extend({},l,c)}}else if(e&&n){var f=s[0]&&s[0][n],d=e[f];l=i(d,r)}return l}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){return new f.default(function(n){var i=t||0,o=p.default.QMAPI_poi_icon_json+i,r=-1,l="",c=null;m.default.support()?m.default.get(o,function(t){var f=JSON.parse(t);r=t?f.version:r,l=e.replace("{id}",i).replace("{version}",r),h.default.getJSON(null,l,function(t,e,l){if(!t&&e&&e.data){if("{}"!==(0,u.default)(e.data))return s({styleId:i,version:r,time:l}),c=e.data,void m.default.set(o,(0,u.default)(e),function(){n(c)});c=f.data}else a({styleId:i,version:r,err:t}),console.error(t,e),c=f.data;n(c)})}):(l=e.replace("{id}",i).replace("{version}",r),h.default.getJSON(null,l,function(t,e,o){return!t&&e&&e.data?"{}"===(0,u.default)(e.data)?(a({styleId:i,version:r,err:null}),console.error(e),void n(null)):(s({styleId:i,version:r,time:o}),c=e.data,void n(c)):(a({styleId:i,version:r,err:t}),console.error(t,e),void n(null))}))})}function r(t){var e=t.data,n=t.styleId,i=t.iconIndexSrc;return new f.default(function(t){e?m.default.support()?m.default.set(y,(0,u.default)({data:e}),function(){t(e)}):(console.error("兼容性错误：当前浏览器不支持LocalStorage。"),t(null)):o(n,i).then(function(e){m.default.support()?m.default.set(y,(0,u.default)({data:e}),function(){t(e)}):(console.error("兼容性错误：当前浏览器不支持LocalStorage。"),t(null))})})}function a(t){var e=t.styleId,n=t.version,i=t.err;(0,g.qos)("ii",{styleId:e,version:n,error:i&&i.status||0})}function s(t){var e=t.styleId,n=t.version,i=t.time;(0,g.qos)("ii",{styleId:e,version:n,loadTime:i})}Object.defineProperty(e,"__esModule",{value:!0}),e.setPoiIconIndex=e.loadPoiIconIndexFile=void 0;var l=n(113),u=i(l),c=n(25),f=i(c),d=n(79),h=i(d),v=n(137),p=i(v),_=n(89),m=i(_),g=n(43),y=p.default.QMAPI_poi_icon_json+"config";e.loadPoiIconIndexFile=o,e.setPoiIconIndex=r},,,,,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(24),r=i(o),a=n(27),s=i(a),l=n(3),u=i(l),c=n(0),f=i(c),d=n(1),h=i(d),v=n(5),p=i(v),_=n(4),m=i(_),g=n(106),y=i(g),x=n(10),b=i(x),S=function(t){function e(){(0,f.default)(this,e);var t=(0,p.default)(this,(e.__proto__||(0,u.default)(e)).call(this));return t._rawGeometries=[],t._idSet={},t.geometries=[],t}return(0,m.default)(e,t),(0,h.default)(e,[{key:"_checkGeometries",value:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}},{key:"_assignIdToGeometry",value:function(t){var e=[];return t.forEach(function(t){0===t.id||t.id?e.includes(t.id)&&(t.id=t.id+"-"+b.default.uniqueId()):t.id=b.default.uniqueId(),e.push(t.id)}),t}},{key:"_updateGeometryIdSet",value:function(t){var e={};return t.forEach(function(t,n){e[t.id]=n}),e}},{key:"_transferFromGeometry",value:function(t){var e=b.default.clone(t);return e.forEach(function(t){t.rank=t.rank||0}),e.sort(function(t,e){return t.rank-e.rank}),e}},{key:"setGeometries",value:function(t,e){this._checkGeometries(t,e),this._rawGeometries=this._assignIdToGeometry(t),this._idSet=this._updateGeometryIdSet(this._rawGeometries),this.geometries=this._transferFromGeometry(this._rawGeometries),this.emit("geometry_changed")}},{key:"getGeometries",value:function(){return b.default.clone(this._rawGeometries)}},{key:"getGeometryById",value:function(t){var e=!0,n=!1,i=void 0;try{for(var o,r=(0,s.default)(this._rawGeometries);!(e=(o=r.next()).done);e=!0){var a=o.value;if(a.id===t)return a}}catch(t){n=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(n)throw i}}return null}},{key:"updateGeometries",value:function(t,e){var n=this;Array.isArray(t)||(t=[t]),e||this._checkGeometries(t,this.styles),[].concat((0,r.default)(this._assignIdToGeometry(t))).forEach(function(t){n._idSet.hasOwnProperty(t.id)?n._rawGeometries[n._idSet[t.id]]=t:(n._idSet[t.id]=n._rawGeometries.length,n._rawGeometries.push(t))}),this._idSet=this._updateGeometryIdSet(this._rawGeometries),this.geometries=this._transferFromGeometry(this._rawGeometries),this.emit("geometry_changed")}},{key:"add",value:function(t){var e=this;return t?(Array.isArray(t)||(t=[t]),this._checkGeometries(t,this.styles),this._assignIdToGeometry(t).forEach(function(t){e._idSet.hasOwnProperty(t.id)||(e._idSet[t.id]=e._rawGeometries.length,e._rawGeometries.push(t))}),this.updateGeometries(this._rawGeometries,!0),this):this}},{key:"remove",value:function(t){if(!t)return this;Array.isArray(t)||(t=[t]);var e=this._rawGeometries.length,n=this._rawGeometries.filter(function(e){return-1===t.indexOf(e.id)});return n.length===e?this:(this.setGeometries(n),this)}},{key:"destroy",value:function(){this._rawGeometries=[],this._idSet={},this.geometries=[]}}]),e}(y.default);e.default=S},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(0),r=i(o),a=n(1),s=i(a),l=n(41),u=i(l),c=n(29),f=n(558),d=i(f),h=n(74),v={map:0,screen:1},p={center:0,top:1,bottom:2,left:3,right:4},_={src:d.default,width:34,height:50,rotate:0,opacity:1,faceTo:"screen",color:"rgba(0, 0, 0, 1)",strokeColor:"rgba(0, 0, 0, 0)",strokeWidth:1,size:14,direction:"center",offset:new h(0,0)},m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.default)(this,t),this._checkMarkerPartStyle(e),this._checkLabelPartStyle(e)}return(0,s.default)(t,[{key:"_checkMarkerPartStyle",value:function(t){var e=t.src,n=void 0===e?_.src:e,i=t.width,o=void 0===i?_.width:i,r=t.height,a=void 0===r?_.height:r,s=t.anchor,l=t.rotate,f=void 0===l?_.rotate:l,d=t.opacity,v=void 0===d?_.opacity:d;u.default.isNumber(o)?o<=0&&(console.error("参数错误：MarkerStyle.width 取值要大于0，实际传入: "+o+"."),o=_.width):(new c.BaseTypeError("MarkerStyle.width","number",o).error(),o=_.width),u.default.isNumber(a)?a<=0&&(console.error("参数错误：MarkerStyle.height 取值要大于0，实际传入: "+a+"."),a=_.height):(new c.BaseTypeError("MarkerStyle.height","number",a).error(),a=_.height),u.default.isString(n)||(new c.BaseTypeError("MarkerStyle.src","string",n).error(),n=_.src),s?u.default.isValidOffset(s)||(console.error("参数错误：MarkerStyle.anchor不合法",s),s=new h(o/2,a)):s=new h(o/2,a),u.default.isNumber(f)?f<0&&(console.error("参数错误：MarkerStyle.rotate 取值要大于等于0，实际传入: "+f+"."),f=_.rotate):(new c.BaseTypeError("MarkerStyle.rotate","number",f).error(),f=_.rotate),u.default.isNumber(v)?v<0&&(console.error("参数错误：MarkerStyle.opacity 取值要大于等于0，实际传入: "+v+"."),v=_.opacity):(new c.BaseTypeError("MarkerStyle.opacity","number",v).error(),v=_.opacity);var p=new Image;/^data:/.test(n)||(p.crossOrigin="anonymous"),p.src=n,this.src=p.src,this.width=o,this.height=a,this.rotate=f,this.anchor=s,this.opacity=v}},{key:"_checkLabelPartStyle",value:function(t){var e=t.faceTo,n=void 0===e?_.faceTo:e,i=t.color,o=void 0===i?_.color:i,r=t.strokeColor,a=void 0===r?_.strokeColor:r,s=t.strokeWidth,l=void 0===s?_.strokeWidth:s,f=t.size,d=void 0===f?_.size:f,h=t.direction,m=void 0===h?_.direction:h,g=t.offset,y=void 0===g?_.offset:g;u.default.isString(n)||(new c.BaseTypeError("MarkerStyle.faceTo","string",n).error(),n=_.faceTo),u.default.isValidColor(o)||(console.error("MarkerStyle.color属性无效",o),o=_.color),u.default.isValidColor(a)||(console.error("MarkerStyle.color属性无效",a),a=_.strokeColor),u.default.isNumber(l)?l<0&&(console.error("参数错误：MarkerStyle.strokeWidth 取值要大于等于0，实际传入: "+l+"."),l=_.strokeWidth):(new c.BaseTypeError("MarkerStyle.strokeWidth","number",l).error(),l=_.strokeWidth),u.default.isNumber(d)?d<0&&(console.error("参数错误：MarkerStyle.size 取值要大于等于0，实际传入: "+d+"."),d=_.size):(new c.BaseTypeError("MarkerStyle.size","number",d).error(),d=_.size),u.default.isString(m)||(new c.BaseTypeError("MarkerStyle.direction","string",m).error(),m=_.direction),y&&!u.default.isObject(y)?(new c.BaseTypeError("MarkerStyle.offset","object",y).error(),y=_.offset):u.default.isValidOffset(y)||(console.error("参数错误：MarkerStyle.offset不合法",y),y=_.offset),this.faceTo=n in v?v[n]:v.screen,this.color=o,this.strokeColor=a,this.strokeWidth=l,this.size=d,this.direction=m in p?p[m]:p.center,this.offset=y}}]),t}();t.exports=m},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){if((0,k.isSimple)(t)){for(var e=[],n=0;n<t.length-1;n++){var i=[t[n],t[n+1]];e.push(i)}return e}return t.map(function(t){return o(t)}).flat()}var r=n(140),a=i(r),s=n(17),l=i(s),u=n(3),c=i(u),f=n(0),d=i(f),h=n(1),v=i(h),p=n(5),_=i(p),m=n(35),g=i(m),y=n(4),x=i(y),b=n(339),S=i(b),w=n(41),E=i(w),T=n(303),A=i(T),P=n(220),I=n(66),k=n(480),L=n(29),M=E.default.isValidColor,C=E.default.isValidLatLng,R=function(t){function e(t){return(0,d.default)(this,e),(0,_.default)(this,(e.__proto__||(0,c.default)(e)).call(this,t))}return(0,x.default)(e,t),(0,v.default)(e,[{key:"_initialize",value:function(t){this.enableGeodesic=t.enableGeodesic||!1,this._eraseOpts={}}},{key:"_setGeometryType",value:function(){this._geometryType=P.GEOMETRY_TYPES.POLYLINE,this._layerType=I.RENDER_LAYER_TYPE.polyline,this._className="MultiPolyline"}},{key:"_checkGeometries",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t,e){t?t.styleId||(t.styleId="default"):console.error("MultiPolyline.geometries: 希望传入PolylineGeometry数组，实际第"+e+"元素不存在！");var n=t.paths,i=t.rainbowPaths;n||i||console.error("MultiPolyline.geometries: 希望传入PolylineGeometry数组，实际第"+e+"元素的未传入路径信息！"),!n||(0,k.isSimple)(n)||(0,k.isComplexLine)(n)||console.error("MultiPolyline.geometries: 希望传入PolylineGeometry数组，实际第"+e+"元素的paths属性无效！"),Array.isArray(i)&&i.length>0&&(i.map(function(t,n){return t.color&&!M(t.color)&&console.error("MultiPolyline.geometries: 第"+e+"元素的rainbowPaths中的第"+n+"个元素的color属性无效！"),t.borderColor&&!M(t.borderColor)&&console.error("MultiPolyline.geometries: 第"+e+"元素的rainbowPaths中的第"+n+"个元素的borderColor属性无效！"),t.path}).every(function(t){return(0,k.isSimple)(t)})?delete t.paths:console.error("MultiPolyline.geometries: 希望传入PolylineGeometry数组，实际第"+e+"元素的rainbowPath属性无效！"))})}},{key:"_getRenderSourceData",value:function(){return{type:this._geometryType,styles:this.styles,enableGeodesic:this.enableGeodesic||!1,_eraseOpts:this._eraseOpts||null,geometries:this._getRenderableGeometries()}}},{key:"_getDefaultStyle",value:function(){return new S.default}},{key:"_checkStyles",value:function(t){var n=this;(0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"_checkStyles",this).call(this,t),(0,l.default)(t).forEach(function(e){var i=t[e];i&&i instanceof S.default?i.width&&i.width>0&&i.width%1==0?M(i.color)?"borderWidth"in i&&!(i.borderWidth>=0&&i.borderWidth%1==0)?console.error("MultiPolyline.styles: 样式id ",e," 对应的PolylineStyle.borderWidth属性无效",i):"borderColor"in i&&!M(i.borderColor)?console.error("MultiPolyline.styles: 样式id ",e," 对应的PolylineStyle.borderColor属性无效",i):M(i.eraseColor)||(console.error("MultiPolyline.styles: 样式id ",e," 对应的PolylineStyle.eraseColor属性无效",i),t[e].eraseColor=n._getDefaultStyle().eraseColor):console.error("MultiPolyline.styles: 样式id ",e," 对应的PolylineStyle.color属性无效",i):console.error("MultiPolyline.styles: 样式id ",e," 对应的PolylineStyle.width属性无效",i):console.error("MultiPolyline.styles: 样式id ",e,"希望传入PolylineStyle实例，实际传入：",i)})}},{key:"_getAllPoints",value:function(){return this.getGeometries().map(function(t){return t.paths.flat(1/0)}).flat()}},{key:"_getAllSegments",value:function(){return this.getGeometries().map(function(t){return o(t.paths)}).flat()}},{key:"eraseTo",value:function(t,e,n){if(this._checkEraseParams(t,e,n)){var i=this.getGeometryById(t);if(!i)return console.error("eraseTo: 不存在id为"+t+"的polyline geometry 对象"),this;if(e>i.paths.length-1||e<=0)return console.error("eraseTo: 坐标索引index："+e+" 不在对应path点串区间内"),this;this._eraseOpts[t]={index:e,point:n},this.map.getSource(this.id).setData(this._getRenderSourceData())}return this}},{key:"_checkEraseParams",value:function(t,e,n){return C(n)?"number"!=typeof e||(0,a.default)(e)?(console.error("eraseTo方法中参数index: "+e+"不合法!"),!1):"string"==typeof t||(new L.ClassTypeError("eraseTo的参数id["+t+"]","String",t).error(),!1):(new L.ClassTypeError("eraseTo方法中的参数point["+n+"]","LatLng",n).error(),!1)}}]),e}(A.default);t.exports=R},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.defaultLogoRules=[{level:[0,6],districts:[{rule:0,priority:0,frontier:"default",logo_name:"tencent",logo:"https://mapapi.qq.com/sdk/overseamap/logo/202107/tencent_color_logo.png",logo_night:"https://mapapi.qq.com/sdk/overseamap/logo/202107/tencent_color_logo_night.png"}]},{level:[7,18],districts:[{rule:0,priority:0,frontier:"taiwan",logo_name:"taiwan",logo:"https://mapapi.qq.com/sdk/overseamap/logo/HERE_Logo_black.png",logo_night:""},{rule:0,priority:0,frontier:"default",logo_name:"tencent",logo:"https://mapapi.qq.com/sdk/overseamap/logo/202107/tencent_color_logo.png",logo_night:"https://mapapi.qq.com/sdk/overseamap/logo/202107/tencent_color_logo_night.png"}]}],e.defaultFrontier={version:7,china:"124.240000,39.863000:127.060000,41.420000:128.320000,41.340000:128.338164,41.966811:129.070015,42.006633:129.392187,42.394602:129.544000,42.337000:129.757733,42.443019:129.915455,42.958121:130.581000,42.411000:130.664000,42.409000:130.660000,42.750000:131.056800,42.832500:131.362267,43.147780:131.359097,44.050378:131.184574,44.758711:131.911825,45.219501:133.163642,44.937724:135.144366,48.211013:135.144366,48.597000:131.071828,48.211013:130.773650,49.035551:128.751969,49.726565:125.969075,53.154351:123.347269,53.704738:120.827269,53.390754:119.713597,52.637780:120.321762,52.210396:118.926328,50.226355:117.662701,49.700280:116.622716,49.956516:115.284508,48.000368:116.104389,47.451176:118.485448,47.755809:119.550866,46.911548:117.463642,46.804509:113.640000,45.105329:111.969090,45.243847:111.267254,44.465714:111.589045,43.737317:109.905388,42.763982:107.448179,42.614694:105.337313,41.946215:100.992746,42.800196:96.838239,42.914056:95.070866,44.957807:91.816477,45.242319:91.161836,46.742245:90.130007,47.948495:88.699097,48.336174:87.883642,49.202090:86.809933,49.172099:85.459963,48.255788:85.328157,47.119427:82.919985,47.328453:82.134523,45.619623:82.396343,45.291415:81.735685,45.446091:79.797183,45.018009:80.618157,43.259401:80.112694,42.868284:80.120896,42.260590:77.976351,41.282314:76.788172,41.096389:76.197254,40.491205:75.361880,40.846808:73.365418,39.794560:73.634523,38.503352:74.669067,38.423003:74.896815,37.310540:74.429528,37.294106:74.454501,36.972073:75.734530,36.578999:75.962701,35.784605:77.852731,35.299899:78.205470,34.574291:78.973568,32.910437:78.263619,32.582183:78.649985,30.992536:81.199112,29.930890:81.625396,30.231654:85.988179,27.769037:88.674612,27.787987:88.840910,27.047339:89.241858,27.247275:89.644552,28.077447:90.426358,28.002589:91.425425,27.605415:92.127284,26.721880:93.834582,26.907073:95.855604,28.198876:97.000074,27.593593:97.491836,27.849236:97.700896,28.296779:98.301769,27.394792:98.605433,27.417494:98.502702,26.026786:97.440895,25.088802:97.485448,23.745403:98.497224,24.030523:98.809985,23.174956:99.324515,22.945024:99.099993,22.084196:100.205485,21.391178:101.003735,21.463004:101.278198,21.122876:101.931836,21.129823:101.785481,22.197373:102.650063,22.558783:103.074619,22.382137:103.979093,22.474798:104.809933,22.767793:105.399978,23.049961:106.469971,22.704082:106.610899,21.787060:107.897261,21.372454:107.490036,19.305984:109.748489,14.674666:110.039063,11.480025:107.666016,6.271618:111.752930,3.281824:112.939454,3.413421:115.018257,6.054474:118.674316,10.790140:119.164223,12.212996:119.707031,18.020528:121.959229,21.677848:122.699226,23.809795:127.303391,24.447079:127.390663,31.568056:124.335754,32.823666",inland:"124.240000,39.863000:127.060000,41.420000:128.320000,41.340000:128.338164,41.966811:129.070015,42.006633:129.392187,42.394602:129.544000,42.337000:129.757733,42.443019:129.915455,42.958121:130.581000,42.411000:130.664000,42.409000:130.660000,42.750000:131.056800,42.832500:131.362267,43.147780:131.359097,44.050378:131.184574,44.758711:131.911825,45.219501:133.163642,44.937724:135.144366,48.211013:135.144366,48.597000:131.071828,48.211013:130.773650,49.035551:128.751969,49.726565:125.969075,53.154351:123.347269,53.704738:120.827269,53.390754:119.713597,52.637780:120.321762,52.210396:118.926328,50.226355:117.662701,49.700280:116.622716,49.956516:115.284508,48.000368:116.104389,47.451176:118.485448,47.755809:119.550866,46.911548:117.463642,46.804509:113.640000,45.105329:111.969090,45.243847:111.267254,44.465714:111.589045,43.737317:109.905388,42.763982:107.448179,42.614694:105.337313,41.946215:100.992746,42.800196:96.838239,42.914056:95.070866,44.957807:91.816477,45.242319:91.161836,46.742245:90.130007,47.948495:88.699097,48.336174:87.883642,49.202090:86.809933,49.172099:85.459963,48.255788:85.328157,47.119427:82.919985,47.328453:82.134523,45.619623:82.396343,45.291415:81.735685,45.446091:79.797183,45.018009:80.618157,43.259401:80.112694,42.868284:80.120896,42.260590:77.976351,41.282314:76.788172,41.096389:76.197254,40.491205:75.361880,40.846808:73.365418,39.794560:73.634523,38.503352:74.669067,38.423003:74.896815,37.310540:74.429528,37.294106:74.454501,36.972073:75.734530,36.578999:75.962701,35.784605:77.852731,35.299899:78.205470,34.574291:78.973568,32.910437:78.263619,32.582183:78.649985,30.992536:81.199112,29.930890:81.625396,30.231654:85.988179,27.769037:88.674612,27.787987:88.840910,27.047339:89.241858,27.247275:89.644552,28.077447:90.426358,28.002589:91.425425,27.605415:92.127284,26.721880:93.834582,26.907073:95.855604,28.198876:97.000074,27.593593:97.491836,27.849236:97.700896,28.296779:98.301769,27.394792:98.605433,27.417494:98.502702,26.026786:97.440895,25.088802:97.485448,23.745403:98.497224,24.030523:98.809985,23.174956:99.324515,22.945024:99.099993,22.084196:100.205485,21.391178:101.003735,21.463004:101.278198,21.122876:101.931836,21.129823:101.785481,22.197373:102.650063,22.558783:103.074619,22.382137:103.979093,22.474798:104.809933,22.767793:105.399978,23.049961:106.469971,22.704082:106.610899,21.787060:107.897261,21.372454:107.490036,19.305984:109.748489,14.674666:110.039063,11.480025:107.666016,6.271618:111.752930,3.281824:112.939454,3.413421:115.018257,6.054474:118.674316,10.790140:119.164223,12.212996:119.707031,18.020528:121.397269,20.720622:118.487770,21.778166:119.578789,24.089008:120.465831,25.121382:121.207406,25.815692:121.869972,25.849447:122.599226,25.209509:122.699226,23.809795:127.303391,24.447079:127.390663,31.568056:124.335754,32.823666",japan:"130.058874,35.187485:133.208436,36.728760:135.302372,36.335340:136.056445,37.097326:137.028118,38.068999:138.937959,39.610275:139.004971,42.659319:140.278198,45.741869:141.661984,45.763377:144.566964,44.736690:148.890681,46.139089:149.266393,45.455293:147.984574,43.664498:142.757641,41.453104:142.925171,39.610275:141.098416,34.356762:142.992183,27.280073:141.450908,24.432065:131.432619,25.504256:127.303391,24.447079:127.390663,31.568056:127.210208,33.397935:127.728060,33.848258:128.693979,34.488846:129.402013,35.158401",taiwan:"121.397269,20.720622:118.487770,21.778166:119.578789,24.089008:120.465831,25.121382:121.207406,25.815692:121.869972,25.849447:122.599226,25.209509:122.699226,23.809795:121.959229,21.677848"}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(){return new l.default(function(t){var e=c.default.QMAPI_oversea;d.default.support()?d.default.get(e,function(e){e||t(null);try{g=JSON.parse(e),t(g)}catch(e){t(null)}}):t(null)})}function r(t){var e=c.default.QMAPI_oversea;d.default.support()&&d.default.set(e,t)}function a(t){var e=t&&t.info&&t.info.frontier&&t.info.frontier.path;return e?new l.default(function(t){_(e,function(e,n){e&&t(g||p.defaultFrontier);try{var i=m.inflate(n.data,{to:"string"});r(i);var o=JSON.parse(i);t(o)}catch(e){t(g||p.defaultFrontier)}})}):new l.default(function(t){o().then(function(e){t(e||p.defaultFrontier)})})}Object.defineProperty(e,"__esModule",{value:!0});var s=n(25),l=i(s);e.getStorageFrontier=o,e.getOnlineFrontier=a;var u=n(137),c=i(u),f=n(89),d=i(f),h=n(79),v=i(h),p=n(507),_=v.default.getArrayBuffer,m=n(552),g=null},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ScheduleTaskQueue=e.ScheduleTaskNode=void 0;var o=n(0),r=i(o),a=n(1),s=i(a),l=n(28),u=i(l);e.ScheduleTaskNode=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.default)(this,t),this.prev=null,this.next=null,this.callback=null,this._expirationTime=e.expirationTime||u.default.now()+150}return(0,s.default)(t,[{key:"isTimeout",value:function(){return u.default.now()>=this._expirationTime}},{key:"setCallback",value:function(t){this.callback=t}},{key:"runTask",value:function(){var t=null;try{this.callback&&(t=this.callback())}catch(t){console.error(t)}"function"==typeof t?this.setCallback(t):this.remove()}},{key:"remove",value:function(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.queue&&this.queue.first===this&&(this.queue.first=this.next),this.queue&&this.queue.last===this&&(this.queue.last=this.prev),this.prev=null,this.next=null,this.callback=null,this.queue=null}},{key:"addToQueue",value:function(t){this.queue=t,this.queue.last?(this.queue.last.next=this,this.prev=this.queue.last,this.queue.last=this):this.queue.last=this,this.queue.first||(this.queue.first=this)}}]),t}(),e.ScheduleTaskQueue=function t(){(0,r.default)(this,t),this.first=null,this.last=null}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(337),p=i(v),_=n(511),m=i(_),g=n(10),y=n(143),x=n(793),b=n(41),S=i(b),w=n(29),E=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this)),i=t.map,o=t.id,a=void 0===o?(0,g.uniqueId)():o,l=t.zIndex,u=void 0===l?0:l;return n.id=a,n.level=y.LAYER_LEVEL.OVERLAY_AA,n.zIndex=0,n.rank=(0,y.getRank)(n.level,n.zIndex),n.setZIndex(u),n.onInit(t),i&&i instanceof p.default&&n.addTo(i),n}return(0,h.default)(e,t),(0,u.default)(e,[{key:"onInit",value:function(){}},{key:"addTo",value:function(t){if(t!==this.map)return this.remove(),t.addVisualPlugin(this),this.map=t,this.gl=t.renderEngine.gl,this.onAddToMap({canvas:t.canvasContainer,camera:t.renderEngine.camera}),this}},{key:"remove",value:function(){return this.map&&(this.map.removeVisualPlugin(this.id),this.onRemoveFromMap(),this.map=null,this.gl=null),this}},{key:"redraw",value:function(){return this.map&&this.map._render(),this}},{key:"draw",value:function(){var t=this,e=this.gl;e&&(0,x.preserveParameters)(e,{DEPTH_TEST:!1,STENCIL_TEST:!1,BLEND:!0,CULL_FACE:!1,CULL_FACE_MODE:e.BACK,BLEND_SRC_RGB:e.ONE,BLEND_DST_RGB:e.ONE_MINUS_SRC_ALPHA,BLEND_SRC_ALPHA:e.ONE,BLEND_DST_ALPHA:e.ONE_MINUS_SRC_ALPHA,VIEWPORT:[0,0,e.canvas.width,e.canvas.height],UNPACK_FLIP_Y_WEBGL:!1,UNPACK_PREMULTIPLY_ALPHA_WEBGL:!1},function(){t.onDraw()})}},{key:"setZIndex",value:function(t){return S.default.isNumber(t)?t<0?(console.error("zIndex希望设置为非负数,实际值为: "+t),this):(this.zIndex=t,this.rank=(0,y.getRank)(this.level,this.zIndex),this):(new w.BaseTypeError("zIndex","Number",t).error(),this)}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"setLevel",value:function(t){this.level=t,this.rank=(0,y.getRank)(t,this.zIndex)}},{key:"getId",value:function(){return this.id}},{key:"onAddToMap",value:function(){}},{key:"onRemoveFromMap",value:function(){}},{key:"onDraw",value:function(){}}]),e}(m.default);e.default=E},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(3),r=i(o),a=n(0),s=i(a),l=n(5),u=i(l),c=n(4),f=i(c),d=n(106),h=function(t){function e(){return(0,s.default)(this,e),(0,u.default)(this,(e.__proto__||(0,r.default)(e)).call(this))}return(0,f.default)(e,t),e}(d);t.exports=h},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){switch(t.type){case p.LIGHT_TYPE.POINT:return new S(t);case p.LIGHT_TYPE.DIRECTION:return new b(t);case p.LIGHT_TYPE.AMBIENT:default:return new x(t)}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),a=i(r),s=n(5),l=i(s),u=n(4),c=i(u),f=n(0),d=i(f),h=n(1),v=i(h);e.default=o;var p=n(341),_=n(10),m=n(107),g=n(227),y=i(g),x=function(){function t(e){var n=e.id,i=e.color,o=void 0===i?"#FFFFFF":i,r=e.intensity,a=void 0===r?1:r,s=e.type;(0,d.default)(this,t),this.id=n||(0,_.uniqueId)(),this.color=o,this.intensity=a,this.type=s}return(0,v.default)(t,[{key:"color",get:function(){var t=this;return this._color.map(function(e){return e*t.intensity})},set:function(t){this._color=new y.default(t,{max:1}).toArray().slice(0,3)}}]),t}(),b=function(t){function e(t){(0,d.default)(this,e);var n=(0,l.default)(this,(e.__proto__||(0,a.default)(e)).call(this,t));return n.direction=t.direction,n}return(0,c.default)(e,t),(0,v.default)(e,[{key:"direction",get:function(){return this._direction.elements},set:function(t){this._direction=new m.Vector3(t||[0,0,-1]).normalize().scale(-1,-1,-1)}}]),e}(x),S=function(t){function e(t){(0,d.default)(this,e);var n=(0,l.default)(this,(e.__proto__||(0,a.default)(e)).call(this,t));return n.position=t.position,n.height=t.height,n.attenuation=t.attenuation||[1,.045,.0075],n}return(0,c.default)(e,t),e}(x)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,e=new Float32Array(8*t*t),n=new Uint8Array(6*t*t),i=0,o=0;o<t;o++)for(var r=0;r<t;r++){var a=[r/t,o/t],s=1/t,l=8*i;e[l]=a[0],e[l+1]=a[1],e[l+2]=a[0],e[l+3]=a[1]+s,e[l+4]=a[0]+s,e[l+5]=a[1],e[l+6]=a[0]+s,e[l+7]=a[1]+s;var u=6*i,c=4*i;n[u+0]=c+0,n[u+1]=c+2,n[u+2]=c+1,n[u+3]=c+1,n[u+4]=c+2,n[u+5]=c+3,i+=1}return{vertices:e,indices:n}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(24),a=i(r),s=n(3),l=i(s),u=n(0),c=i(u),f=n(1),d=i(f),h=n(5),v=i(h),p=n(35),_=i(p),m=n(4),g=i(m),y=n(305),x=i(y),b=n(596),S=n(139),w=function(t){function e(t){(0,c.default)(this,e);var n=(0,v.default)(this,(e.__proto__||(0,l.default)(e)).call(this,t));return n.defaultShaderConfig={source:b.defaultShader,params:{attributes:["a_position"],uniforms:["u_matrix","u_size","u_texInfo","u_opacity","u_sampler"]},geometry:{vertices:new Float32Array([0,0,0,1,1,0,1,1]),indices:new Uint8Array([0,2,1,1,2,3])}},n.sphereShaderConfig={source:b.sphereShader,params:{attributes:["a_position"],uniforms:["u_matrix","u_size","u_texInfo","u_opacity","u_sampler","u_mercator","uZoom","uCenter","uMatrix","u_ratio","u_wireframe"]},geometry:o(4)},n.shaderSource=n.defaultShaderConfig.source,n.shaderParams=n.defaultShaderConfig.params,n}return(0,g.default)(e,t),(0,d.default)(e,[{key:"preDraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.isSphere,i=n?this.sphereShaderConfig:this.defaultShaderConfig,o=i.source,r=i.params,a=i.geometry;if(this.shaderSource=o,this.shaderParams=r,(0,_.default)(e.prototype.__proto__||(0,l.default)(e.prototype),"preDraw",this).call(this),!i.buffers){var s=a.vertices,u=a.indices;i.buffers=this.createBuffer(null,s,u)}this.buffers=i.buffers,this.bindBuffer()}},{key:"bindBuffer",value:function(){var t=this.gl;this.buffers.vertices.bind(),this.buffers.vertices.pointToAttrib({location:this.a_position,size:2,type:t.FLOAT}),this.buffers.indices.bind()}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.isSphere?this.drawOnSphere(t):this.drawOnPlane(t)}},{key:"drawOnPlane",value:function(t){var e=t.matrix,n=t.size,i=t.texInfo,o=t.opacity,r=this.gl;r.uniformMatrix4fv(this.u_matrix,!1,e.elements),r.uniform1i(this.u_sampler,0),r.uniform2f(this.u_size,n.width,n.height),r.uniform4f(this.u_texInfo,i.s,i.t,i.w,i.h),r.uniform1f(this.u_opacity,o),r.drawElements(r.TRIANGLES,this.buffers.length,r.UNSIGNED_BYTE,0)}},{key:"drawOnSphere",value:function(t){var e=t.mercator,n=t.zoom,i=t.center,o=t.pvMatrix,r=t.matrix,s=t.size,l=t.texInfo,u=t.opacity,c=t.viewTransition,f=void 0===c?1:c,d=this.gl,h=(0,S.splitLatLngNumber)(i.lat),v=(0,S.splitLatLngNumber)(i.lng);d.uniformMatrix4fv(this.u_matrix,!1,r.elements),d.uniform1i(this.u_sampler,0),d.uniform2f(this.u_size,s.width,s.height),d.uniform4f(this.u_texInfo,l.s,l.t,l.w,l.h),d.uniform1f(this.u_opacity,u),d.uniform3f.apply(d,[this.u_mercator].concat((0,a.default)(e))),d.uniform1f(this.u_ratio,f),d.uniform1f(this.uZoom,n),d.uniform4f(this.uCenter,v.high,h.high,v.low,h.low),d.uniformMatrix4fv(this.uMatrix,!1,o.elements),d.uniform1f(this.u_wireframe,0),d.drawElements(d.TRIANGLES,this.buffers.length,d.UNSIGNED_BYTE,0)}},{key:"destroy",value:function(){this.buffers&&(this.buffers.vertices.delete(),this.buffers.indices.delete()),this.vertices=null,this.indices=null,(0,_.default)(e.prototype.__proto__||(0,l.default)(e.prototype),"destroy",this).call(this)}}]),e}(x.default);e.default=w},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(16),r=i(o),a=n(3),s=i(a),l=n(0),u=i(l),c=n(1),f=i(c),d=n(5),h=i(d),v=n(35),p=i(v),_=n(4),m=i(_),g=n(211),y=i(g),x=n(110),b=n(139),S=n(212),w=i(S),E=n(219),T=n(10),A=i(T),P=function(t){function e(t){(0,u.default)(this,e);var n=(0,h.default)(this,(e.__proto__||(0,s.default)(e)).call(this,t)),i=t.attribList||[],o=t.uniformList||[];return n.shaderParams={attributes:i.concat(["positions","instancePositions","instancePositions64xyLow","instanceSizes","instanceInfos","instancePickingColors","instanceFrames","instancePixelOffset"]),uniforms:o.concat(["uMatrix","uCenter","uZoom","uPixelsPerMeter","uResolution","uProject_uCommonUnitsPerWorldUnit","uProject_uCommonUnitsPerWorldUnit2","picking_usePickingColor","picking_zindex","u_sizeScale","u_sizeMinPixels","u_sizeMaxPixels","u_textureDim","u_opacity","u_sampler","u_mapScale"])},n.modelPositions=new Int16Array([-1,-1,0,-1,1,0,1,1,0,1,-1,0]),n.store=new x.Store("buffer",128,16,E.deleteInstanceCacllback),n.symbolManager=null,n}return(0,m.default)(e,t),(0,f.default)(e,[{key:"draw",value:function(t,e,n,i){var o=this.gl;if(e&&this.symbolManager.canvas){var r=t.center,a=t.zoom,s=t.getDistanceRatio(),l=i.distanceScales,u=(0,b.splitLatLngNumber)(r.lat),c=(0,b.splitLatLngNumber)(r.lng);o.useProgram(o.program),o.uniformMatrix4fv(this.uMatrix,!1,e.elements),o.uniform4f(this.uCenter,c.high,u.high,c.low,u.low),o.uniform1f(this.uZoom,a),o.uniform3f(this.uPixelsPerMeter,s,s,s),o.uniform3f(this.uProject_uCommonUnitsPerWorldUnit,l.pixelsPerDegree[0],l.pixelsPerDegree[1],l.pixelsPerDegree[2]),o.uniform3f(this.uProject_uCommonUnitsPerWorldUnit2,l.pixelsPerDegree2[0],l.pixelsPerDegree2[1],l.pixelsPerDegree2[2]),o.uniform2f(this.uResolution,t.width,t.height),o.uniform1f(this.picking_usePickingColor,i.usePicking?1:0),o.uniform1f(this.picking_zindex,i.picking_zindex||0),o.uniform1f(this.u_sizeScale,1),o.uniform1f(this.u_sizeMinPixels,0),o.uniform1f(this.u_sizeMaxPixels,1e3),o.uniform2f(this.u_textureDim,this.symbolManager.canvas.width,this.symbolManager.canvas.height),o.uniform1f(this.u_opacity,1),o.uniform1f(this.u_mapScale,t.scale),this._onDraw(),this.drawTileInstance(n.uid,n)}}},{key:"drawTileInstance",value:function(t,e){var n=this.gl,i=this.store,o=!1;if(i){if(i.exist(t)){var r=i.get(t).instanceBuffers;this.isBufferChanged(r,e)&&(o=!0)}else i.set(t,this.createBuffer(t,e));var a=i.get(t);a.positions.bind(),a.positions.pointToAttrib({location:this.positions,size:3,type:n.SHORT}),A.default.forIn(a.instanceBuffers,function(t,i){var r=i.buffer,a=i.location,s=i.size,l=i.type;r.bind(),o&&(r.bufferData(e[t],{usage:n.DYNAMIC_DRAW}),i.data=e[t]),r.pointToAttrib({location:a,size:s,type:l}),n.vertexAttribDivisor(a,1)}),n.drawArraysInstanced(n.TRIANGLE_FAN,0,4,e.count),n.bindBuffer(n.ARRAY_BUFFER,null),n.vertexAttribDivisor(this.instancePositions,0),n.vertexAttribDivisor(this.instancePositions64xyLow,0),n.vertexAttribDivisor(this.instanceSizes,0),n.vertexAttribDivisor(this.instanceInfos,0),n.vertexAttribDivisor(this.instancePickingColors,0),n.vertexAttribDivisor(this.instanceFrames,0),n.vertexAttribDivisor(this.instancePixelOffset,0),this._onDrawInstanceTile()}}},{key:"getInstanceConfig",value:function(){var t=this.gl;return{instancePositionList:{location:this.instancePositions,size:3,type:t.FLOAT},instancePosition64xyLowList:{location:this.instancePositions64xyLow,size:2,type:t.FLOAT},instanceSizeList:{location:this.instanceSizes,size:2,type:t.UNSIGNED_SHORT},instanceInfoList:{location:this.instanceInfos,size:4,type:t.FLOAT},instancePickingColorList:{location:this.instancePickingColors,size:3,type:t.UNSIGNED_BYTE},instanceFrameList:{location:this.instanceFrames,size:4,type:t.FLOAT},instancePixelOffsetList:{location:this.instancePixelOffset,size:3,type:t.FLOAT}}}},{key:"createBuffer",value:function(t,e){var n=this.gl,i={positions:null,indices:null,instanceBuffers:{}};if(this.modelPositions&&(i.positions=new w.default(n,{data:this.modelPositions})),e){var o=this.getInstanceConfig();A.default.forIn(o,function(t,o){i.instanceBuffers[t]=(0,r.default)({data:e[t],buffer:new w.default(n,{data:e[t],usage:n.DYNAMIC_DRAW})},o)})}return i}},{key:"afterDraw",value:function(){this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"loadTexture",value:function(){this.symbolManager.canvas&&this.symbolManager.uploadToGPU({textureIndex:0,minFilter:this.gl.LINEAR,magFilter:this.gl.LINEAR,wrapS:this.gl.CLAMP_TO_EDGE,wrapT:this.gl.CLAMP_TO_EDGE,premultiply:!0,useMipmap:!1,flipY:!0})}},{key:"_onDraw",value:function(){}},{key:"_onDrawInstanceTile",value:function(){}},{key:"destroy",value:function(){this.modelPositions=null,this.symbolManager=null,(0,p.default)(e.prototype.__proto__||(0,s.default)(e.prototype),"destroy",this).call(this)}}]),e}(y.default);e.default=P},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return{x:t&&t.width||1,y:t&&t.height||1}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(16),a=i(r),s=n(17),l=i(s),u=n(3),c=i(u),f=n(0),d=i(f),h=n(1),v=i(h),p=n(5),_=i(p),m=n(35),g=i(m),y=n(4),x=i(y),b=n(305),S=i(b),w=n(605),E=i(w),T=n(606),A=i(T),P=n(213),I=i(P),k=n(110),L=n(212),M=i(L),C=n(10),R=i(C),B=n(28),N=i(B),O=1/16/N.default.devicePixelRatio,D=function(t){function e(t){(0,d.default)(this,e);var n=(0,_.default)(this,(e.__proto__||(0,c.default)(e)).call(this,t));return n.textCache=t.textCache,n.glyphManager=t.glyphManager,n.markerManager=t.markerManager,n.shaderSource=n.textCache?A.default:E.default,n._store=new k.Store("buffer",100,16,function(t){t.positions&&t.positions.delete(),t.indices&&t.indices.delete(),t.instanceBuffers&&(0,l.default)(t.instanceBuffers).forEach(function(e){var n=t.instanceBuffers[e];n.data=null,n.buffer.delete()})}),n.shaderParams={attributes:["a_Positions","a_InstanceTrans","a_InstanceCoords","a_InstanceTextBounds","a_InstanceStrentchinglens","a_InstanceInfo","a_InstanceColors","a_InstanceStrokeColors","a_InstancePickingColors","a_InstanceStrokeWidth"],uniforms:["u_matrix","u_resolution","u_fadeChange","u_showPoint","u_showLabel","u_mapScale","u_InstanceTileTextureOffset","u_iconTextureResolution","u_billboardTextureResolution","u_textTextureResolution","u_glyphTextureResolution","u_SamplerGlyph","u_SamplerText","u_SamplerIcon","u_SamplerMask","u_asbackground","u_gamma","u_buffer","u_maskScale","u_sdfRadius","picking_useFeaturePickingColor"]},n.positions=new Int16Array([-1,1,1,1,-1,-1,1,-1]),n.indices=new Uint8Array([0,2,1,1,2,3]),n}return(0,x.default)(e,t),(0,v.default)(e,[{key:"setCommonUniforms",value:function(t,e){var n=this.gl;n.uniform2f(this.u_resolution,t.width,t.height),n.uniform2f(this.u_billboardTextureResolution,o(this.markerManager.canvas).x,o(this.markerManager.canvas).y),n.uniform2f(this.u_textTextureResolution,o(this.textCache).x,o(this.textCache).y),n.uniform2f(this.u_glyphTextureResolution,o(this.glyphManager.canvas).x,o(this.glyphManager.canvas).y),n.uniform2f(this.u_iconTextureResolution,o(e.iconsLoader.img).x,o(e.iconsLoader.img).y),n.uniform1f(this.u_asbackground,e.asBackground?1:0),n.uniform1f(this.u_fadeChange,e.fadeChange||0),n.uniform1f(this.u_maskScale,e.maskScale||1),n.uniform1f(this.u_showPoint,!1===e.showPoint?0:1),n.uniform1f(this.u_showLabel,!1===e.showLabel?0:1),n.uniform1f(this.u_mapScale,t.scale),n.uniform1f(this.picking_useFeaturePickingColor,e.usePicking?1:0),n.uniform1i(this.u_SamplerText,0),n.uniform1i(this.u_SamplerGlyph,2),n.uniform1f(this.u_gamma,O),n.uniform1f(this.u_buffer,.71),n.uniform1f(this.u_sdfRadius,this.glyphManager.setting.radius)}},{key:"draw",value:function(t,e,n,i){var o=this,r=this.gl;n&&((0,l.default)(n.textDataSet).length>0||(0,l.default)(n.poiDataSet).length>0)&&(r.useProgram(r.program),this.setCommonUniforms(t,i),r.uniform1i(this.u_SamplerIcon,1),r.uniform1i(this.u_SamplerMask,3),R.default.forIn(e,function(e,a){var s=e+"_"+Math.round(t.zoom);if(n.instanceSet[s]&&!n.instanceSet[s].isIndoor&&(!o.textCache||o.textCache.tiles[e])){var l=o.textCache&&o.textCache.tiles[e]||{},u=n.instanceSet[s];r.uniformMatrix4fv(o.u_matrix,!1,a.elements),r.uniform2f(o.u_InstanceTileTextureOffset,l.x||0,l.y||0),o.drawTileInstance(s,u,i.updateSubData)}}))}},{key:"drawTileInstance",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!(e.count<1)){var o=this.gl,r=this._store;r.exist(t)||r.set(t,this.createBuffer(t,e,i));var a=r.get(t);a.positions.bind(),a.positions.pointToAttrib({location:this.a_Positions,size:2,type:o.SHORT}),a.indices.bind(),R.default.forIn(a.instanceBuffers,function(t,i){var r=i.buffer,a=i.location,s=i.size,l=i.type;r.bind(),n&&i.updatable&&(r.bufferData(e[t],{usage:o.DYNAMIC_DRAW}),i.data=e[t]),r.pointToAttrib({location:a,size:s,type:l}),o.vertexAttribDivisor(a,1)}),o.drawElementsInstanced(o.TRIANGLES,this.indices.length,o.UNSIGNED_BYTE,0,e.count),o.bindBuffer(o.ARRAY_BUFFER,null),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,null),o.vertexAttribDivisor(this.a_InstanceTrans,0),o.vertexAttribDivisor(this.a_InstanceCoords,0),o.vertexAttribDivisor(this.a_InstanceTextBounds,0),o.vertexAttribDivisor(this.a_InstanceInfo,0),this.textCache||(!i&&o.vertexAttribDivisor(this.a_InstanceStrentchinglens,0),o.vertexAttribDivisor(this.a_InstanceColors,0),o.vertexAttribDivisor(this.a_InstanceStrokeColors,0),!i&&o.vertexAttribDivisor(this.a_InstancePickingColors,0),!i&&o.vertexAttribDivisor(this.a_InstanceStrokeWidth,0))}}},{key:"createBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.gl,o={positions:null,indices:null,instanceBuffers:{}};if(this.positions&&(o.positions=new M.default(i,{data:this.positions})),this.indices&&(o.indices=new M.default(i,{target:i.ELEMENT_ARRAY_BUFFER,data:this.indices})),e){var r={instanceTransTypeArray:{location:this.a_InstanceTrans,size:3,type:i.FLOAT,updatable:!0},instanceCoordsTypeArray:{location:this.a_InstanceCoords,size:4,type:i.FLOAT},instanceTextBoundsTypeArray:{location:this.a_InstanceTextBounds,size:4,type:i.FLOAT,updatable:!0},instanceInfosTypeArray:{location:this.a_InstanceInfo,size:4,type:i.FLOAT,updatable:!0}};this.textCache||(!n&&(r.instanceStrentchinglensTypeArray={location:this.a_InstanceStrentchinglens,size:2,type:i.FLOAT,updatable:!0}),r.instanceColorsTypeArray={location:this.a_InstanceColors,size:4,type:i.UNSIGNED_BYTE},r.instanceStrokeColorsTypeArray={location:this.a_InstanceStrokeColors,size:4,type:i.UNSIGNED_BYTE},!n&&(r.instancePickingColorsTypeArray={location:this.a_InstancePickingColors,size:4,type:i.UNSIGNED_BYTE}),!n&&(r.instanceStrokeWidthTypeArray={location:this.a_InstanceStrokeWidth,size:1,type:i.FLOAT})),R.default.forIn(r,function(t,n){o.instanceBuffers[t]=(0,a.default)({data:e[t],buffer:new M.default(i,{data:e[t],usage:i.DYNAMIC_DRAW})},n)})}return o}},{key:"afterDraw",value:function(){(0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"afterDraw",this).call(this),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"loadTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.textCache?this.textCache.loadTexture():this.loadManagerTexture(this.markerManager,0),this.loadIconTexture(t),this.loadManagerTexture(this.glyphManager,2),t.maskTexture&&t.maskTexture.bind(this.gl,{textureIndex:3})}},{key:"loadIconTexture",value:function(t){var e=t.iconsLoader;if(e&&e.img){var n=this.gl;if(this.texture)this.texture.bind(null,{textureIndex:1});else{n.useProgram(n.program);var i=new I.default(n,{pixels:e.img});i.upload({flipY:!0,textureIndex:1});var o=n.getUniformLocation(n.program,"u_SamplerIcon");n.uniform1i(o,1),this.texture=i}}}},{key:"loadManagerTexture",value:function(t,e){t&&t.canvas&&t.uploadToGPU({textureIndex:e,minFilter:this.gl.LINEAR,magFilter:this.gl.LINEAR,wrapS:this.gl.CLAMP_TO_EDGE,wrapT:this.gl.CLAMP_TO_EDGE,premultiply:!0,useMipmap:!1,flipY:!0})}},{key:"clear",value:function(){this._store.clear(),this.texture&&(this.texture.destroy(),this.texture=null)}},{key:"destroy",value:function(){this.textCache=null,this.glyphManager=null,this.markerManager=null,this.positions=null,this.indices=null,this._store.clear(),this._store=null,this.texture&&(this.texture.destroy(),this.texture=null),(0,g.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"destroy",this).call(this)}}]),e}(S.default);e.default=D},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(16),r=i(o),a=n(3),s=i(a),l=n(0),u=i(l),c=n(1),f=i(c),d=n(5),h=i(d),v=n(4),p=i(v),_=n(280),m=i(_),g=n(213),y=i(g),x=n(517),b=i(x),S=n(41),w=i(S),E=function(t){function e(t,n){return(0,u.default)(this,e),(0,h.default)(this,(e.__proto__||(0,s.default)(e)).call(this,t,n))}return(0,p.default)(e,t),(0,f.default)(e,[{key:"_onCreate",value:function(){return this.gl.createFramebuffer()}},{key:"_onDelete",value:function(t){t||(this._colorAttach.forEach(function(t){return t.delete()}),this._depthAttach.delete()),this._colorAttach=null,this._depthAttach=null,this.unbind(!0),this.gl.deleteFramebuffer(this._object)}},{key:"_initialize",value:function(t){var e=this,n=t.width,i=void 0===n?1:n,o=t.height,r=void 0===o?1:o,a=t.attachments,s=void 0===a?{}:a,l=t.drawBuffers;this.width=i,this.height=r,this._colorAttach=[],this._depthAttach=null;var u=void 0,c=void 0;s&&(u=s.color,c=s.depth),w.default.isArray(u)?u.forEach(function(t,n){e.attach("color",t,{colorIndex:n})}):this.attach("color",u),this.attach("depth",c),l&&this.setDrawBuffers(l)}},{key:"_createDefaultAttachment",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.gl,i=null;switch(t){case"color":i=new y.default(n,(0,r.default)({pixels:null},e));break;case"depth":i=new b.default(n,e)}return i}},{key:"bind",value:function(t){t=t||this.gl,t.bindFramebuffer(t.FRAMEBUFFER,this._object),t.frameBuffer=this}},{key:"unbind",value:function(t){t||(this._colorAttach.forEach(function(t){return t.unbind()}),this._depthAttach.unbind()),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.frameBuffer=null}},{key:"attach",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.resizeAttach,o=void 0===i||i,r=n.colorIndex,a=void 0===r?0:r,s=this.gl,l=this.width,u=this.height;switch(this.bind(),e instanceof y.default||e instanceof b.default||(e=this._createDefaultAttachment(t,e)),o&&e.resize(l,u),t){case"color":s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+a,s.TEXTURE_2D,e.texture,0),this._colorAttach[a]=e;break;case"depth":var c="DEPTH24_STENCIL8"===e.internalformat?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;e instanceof b.default?s.framebufferRenderbuffer(s.FRAMEBUFFER,c,s.RENDERBUFFER,e.buffer):e instanceof y.default&&s.framebufferTexture2D(s.FRAMEBUFFER,c,s.TEXTURE_2D,e.texture,0),this._depthAttach=e}}},{key:"checkStatus",value:function(){this.bind();var t=this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER);return t===this.gl.FRAMEBUFFER_COMPLETE||(console.error("Framebuffer object is incomplete: "+t.toString()+"."),!1)}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.width=t,this.height=e,this._colorAttach.forEach(function(n){return n.resize(t,e)}),this._depthAttach.resize(t,e,{minFilter:this.gl.NEAREST,magFilter:this.gl.NEAREST})}},{key:"copy",value:function(t){var e=this.gl,n=this.width,i=this.height;if(e.isWebGL2){this.bind();var o=t?t._object:null;e.bindFramebuffer(e.READ_FRAMEBUFFER,o),e.blitFramebuffer(0,0,n,i,0,0,n,i,e.COLOR_BUFFER_BIT,e.NEAREST)}else t&&t.bind(e),this.color.copy()}},{key:"setDrawBuffers",value:function(t){this.bind();var e=this.gl,n=t.map(function(t){return e[t]});e.drawBuffers(n)}},{key:"getColorAttach",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._colorAttach[t]}},{key:"color",get:function(){return this._colorAttach[0]}},{key:"depth",get:function(){return this._depthAttach}},{key:"texture",get:function(){return this._colorAttach[0].texture}},{key:"buffer",get:function(){return this._object}}]),e}(m.default);e.default=E},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=i(o),a=n(0),s=i(a),l=n(1),u=i(l),c=n(5),f=i(c),d=n(4),h=i(d),v=n(280),p=i(v),_=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.default)(this,e),(0,f.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t,n))}return(0,h.default)(e,t),(0,u.default)(e,[{key:"_onCreate",value:function(){return this.gl.createRenderbuffer()}},{key:"_onDelete",value:function(){this.unbind(),this.gl.deleteRenderbuffer(this._object)}},{key:"_initialize",value:function(t){var e=t.width,n=void 0===e?1:e,i=t.height,o=void 0===i?1:i,r=t.internalformat,a=void 0===r?"DEPTH_COMPONENT16":r;this.width=n,this.height=o,this.internalformat=a}},{key:"bind",value:function(t){t=t||this.gl,t.bindRenderbuffer(t.RENDERBUFFER,this._object)}},{key:"unbind",value:function(){this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,null)}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.width=t,this.height=e,this.bind();var n=this.internalformat,i=this.gl;this.gl.renderbufferStorage(i.RENDERBUFFER,i[n],t,e)}},{key:"buffer",get:function(){return this._object}}]),e}(p.default);e.default=_},function(t,e,n){"use strict";function i(t,e,n,i,o,r){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=o||"sans-serif",this.fontWeight=r||"normal",this.radius=n||8,this.size=this.fontSize+2*this.buffer;var a=this.size;this.canvas=document.createElement("canvas"),this.canvas.width=a,this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(t,e,n,i,o,a,s){for(var l=0;l<e;l++){for(var u=0;u<n;u++)i[u]=t[u*e+l];r(i,o,a,s,n);for(var c=0;c<n;c++)t[c*e+l]=o[c]}for(var f=0;f<n;f++){for(var d=0;d<e;d++)i[d]=t[f*e+d];r(i,o,a,s,e);for(var h=0;h<e;h++)t[f*e+h]=Math.sqrt(o[h])}}function r(t,e,n,i,o){n[0]=0,i[0]=-a,i[1]=+a;for(var r=1,s=0;r<o;r++){for(var l=(t[r]+r*r-(t[n[s]]+n[s]*n[s]))/(2*r-2*n[s]);l<=i[s];)s-=1,l=(t[r]+r*r-(t[n[s]]+n[s]*n[s]))/(2*r-2*n[s]);s+=1,n[s]=r,i[s]=l,i[s+1]=+a}for(var u=0,c=0;u<o;u++){for(;i[c+1]<u;)c+=1;e[u]=(u-n[c])*(u-n[c])+t[n[c]]}}t.exports=i,t.exports.default=i;var a=1e20;i.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var r=e.data[4*i+3]/255;this.gridOuter[i]=1===r?0:0===r?a:Math.pow(Math.max(0,.5-r),2),this.gridInner[i]=1===r?a:0===r?0:Math.pow(Math.max(0,r-.5),2)}o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z);for(var s=0;s<this.size*this.size;s++){var l=this.gridOuter[s]-this.gridInner[s];n[s]=Math.max(0,Math.min(255,Math.round(255-255*(l/this.radius+this.cutoff))))}return n}},function(t,e,n){var i=n(244);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=i(t))throw TypeError(e);return+t}},function(t,e,n){"use strict";var i=n(136),o=n(269),r=n(88);t.exports=[].copyWithin||function(t,e){var n=i(this),a=r(n.length),s=o(t,a),l=o(e,a),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?a:o(u,a))-l,a-s),f=1;for(l<s&&s<l+c&&(f=-1,l+=c-1,s+=c-1);c-- >0;)l in n?n[s]=n[l]:delete n[s],s+=f,l+=f;return n}},function(t,e,n){var i=n(229),o=n(136),r=n(321),a=n(88);t.exports=function(t,e,n,s,l){i(e);var u=o(t),c=r(u),f=a(u.length),d=l?f-1:0,h=l?-1:1;if(n<2)for(;;){if(d in c){s=c[d],d+=h;break}if(d+=h,l?d<0:f<=d)throw TypeError("Reduce of empty array with no initial value")}for(;l?d>=0:f>d;d+=h)d in c&&(s=e(s,c[d],d,u));return s}},function(t,e,n){var i=n(825);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){"use strict";var i=n(229),o=n(63),r=n(527),a=[].slice,s={},l=function(t,e,n){if(!(e in s)){for(var i=[],o=0;o<e;o++)i[o]="a["+o+"]";s[e]=Function("F,a","return new F("+i.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=i(this),n=a.call(arguments,1),s=function(){var i=n.concat(a.call(arguments));return this instanceof s?l(e,i.length,i):r(e,i,t)};return o(e.prototype)&&(s.prototype=e.prototype),s}},function(t,e,n){"use strict";var i=n(104).f,o=n(264),r=n(286),a=n(231),s=n(284),l=n(348),u=n(430),c=n(531),f=n(287),d=n(103),h=n(253).fastKey,v=n(271),p=d?"_s":"size",_=function(t,e){var n,i=h(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,u){var c=t(function(t,i){s(t,c,e,"_i"),t._t=e,t._i=o(null),t._f=void 0,t._l=void 0,t[p]=0,void 0!=i&&l(i,n,t[u],t)});return r(c.prototype,{clear:function(){for(var t=v(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[p]=0},delete:function(t){var n=v(this,e),i=_(n,t);if(i){var o=i.n,r=i.p;delete n._i[i.i],i.r=!0,r&&(r.n=o),o&&(o.p=r),n._f==i&&(n._f=o),n._l==i&&(n._l=r),n[p]--}return!!i},forEach:function(t){v(this,e);for(var n,i=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!_(v(this,e),t)}}),d&&i(c.prototype,"size",{get:function(){return v(this,e)[p]}}),c},def:function(t,e,n){var i,o,r=_(t,e);return r?r.v=n:(t._l=r={i:o=h(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=r),i&&(i.n=r),t[p]++,"F"!==o&&(t._i[o]=r)),t},getEntry:_,setStrong:function(t,e,n){u(t,e,function(t,n){this._t=v(t,e),this._k=n,this._l=void 0},function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?"keys"==e?c(0,n.k):"values"==e?c(0,n.v):c(0,[n.k,n.v]):(t._t=void 0,c(1))},n?"entries":"values",!n,!0),f(e)}}},function(t,e,n){"use strict";var i=n(286),o=n(253).getWeak,r=n(60),a=n(63),s=n(284),l=n(348),u=n(230),c=n(214),f=n(271),d=u(5),h=u(6),v=0,p=function(t){return t._l||(t._l=new _)},_=function(){this.a=[]},m=function(t,e){return d(t.a,function(t){return t[0]===e})};_.prototype={get:function(t){var e=m(this,t);if(e)return e[1]},has:function(t){return!!m(this,t)},set:function(t,e){var n=m(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=h(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,r){var u=t(function(t,i){s(t,u,e,"_i"),t._t=e,t._i=v++,t._l=void 0,void 0!=i&&l(i,n,t[r],t)});return i(u.prototype,{delete:function(t){if(!a(t))return!1;var n=o(t);return!0===n?p(f(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=o(t);return!0===n?p(f(this,e)).has(t):n&&c(n,this._i)}}),u},def:function(t,e,n){var i=o(r(e),!0);return!0===i?p(t).set(e,n):i[t._i]=n,t},ufstore:p}},function(t,e,n){t.exports=!n(103)&&!n(61)(function(){return 7!=Object.defineProperty(n(423)("div"),"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(63),o=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&o(t)===t}},function(t,e,n){var i=n(60);t.exports=function(t,e,n,o){try{return o?e(i(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&i(r.call(t)),e}}},function(t,e,n){"use strict";var i=n(264),o=n(268),r=n(288),a={};n(215)(a,n(78)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(a,{next:o(1,n)}),r(t,e+" Iterator")}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){"use strict";function i(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=o(e),this.reject=o(n)}var o=n(229);t.exports.f=function(t){return new i(t)}},function(t,e,n){"use strict";var i=n(103),o=n(267),r=n(351),a=n(322),s=n(136),l=n(321),u=Object.assign;t.exports=!u||n(61)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=i})?function(t,e){for(var n=s(t),u=arguments.length,c=1,f=r.f,d=a.f;u>c;)for(var h,v=l(arguments[c++]),p=f?o(v).concat(f(v)):o(v),_=p.length,m=0;_>m;)h=p[m++],i&&!d.call(v,h)||(n[h]=v[h]);return n}:u},function(t,e,n){var i=n(104),o=n(60),r=n(267);t.exports=n(103)?Object.defineProperties:function(t,e){o(t);for(var n,a=r(e),s=a.length,l=0;s>l;)i.f(t,n=a[l++],e[n]);return t}},function(t,e,n){var i=n(216),o=n(265).f,r={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return o(t)}catch(t){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==r.call(t)?s(t):o(i(t))}},function(t,e,n){var i=n(214),o=n(216),r=n(344)(!1),a=n(435)("IE_PROTO");t.exports=function(t,e){var n,s=o(t),l=0,u=[];for(n in s)n!=a&&i(s,n)&&u.push(n);for(;e.length>l;)i(s,n=e[l++])&&(~r(u,n)||u.push(n));return u}},function(t,e,n){var i=n(103),o=n(267),r=n(216),a=n(322).f;t.exports=function(t){return function(e){for(var n,s=r(e),l=o(s),u=l.length,c=0,f=[];u>c;)n=l[c++],i&&!a.call(s,n)||f.push(t?[n,s[n]]:s[n]);return f}}},function(t,e,n){var i=n(265),o=n(351),r=n(60),a=n(62).Reflect;t.exports=a&&a.ownKeys||function(t){var e=i.f(r(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var i=n(62).parseFloat,o=n(289).trim;t.exports=1/i(n(439)+"-0")!=-1/0?function(t){var e=o(String(t),3),n=i(e);return 0===n&&"-"==e.charAt(0)?-0:n}:i},function(t,e,n){var i=n(62).parseInt,o=n(289).trim,r=n(439),a=/^[-+]?0[xX]/;t.exports=8!==i(r+"08")||22!==i(r+"0x16")?function(t,e){var n=o(String(t),3);return i(n,e>>>0||(a.test(n)?16:10))}:i},function(t,e,n){var i=n(60),o=n(63),r=n(533);t.exports=function(t,e){if(i(t),o(e)&&e.constructor===t)return e;var n=r.f(t);return(0,n.resolve)(e),n.promise}},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){var i=n(88),o=n(438),r=n(245);t.exports=function(t,e,n,a){var s=String(r(t)),l=s.length,u=void 0===n?" ":String(n),c=i(e);if(c<=l||""==u)return s;var f=c-l,d=o.call(u,Math.ceil(f/u.length));return d.length>f&&(d=d.slice(0,f)),a?d+s:s+d}},function(t,e,n){var i=n(234),o=n(88);t.exports=function(t){if(void 0===t)return 0;var e=i(t),n=o(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var i=n(62),o=n(102),r=n(263),a=n(442),s=n(104).f;t.exports=function(t){var e=o.Symbol||(o.Symbol=r?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){"use strict";var i,o,r,a,s=n(263),l=n(62),u=n(231),c=n(320),f=n(11),d=n(63),h=n(229),v=n(284),p=n(348),_=n(323),m=n(440).set,g=n(832)(),y=n(533),x=n(833),b=n(355),S=n(542),w=l.TypeError,E=l.process,T=E&&E.versions,A=T&&T.v8||"",P=l.Promise,I="process"==c(E),k=function(){},L=o=y.f,M=!!function(){try{var t=P.resolve(1),e=(t.constructor={})[n(78)("species")]=function(t){t(k,k)};return(I||"function"==typeof PromiseRejectionEvent)&&t.then(k)instanceof e&&0!==A.indexOf("6.6")&&-1===b.indexOf("Chrome/66")}catch(t){}}(),C=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},R=function(t,e){if(!t._n){t._n=!0;var n=t._c;g(function(){for(var i=t._v,o=1==t._s,r=0;n.length>r;)!function(e){var n,r,a,s=o?e.ok:e.fail,l=e.resolve,u=e.reject,c=e.domain;try{s?(o||(2==t._h&&O(t),t._h=1),!0===s?n=i:(c&&c.enter(),n=s(i),c&&(c.exit(),a=!0)),n===e.promise?u(w("Promise-chain cycle")):(r=C(n))?r.call(n,l,u):l(n)):u(i)}catch(t){c&&!a&&c.exit(),u(t)}}(n[r++]);t._c=[],t._n=!1,e&&!t._h&&B(t)})}},B=function(t){m.call(l,function(){var e,n,i,o=t._v,r=N(t);if(r&&(e=x(function(){I?E.emit("unhandledRejection",o,t):(n=l.onunhandledrejection)?n({promise:t,reason:o}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",o)}),t._h=I||N(t)?2:1),t._a=void 0,r&&e.e)throw e.v})},N=function(t){return 1!==t._h&&0===(t._a||t._c).length},O=function(t){m.call(l,function(){var e;I?E.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},D=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),R(e,!0))},z=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw w("Promise can't be resolved itself");(e=C(t))?g(function(){var i={_w:n,_d:!1};try{e.call(t,u(z,i,1),u(D,i,1))}catch(t){D.call(i,t)}}):(n._v=t,n._s=1,R(n,!1))}catch(t){D.call({_w:n,_d:!1},t)}}};M||(P=function(t){v(this,P,"Promise","_h"),h(t),i.call(this);try{t(u(z,this,1),u(D,this,1))}catch(t){D.call(this,t)}},i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n(286)(P.prototype,{then:function(t,e){var n=L(_(this,P));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=I?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&R(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new i;this.promise=t,this.resolve=u(z,t,1),this.reject=u(D,t,1)},y.f=L=function(t){return t===P||t===a?new r(t):o(t)}),f(f.G+f.W+f.F*!M,{Promise:P}),n(288)(P,"Promise"),n(287)("Promise"),a=n(102).Promise,f(f.S+f.F*!M,"Promise",{reject:function(t){var e=L(this);return(0,e.reject)(t),e.promise}}),f(f.S+f.F*(s||!M),"Promise",{resolve:function(t){return S(s&&this===a?P:this,t)}}),f(f.S+f.F*!(M&&n(350)(function(t){P.all(t).catch(k)})),"Promise",{all:function(t){var e=this,n=L(e),i=n.resolve,o=n.reject,r=x(function(){var n=[],r=0,a=1;p(t,!1,function(t){var s=r++,l=!1;n.push(void 0),a++,e.resolve(t).then(function(t){l||(l=!0,n[s]=t,--a||i(n))},o)}),--a||i(n)});return r.e&&o(r.v),n.promise},race:function(t){var e=this,n=L(e),i=n.reject,o=x(function(){p(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return o.e&&i(o.v),n.promise}})},function(t,e,n){"use strict";var i=n(433);n(11)({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},function(t,e,n){n(103)&&"g"!=/./g.flags&&n(104).f(RegExp.prototype,"flags",{configurable:!0,get:n(347)})},function(t,e,n){!function(i,o){t.exports=e=o(n(50))}(0,function(t){return function(e){var n=t,i=n.lib,o=i.WordArray,r=i.Hasher,a=n.algo,s=[],l=[];!function(){function t(t){return 4294967296*(t-(0|t))|0}for(var n=2,i=0;i<64;)(function(t){for(var n=e.sqrt(t),i=2;i<=n;i++)if(!(t%i))return!1;return!0})(n)&&(i<8&&(s[i]=t(e.pow(n,.5))),l[i]=t(e.pow(n,1/3)),i++),n++}();var u=[],c=a.SHA256=r.extend({_doReset:function(){this._hash=new o.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],o=n[1],r=n[2],a=n[3],s=n[4],c=n[5],f=n[6],d=n[7],h=0;h<64;h++){if(h<16)u[h]=0|t[e+h];else{var v=u[h-15],p=(v<<25|v>>>7)^(v<<14|v>>>18)^v>>>3,_=u[h-2],m=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;u[h]=p+u[h-7]+m+u[h-16]}var g=s&c^~s&f,y=i&o^i&r^o&r,x=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),b=(s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25),S=d+b+g+l[h]+u[h],w=x+y;d=f,f=c,c=s,s=a+S|0,a=r,r=o,o=i,i=S+w|0}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+r|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+c|0,n[6]=n[6]+f|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(i/4294967296),n[15+(o+64>>>9<<4)]=i,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});n.SHA256=r._createHelper(c),n.HmacSHA256=r._createHmacHelper(c)}(Math),t.SHA256})},function(t,e,n){!function(i,o,r){t.exports=e=o(n(50),n(356))}(0,function(t){return function(){function e(){return a.create.apply(a,arguments)}var n=t,i=n.lib,o=i.Hasher,r=n.x64,a=r.Word,s=r.WordArray,l=n.algo,u=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],c=[];!function(){for(var t=0;t<80;t++)c[t]=e()}();var f=l.SHA512=o.extend({_doReset:function(){this._hash=new s.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],o=n[1],r=n[2],a=n[3],s=n[4],l=n[5],f=n[6],d=n[7],h=i.high,v=i.low,p=o.high,_=o.low,m=r.high,g=r.low,y=a.high,x=a.low,b=s.high,S=s.low,w=l.high,E=l.low,T=f.high,A=f.low,P=d.high,I=d.low,k=h,L=v,M=p,C=_,R=m,B=g,N=y,O=x,D=b,z=S,F=w,V=E,Y=T,U=A,j=P,G=I,Z=0;Z<80;Z++){var H=c[Z];if(Z<16)var W=H.high=0|t[e+2*Z],X=H.low=0|t[e+2*Z+1];else{var Q=c[Z-15],q=Q.high,K=Q.low,J=(q>>>1|K<<31)^(q>>>8|K<<24)^q>>>7,$=(K>>>1|q<<31)^(K>>>8|q<<24)^(K>>>7|q<<25),tt=c[Z-2],et=tt.high,nt=tt.low,it=(et>>>19|nt<<13)^(et<<3|nt>>>29)^et>>>6,ot=(nt>>>19|et<<13)^(nt<<3|et>>>29)^(nt>>>6|et<<26),rt=c[Z-7],at=rt.high,st=rt.low,lt=c[Z-16],ut=lt.high,ct=lt.low,X=$+st,W=J+at+(X>>>0<$>>>0?1:0),X=X+ot,W=W+it+(X>>>0<ot>>>0?1:0),X=X+ct,W=W+ut+(X>>>0<ct>>>0?1:0);H.high=W,H.low=X}var ft=D&F^~D&Y,dt=z&V^~z&U,ht=k&M^k&R^M&R,vt=L&C^L&B^C&B,pt=(k>>>28|L<<4)^(k<<30|L>>>2)^(k<<25|L>>>7),_t=(L>>>28|k<<4)^(L<<30|k>>>2)^(L<<25|k>>>7),mt=(D>>>14|z<<18)^(D>>>18|z<<14)^(D<<23|z>>>9),gt=(z>>>14|D<<18)^(z>>>18|D<<14)^(z<<23|D>>>9),yt=u[Z],xt=yt.high,bt=yt.low,St=G+gt,wt=j+mt+(St>>>0<G>>>0?1:0),St=St+dt,wt=wt+ft+(St>>>0<dt>>>0?1:0),St=St+bt,wt=wt+xt+(St>>>0<bt>>>0?1:0),St=St+X,wt=wt+W+(St>>>0<X>>>0?1:0),Et=_t+vt,Tt=pt+ht+(Et>>>0<_t>>>0?1:0);j=Y,G=U,Y=F,U=V,F=D,V=z,z=O+St|0,D=N+wt+(z>>>0<O>>>0?1:0)|0,N=R,O=B,R=M,B=C,M=k,C=L,L=St+Et|0,k=wt+Tt+(L>>>0<St>>>0?1:0)|0}v=i.low=v+L,i.high=h+k+(v>>>0<L>>>0?1:0),_=o.low=_+C,o.high=p+M+(_>>>0<C>>>0?1:0),g=r.low=g+B,r.high=m+R+(g>>>0<B>>>0?1:0),x=a.low=x+O,a.high=y+N+(x>>>0<O>>>0?1:0),S=s.low=S+z,s.high=b+D+(S>>>0<z>>>0?1:0),E=l.low=E+V,l.high=w+F+(E>>>0<V>>>0?1:0),A=f.low=A+U,f.high=T+Y+(A>>>0<U>>>0?1:0),I=d.low=I+G,d.high=P+j+(I>>>0<G>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),e[31+(i+128>>>10<<5)]=n,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32});n.SHA512=o._createHelper(f),n.HmacSHA512=o._createHmacHelper(f)}(),t.SHA512})},function(t,e,n){"use strict";var i=n(255).assign,o=n(1015),r=n(1016),a=n(555),s={};i(s,o,r,a),t.exports=s},function(t,e,n){"use strict";function i(t,e){if(e<65534&&(t.subarray&&a||!t.subarray&&r))return String.fromCharCode.apply(null,o.shrinkBuf(t,e));for(var n="",i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n}var o=n(255),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var s=new o.Buf8(256),l=0;l<256;l++)s[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;s[254]=s[254]=1,e.string2buf=function(t){var e,n,i,r,a,s=t.length,l=0;for(r=0;r<s;r++)n=t.charCodeAt(r),55296==(64512&n)&&r+1<s&&56320==(64512&(i=t.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new o.Buf8(l),a=0,r=0;a<l;r++)n=t.charCodeAt(r),55296==(64512&n)&&r+1<s&&56320==(64512&(i=t.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|63&n):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e},e.buf2binstring=function(t){return i(t,t.length)},e.binstring2buf=function(t){for(var e=new o.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},e.buf2string=function(t,e){var n,o,r,a,l=e||t.length,u=new Array(2*l);for(o=0,n=0;n<l;)if((r=t[n++])<128)u[o++]=r;else if((a=s[r])>4)u[o++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;a>1&&n<l;)r=r<<6|63&t[n++],a--;a>1?u[o++]=65533:r<65536?u[o++]=r:(r-=65536,u[o++]=55296|r>>10&1023,u[o++]=56320|1023&r)}return i(u,o)},e.utf8border=function(t,e){var n;for(e=e||t.length,e>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0?e:0===n?e:n+s[t[n]]>e?n:e}},function(t,e,n){"use strict";function i(t,e,n,i){for(var o=65535&t|0,r=t>>>16&65535|0,a=0;0!==n;){a=n>2e3?2e3:n,n-=a;do{o=o+e[i++]|0,r=r+o|0}while(--a);o%=65521,r%=65521}return o|r<<16|0}t.exports=i},function(t,e,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,n){"use strict";function i(t,e,n,i){var r=o,a=i+n;t^=-1;for(var s=i;s<a;s++)t=t>>>8^r[255&(t^e[s])];return-1^t}var o=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();t.exports=i},function(t,e,n){"use strict";function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=i},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABkCAMAAAAIYWa2AAAC8VBMVEVHcEwAAAAAAAAAAAAAAAAzMzPQRUXlSUnnS0vqS0vrTEzhSEgAAADFRUXmS0vtTk7xTU3yTk7yTk6vPz/oTEzvTk7yTk7MRETrS0vyT0/FQUHFPj7uTU3yTk7sTExVKiroS0vyTk5IJCS4QEDuTU3SRETxTU0AAADhSkreSUkAAADoSkryTk7pSkoAAADoTEzmTEziSUndSEjMRETDQUFtJCTwTU3vTExfHx/mSUkAAADFPz/yTk68PDztTEwAAADMRUXBQUHsTEzqTEyzPj7yTk6lOTnjSUnfSEjuTk7yUVH2iYn6wMD95OT+9vYAAADBPT32hob95ub///+2OTkAAADfSUnyT0/5ra3aR0cAAADqS0vwTU3vTU0AAABmKChbJCTBPT24OjrQQkIAAADXRUXRQ0PVRUUAAADcR0fYRkYAAADXRETQQkLNRETIQkLDQUG9Pj6qNzegNTUhCwvxTk4cCQkAAADrTEwAAAAAAADkSkriSEgAAADLQUFnIiLyTk5gHx/oS0vnSkoAAAAAAADOQ0NLHh7wTk4/FRXaRkbXRUVuJSXxTU1vKCgAAADfSEjZRkYAAADwTU3vTU1XHBzSRETIQEAmDw/rTEzoSkoIBQWhNDSMLS3NQkIAAAAAAAAlDw/oSkrnSkqBKyvwTU3vTU1lISG5PT2qODgAAADURUXKQkIBAQHjSUncRkYAAAAAAAA1FBTkSkoYCgpjISHsS0s/FxcAAABtJSXsTU3pS0tTGhp0JibsTExYHR1bHBzsTExpIyOVMzPuTU19KyujNjbxTk7uTU2MLS2xOTnxTk6bMTHCPj60OTniSEjcR0fuTU07FxefNDTbR0fTRUXpS0uiNDThSEiDKyvXRkZ6JyfhSUmSLi7pS0vIQUFQGBjmSkrGQUGCKSntTEzrTEzdSEjbR0edMzOYMTHZR0eTLy8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6Ei6pAAAA+3RSTlMAAQIDBAUhRVhlcUYFFlSTzvX/EGC6/B6P8h8YmPiZBmvtBxe7MNwGVlcHhf6PCHx8WlwtLw7T1BCDCSz3LrQLNzqwsSX9KICC2///////DjL///81CnP//3UMtOPkERkcPkFcDWdqdg98fhBvcmFjUlY8Phf4GxTRFxKlqBZsJfopwMIaE3ci7iSRky/5MhimnBvy7C2DeiHVzSBIQoceFSLQxTvw6zVnWx2Qgh+3qSEZJsAkMtssHDbh1jE73zQ14jpL6UFU9e9IXfRScma0p+crU56T0k2vOpQ0rULLdCm4cTHY1JeWPD6aQC42PDkwKCsvMjQsKSUnKiijw/sAAAUASURBVHgB1M8DcoRBEIbhNNbutW3EtnP/E2V/rDUzKeUpo9/q7+gfATA/tSAiORARpjQLiMTs8fr8gWAw4A95PWEmO6SRII5EY/GEzCXisWgkzIodu5BMpTOyIZNOJZmsjEIim8vLDvlcIXwgYw3hYqkse5QrRTuz741qrS4H1GsN3lmx3mimRUGrGabtkwAo3O6Ikk67u3USIIV7eVGU7w82JwEgdYcjUTYablasRk60jCdrFQDqHoumk3ll3jgVbWfWokUDw+d50Za/GND8FUC+vBID1zddt2KNGdyKkdu7MLoR7N4/iJGHR3cQIN89iaGnZ+cVoO7LSAyNXicMYD/yJsben7sI1iMfn2Ls82vC0wjffcsf/DyH8ZdUskbLIIyBcJCSag+BQ4+36+7uisv58d+T6pt23ic6sH1wJ5CEKMmKqiqyJJKIoB3vwM6xTgKGaf3LNEjIdnZh99IlXM+3luR7BBaEB7B3FxGub63IJ7BIO4ZjLSZ2sdZEbJSkl3Ce4UkTzfUipojnLXfgssAbSNaGJJwsQ3Aq3JI3i8g4WdVw1+CWsllEwclWgzDALXWziIqTXQ/1wFpknKC+Z13n4bvII+thn1Kon1lf/DJB/cqxhY17myB8v2aL/cdXKWYNHLcWheGlcmt3r32URP2E1FeqQoatDJrRpI0sJTIzyTEzoxIzY9gMYWY0M1fRXWXOsizdvf18c/6Dv3SNNpBspH8DGMlRhgv8df9WwQ0h1HDaFuXfUopiSQNBR8f4sx5jYvkLhn9ChTh/FnV8AkPImy0xyR9IEidvNstpJjkFn5GSypJWeduHCmn4kPQE5rTFYJL1ZGTiMjKzhFD57hgtBC1m40Ju5vAXrCbkTgLZjFw8Rl4+RxFm+RbLoTBiAR6kMIdXDIo9lKJiHEZJqYACsUPkrHBlMRhmqzzBdsEeCKJYST4nXT+korIqVPFsinsMraqu0cuoLRWZ02CHkeNixLp6fYyGxhweeS2jw5XLgpp02b+AZskhBgSx0i09kNstHA1i0FMqJLS0ame0tXfYKwMQ5RPhAiN2lmhldHUn8IH/gBjntHT09Gpj1PT1s6GODxXntAQm5gwMamEMDUtVFOHCgLTIyc0ZGdXAuCMJNPq+8ISg5Iay/SMhxzF671Z6ZQCFquovb1Bn3LtfydEXrJBUD4oVUR6otu7DRy0c450BlNNUlTQ27psxMYkYUFxfFFqQpnzu3OmZFlGdAZTKWV+QuVLRRqow4K/DaYZrmffOeNzewasygIIGIP+JN8bo05zEwP/NJnUGDEDClJe9EPBMgmZXeTAAbP9zT8iLFoEmjmfAXqCETo9ZfNkN06+JYr1g63jlJihgsj/RY/rV0xKY2P/arTItAkyudkFvXFpufKCDgT8D2gUluOT2rcTqEOM4Re9inK5dj0jrEQOnqOO9A5Ldn2j/oNf1UG6ryoBx8gMKRIcYCMWW8BFOpqQnEHgoKwL4yk8djM5AoEB87F9/0vq5KlBnIBAKxX1RIPM5NjiZekMh2asK5CtHybcb63+5nNpvSm2yWMWaYer5jiA/kBojHsT0D8n+RJBfeGqgVRam5RW/yGLVBlqlanFpaRm8GVYoTPvK6tra+ka7TbcagEibW9s7q6u7G3v7lbgQy8Hh/tbe9vbK1tHhgcWA+Yj+w839o62j/cN+ApeBskIyPM8EQlaxQcd32W/E9Jewb6BBFAAAAABJRU5ErkJggg=="},function(t,e,n){"use strict";e.Event=n(106),e.Map=n(337).default,e.LatLng=n(47),e.LatLngBounds=n(209),e.Point=n(74),e.GradientColor=n(468),e.TVectorTileLayer=n(383).default,e.VectorTileLayer=n(383).default,e.ImageTileLayer=n(299).default,e.GrayTileLayer=n(662).default,e.CanvasGroundLayer=n(661).default,e.ImageGroundLayer=n(664).default,e.MaskLayer=n(486).default,e.WMTSLayer=n(669).default,e.WMSLayer=n(668).default,e.GeometryOverlay=n(303).default,e.MultiPolygon=n(338),e.PolygonStyle=n(218).PolygonStyle,e.ExtrudablePolygonStyle=n(218).ExtrudablePolygonStyle,e.MultiCircle=n(728),e.CircleStyle=n(218).CircleStyle,e.MultiRectangle=n(732),e.RectangleStyle=n(218).RectangleStyle,e.MultiEllipse=n(729),e.EllipseStyle=n(218).EllipseStyle,e.MultiPolyline=n(506),e.PolylineStyle=n(339).default,e.LabelStyle=n(391).default,e.MultiLabel=n(730),e.MultiMarker=n(731),e.MarkerStyle=n(505),e.InfoWindow=n(727).default,e.DOMOverlay=n(390).default,e.MarkerCluster=n(734).default,e.Light=n(512).default,e.VisualPlugin=n(749),e.ModelPlugin=n(510).default,e.LayerPlugin=n(510).default,e.constants={CONTROL_POSITION:n(248).CONTROL_POSITION,DEFAULT_CONTROL_ID:n(248).DEFAULT_CONTROL_ID,GEOMETRY_TYPES:n(220).GEOMETRY_TYPES,LIGHT_TYPE:n(341).LIGHT_TYPE,IMAGE_DISPLAY:n(137).IMAGE_DISPLAY,LAYER_LEVEL:n(143).LAYER_LEVEL,MAP_ZOOM_TYPE:n(304).MAP_ZOOM_TYPE},e.AnimatableMixin=n(470).animatableMixin},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(326);e.default={v:"\n    attribute vec2 a_Positions;\n    attribute vec4 a_InstanceCoords;\n    attribute vec4 a_InstanceColor;\n    attribute float a_InstanceWidth;\n\n    uniform mat4 u_matrix;\n    uniform sampler2D u_SamplerArrow;\n    uniform float u_mapScale;\n    uniform vec2 u_resolution;\n\t  varying vec2 v_TexCoord;\n\t  varying vec4 v_Color;\n    "+i.projectScreenPart+"\n\n\n\t  void main(){\n\t\n\t    vec2 wH = vec2(a_InstanceWidth * (20.0 / 4.0), a_InstanceWidth * (20.0 / 4.0));\n\t    vec2 startPt = a_InstanceCoords.xy;\n      vec2 endPt = a_InstanceCoords.zw;\n      vec2 wh = vec2(abs(endPt.x - startPt.x), abs(endPt.y - startPt.y));\n\t    vec2 transCoord = (startPt + endPt) / 2.0;\n      \n      vec2 start_proj = project(u_matrix * vec4(startPt, 0., 1.));\n      vec2 end_proj = project(u_matrix * vec4(endPt, 0., 1.));\n\n\t    vec4 center_proj = u_matrix * vec4(transCoord, 0., 1.);\n\t    \n      vec2 center_screen = project(center_proj);\n      vec2 delta = end_proj - start_proj;\n      float len = length(delta);\n      float angle_sin = delta.x / len;\n      float angle_cos = delta.y / len;\n      mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n      \n      vec2 positions = a_Positions * 0.5 + 0.5;\n\n      vec2 corner_screen =  rotation_matrix * vec2(\n        (wH.x * positions.x - wH.x * 0.5) * u_mapScale, \n        (wH.y * (positions.y - 1.0) + wH.y * 0.5) * u_mapScale\n      ) + center_screen.xy;\n\n      vec4 corner_proj = unproject(corner_screen, center_proj.z, center_proj.w);\n      gl_Position = corner_proj;\n\n      gl_PointSize = 100.0;\n\n\t    v_TexCoord = vec2(positions.x, positions.y);\n\t    v_Color = vec4(a_InstanceColor.rgb / 255.0, 1.0);\n\t  }\n  ",f:"\n    precision mediump float;\n    varying vec2 v_TexCoord;\n    varying vec4 v_Color;\n\n    uniform sampler2D u_SamplerArrow;\n    void main(void) {\n\t\t\tvec4 color = texture2D(u_SamplerArrow, v_TexCoord);\n      gl_FragColor = mix(vec4(0.0, 0.0, 0.0, 0.0), v_Color, step(0.5, color.a));\n\t\t} \n  ",name:"arrow"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(276),o=n(330),r=function(t){return t&&t.__esModule?t:{default:t}}(o),a=r.default?i.LIGHT_UNIFORM+i.LIGHT_VARYING+i.LIGHT_VERTEX:"",s=r.default?i.LIGHT_VARYING+i.LIGHT_FRAG:"";e.default={v:"\n\t\tprecision highp float;\n\t\tattribute vec2 a_Position;\n\t\tattribute vec4 a_Color;\n\t\tattribute vec2 a_Normal;\n\t\tattribute vec2 a_LineInfo;\n\t\tattribute float a_LineDistance;\n\t\tattribute vec2 a_SideInfo;\n\t\tattribute vec4 a_PickingColor;\n\n\t\tuniform mat4 u_matrix;\n\t\tuniform mat4 u_modelMatrix;\n\t\tuniform float u_SizeScale;\n\t\tuniform float picking_useFeaturePickingColor;\n\n\t\tvarying vec4 v_Color;\n\t\tvarying vec2 v_Normal;\n\t\tvarying vec2 v_LineInfo;\n\t\tvarying vec2 v_Pos;\n\t\tvarying float v_Transform;\n\t\tvarying float v_LineDistance;\n\t\tvarying float v_Width;\n\t\tvarying float v_opaque_part;\n\n\t\t"+a+"\n\n\t\tvoid main(){\n\n\t\t\tfloat isSide = fract(a_SideInfo.x / 2.) * 2.;\n\t\t\tfloat isNoSideLine = floor(a_SideInfo.x / 2.);\n\t\t\tv_opaque_part = mix(1.0, 0.0, smoothstep(0.0, 1.0, isSide * isNoSideLine));\n\n\t\t\tfloat zoom = floor(u_SizeScale / 1000.) / 100.;\n\t\t\tfloat scale = fract(u_SizeScale / 1000.) * 10.;\n\t\t\tfloat preWidth = floor(a_Position.x / 2048.0)/2.0;\n\t\t\tfloat nextWidth = floor(a_Position.y / 2048.0)/2.0;\n\n\t\t\tv_Color = mix(a_Color, a_PickingColor, picking_useFeaturePickingColor);\n\t\t\tv_Normal = a_Normal;\n\t\t\tv_LineInfo = a_LineInfo;\n\t\t\tv_LineDistance = floor(a_LineDistance/10.0);\n\t\t\tvec2 point = (fract(a_Position.xy / 2048.0) * 2048.0 - 1024.0) * 0.5;\n\n\t\t\t\n\t\t\tfloat width = a_LineInfo.x / 2.0;\n\t\t\tfloat nearWidth = mix(nextWidth, preWidth, step(0.5, zoom));\n\t\t\tv_Width = mix(\n\t\t\t\twidth,\n\t\t\t\tmix(\n\t\t\t\t\tmix(width, nextWidth, zoom),\n\t\t\t\t\tmix(preWidth, width, zoom),\n\t\t\t\t\tstep(0.5, zoom)\n\t\t\t\t),\n\t\t\t\tfloat(v_LineDistance > 0. && nearWidth > 0.)\n\t\t\t) / scale;\n\n\t\t\tv_Normal = vec2(a_Normal.x - 128.0, a_Normal.y - 128.0) / 63.;\n\t\t\tv_Pos = point + v_Normal * v_Width;\n\t\t\tv_Transform = a_SideInfo.y;\n\t\t\tgl_Position = u_matrix * vec4(v_Pos, 0.0, 1.0);\n\n\t\t\t\n\t\t\t"+(r.default?"lighting_apply_on_vertex(vec3(v_Pos, 0.0), vec3(0.0, 0.0, 1.0), u_modelMatrix, vec2(0.1, 16.0));":"")+"\n\t\t}\n\t",f:"\n\t\tprecision highp float;\n\t\tvarying vec4 v_Color;\n\t\tvarying vec2 v_Normal;\n\t\tvarying vec2 v_LineInfo;\n\t\tvarying vec2 v_Pos;\n\t\tvarying float v_Transform;\n\t\tvarying float v_LineDistance;\n\t\tvarying float v_Width;\n\t\tvarying float v_opaque_part;\n\n\t\t"+s+"\n\n\t\tvoid main(){\n\t\t\tvec4 f_Color;\n\t\t\tf_Color.r = v_Color.r / 255.0;\n\t\t\tf_Color.g = v_Color.g / 255.0;\n\t\t\tf_Color.b = v_Color.b / 255.0;\n\t\t\tf_Color.a = 1.0;\n\n\t\t\tfloat alpha = 1.0;\n\t\t\tfloat minAlpha = 0.0;\n\t\t\tfloat feather = min(v_Width * 0.3, 2.0);\n\n\t\t\t\n\t\t\tfloat transformByte = floor(v_Transform + 0.5);\n\t\t\tvec2 translate = vec2(fract(transformByte / 4.0) * 4.0, floor(fract(transformByte / 16.0) * 4.0));\n\t\t\tfloat scale = floor(transformByte / 16.0);\n\t\t\tvec2 coord = vec2(v_Pos.x, 0. - v_Pos.y) * scale - translate * 256.0;\n\t\t\tbool isOutSide = coord.x < 0. || coord.x > 256.0 || coord.y < 0. || coord.y > 256.0;\n\n\t\t\tfloat dist = abs(length(v_Normal) * v_Width);\n\t\t\tfloat isTransparent = float(\n\t\t\t\t(dist > v_Width || isOutSide) || \n\t\t\t\t(v_LineInfo.y> 0.0 && mod(v_LineDistance, floor(v_LineInfo.y/10.0) * (2.0-fract(v_LineInfo.y/10.0))) > floor(v_LineInfo.y/10.0))\n\t\t\t);\n\n\t\t\talpha = mix(\n\t\t\t\tmix(alpha, clamp((v_Width - dist) / feather, 0.0, 1.0), float(v_Width>0. && dist>(v_Width - feather))),\n\t\t\t\t0.0,\n\t\t\t\tisTransparent\n\t\t\t);\n\n\t\t\t\n\t\t\t"+(r.default?"vec4 colorInLight = lighting_apply_on_color(f_Color);":"vec4 colorInLight = f_Color;")+"\n\t\t\tgl_FragColor =  colorInLight * (v_Color.a /255.0) * alpha * v_opaque_part;\n\t\t}\n\t",name:"base"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={v:"\nattribute vec2 a_Position;\nattribute vec4 a_Info;\nuniform mat4 u_matrix;\nuniform mat4 u_modelMatrix;\nuniform mat4 u_lightPVMatrix;\nvarying vec4 v_pos;\nvarying vec4 v_flatNDCCoord;\n\nvoid main(){\n\tv_pos = vec4(a_Position.xy - 2048.0, a_Info.x, 1.0);\n\n\t\n    v_flatNDCCoord = u_matrix * vec4(v_pos.xy, 0.0, 1.0);\n    \n    vec4 posInLightView = u_lightPVMatrix * u_modelMatrix *  vec4(v_pos.xyz, 1.0);\n\n\tgl_Position = posInLightView;\n}",f:"\nprecision mediump float;\n\nuniform float u_maskScale;\nuniform sampler2D u_maskSampler;\n\nvarying vec4 v_pos;\nvarying vec4 v_flatNDCCoord;\n\nvoid main(){ \n\tvec2 v_texCoord = (v_flatNDCCoord.xy / v_flatNDCCoord.w * u_maskScale + 1.0) / 2.0;\n\n\t\n\tvec4 maskColor = texture2D(u_maskSampler, v_texCoord);\n\tfloat isCulledByMask = maskColor.r;\n\tfloat alpha = 1.0;\n\tif(isCulledByMask > 0.99) {\n\t\tdiscard;\n\t}\n\tif(v_pos.x < -.17 || v_pos.y > .17 || v_pos.x > 256.0 || v_pos.y < -256.0){\n\t\tdiscard;\n\t}\n\n    gl_FragColor = vec4(1.0);\n}",name:"building-shadow"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(276),o="\nattribute vec2 a_Position;\nattribute vec4 a_Color;\nattribute vec4 a_Info;\nattribute vec4 a_Transform;\nattribute float a_Height;\nuniform mat4 u_matrix;\nuniform mat4 u_modelMatrix;\nuniform float u_use3D;\nvarying vec4 v_coord;\nvarying vec4 v_color;\nvarying vec2 v_Transform;\n"+i.LIGHT_UNIFORM+"\n"+i.LIGHT_VARYING+"\n"+i.LIGHT_VERTEX+"\n\nvoid main(){\n\tvec4 v_pos = vec4(a_Position.xy - 2048.0, mix(0.0, a_Height, u_use3D), 1.0);\n\tvec3 a_normal = normalize(vec3(a_Info.xyz-128.0));\n\n\t\n\tv_color = vec4(float(a_Color.r), float(a_Color.g), float(a_Color.b), float(a_Color.a)) / 255.0;\n\tvec2 objSpec = vec2(0.5, 32.0);\n\tlighting_apply_on_vertex(v_pos.xyz, a_normal, u_modelMatrix, objSpec);\n\n\t\n\tvec4 v_flatNDCCoord = u_matrix * vec4(v_pos.xy, 0.0, 1.0);\n\tv_coord = vec4(v_pos.xy, v_flatNDCCoord.xy / v_flatNDCCoord.w);\n\tv_Transform = a_Transform.xy;\n\n\tgl_Position = u_matrix * v_pos;\n}",r="\nprecision mediump float;\n\nuniform float u_maskScale;\nuniform sampler2D u_maskSampler;\n\nvarying vec4 v_coord;\nvarying vec4 v_color;\nvarying vec2 v_Transform;\n\n"+i.LIGHT_VARYING+"\n"+i.LIGHT_FRAG+"\n\nvoid main(){ \n\tvec2 v_texCoord = (v_coord.zw * u_maskScale + 1.0) / 2.0;\n\n\t\n\tvec4 maskColor = texture2D(u_maskSampler, v_texCoord);\n\tfloat isCulledByMask = maskColor.r;\n\t\n\t\n\tif(isCulledByMask > 0.99) {\n\t\tdiscard;\n\t}\n\n\t\n\tvec2 transformRound = floor(v_Transform + 0.5);\n\tvec2 translate = vec2(fract(transformRound.x / 16.0) * 16.0, floor(transformRound.x / 16.0));\n\tfloat scale = transformRound.y;\n\tvec2 coord = vec2(v_coord.x, - v_coord.y) * scale - translate * 256.0;\n\tbool isOutSide = coord.x < -.17 || coord.x > 256.0 || coord.y < -.17 || coord.y > 256.0;\n\t\n\tif(isOutSide){\n\t\t\n\t\tdiscard;\n\t}\n\n\tvec4 color = lighting_apply_on_color(v_color);\n\tgl_FragColor = vec4(color.rgb * color.a, color.a);\n}";e.default={v:o,f:r,name:"building"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.gradientNoise="\n\nvec2 random(vec2 p) {\n\treturn -1.0 + 2.0 * fract(\n            sin(\n                vec2(\n                    dot(p, vec2(127.1, 311.7)),\n                    dot(p, vec2(269.5, 183.3))\n                )\n            ) * 43758.5453123\n        );\n}\n\n\nfloat noise(vec2 p) {\n\n    vec2 i = floor(p);\n    vec2 f = fract(p);\n\n\n    float a1 = dot(random(i), f);\n    float a2 = dot(random(i + vec2(1., 0.)), f + vec2(-1., 0.));\n    float a3 = dot(random(i + vec2(1., 1.)), f + vec2(-1., -1.));\n    float a4 = dot(random(i + vec2(0., 1.)), f + vec2(0., -1.));\n\n\n    vec2 w = smoothstep(0., 1., f);\n    return mix(\n        mix(a1, a2, w.x),\n        mix(a4, a3, w.x),\n        w.y\n    );\n}\n\nconst int FBM_NUM = 5;\nconst float FREQ = 2.;\nfloat fbm(vec2 p, vec2 cellScale) {\n    float f = 0.0;\n    float a = 1.0;\n    p *= cellScale;\n\n    for (int i = 0; i < FBM_NUM; i++) {\n        f += a * noise(p);\n        p *= FREQ;\n        a /= FREQ;\n    }\n    return f;\n}\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(589),o=n(330),r=function(t){return t&&t.__esModule?t:{default:t}}(o),a=r.default?"\n\nfloat edgeY = (uFogEdge.x + 1.) / 2.;\nfloat x = fract((vPosition.x * uViewInfo.y + uViewInfo.x) / 2. / PI);\nvec2 skyCoord = vec2(\n\tgetCoordByDisplay(x, uSkyInfo.x * uViewInfo.y / PI, uSkyInfo.z),\n\tgetCoordByDisplay((texCoord.y - edgeY) / (1.0 - edgeY), uSkyInfo.y / (1.0 - edgeY), uSkyInfo.w)\n);\nvec4 skyColor = mix(\n\tuSkyColor,\n\ttexture2D(uSkySampler, skyCoord),\n\tstep(0.001, uSkyInfo.x * uSkyInfo.y)\n);\n\n\nvec2 p = vec2(texCoord.x - uViewInfo.w + uViewInfo.x / uViewInfo.y / 2., texCoord.y - edgeY);\nfloat mask = smoothstep(0., 0.5, p.y);\nfloat n = mix(\n\t0.,\n\tmax(0., fbm(p, vec2(2., 4.)) * mask),\n\tuViewInfo.z\n);\nvec4 skyWithCloud = vec4(mix(skyColor.rgb, vec3(1.0), n) * uSkyBrightness, skyColor.a);\n":"vec4 skyWithCloud = uSkyColor;",s="\n#define SHADER_NAME FogShader-fragment-shader\nprecision highp float;\n\nconst float PI = 3.141592653589793;\n\n\nuniform vec2 uRange;\n\n\nuniform vec3 uFogEdge;\n\nuniform sampler2D uSampler;\nuniform sampler2D uDepthSampler;\nuniform sampler2D uSkySampler;\nuniform vec4 uSkyInfo;\nuniform vec4 uViewInfo;\nuniform float uSkyBrightness;\nuniform vec4 uFogColor;\nuniform vec4 uSkyColor;\n\nvarying vec2 vPosition;\n\nfloat LinearizeDepth(float depth) {\n    float near = 0.1;\n    float far = 100.0;\n    float z = depth * 2.0 - 1.0;\n    return (2.0 * near) / (far + near - z * (far - near));\n}\n\nfloat getDepthFromY(float y) {\n\t\n\treturn min(uFogEdge.z + (uFogEdge.y - uFogEdge.z) * y / uFogEdge.x, 1.);\n}\n\nfloat getCoordByDisplay(float value, float max, float displayType) {\n\t\n\treturn mix(\n\t\tvalue / max,\n\t\tmix(\n\t\t\tvalue,\n\t\t\tfract(value / max),\n\t\t\tstep(2.0, displayType)\n\t\t),\n\t\tstep(1.0, displayType)\n\t);\n}\n\n"+i.gradientNoise+"\n\nvoid main() {\n\tvec2 texCoord = (vPosition + vec2(1.0)) / 2.0;\n\n\t\n\tfloat depth = texture2D(uDepthSampler, texCoord).x;\n\n\t\n\tdepth = min(getDepthFromY(vPosition.y), depth);\n\t\n\n\t\n\tfloat fogFactor = mix(\n\t\tsmoothstep(getDepthFromY(uFogEdge.x - uRange.x), uFogEdge.y, depth),\n\t\t1. - smoothstep(uFogEdge.y, getDepthFromY(uFogEdge.x + uRange.y), depth),\n\t\tstep(uFogEdge.y, depth)\n\t);\n\n\t\n\t\n\tvec4 sceneColor = vec4(0.);\n\n\t"+a+"\n\t\n\t\n\tvec4 bgColor = mix(sceneColor, skyWithCloud, step(uFogEdge.y, depth));\n\n\t\n\t\n\tvec4 blendColor = mix(bgColor, uFogColor, fogFactor);\n\t\n\t\n\t\n\n\tgl_FragColor = mix(\n\t\tblendColor,\n\t\tsceneColor,\n\t\tfloat(vPosition.y < uFogEdge.x - uRange.x)\n\t);\n}\n";e.default={v:"\n#define SHADER_NAME FogShader-vertex-shader\nattribute vec2 aClipSpacePosition;\nvarying vec2 vPosition;\n\n\nuniform vec2 uRange;\n\nuniform vec3 uFogEdge;\n\nvoid main() {\n\tfloat bottom = uFogEdge.x - uRange.x;\n\tfloat y = mix(\n\t\tbottom,\n\t\taClipSpacePosition.y,\n\t\tstep(0., aClipSpacePosition.y)\n\t);\n\tvPosition = vec2(aClipSpacePosition.x, y);\n\t\n\tgl_Position = vec4(vPosition, 1.0, 1.0);\n}\n",f:s,name:"fog"}},function(t,e,n){"use strict";function i(t){return{v:"\n\t#define SHADER_NAME FXAA3Shader-vertex-shader\n\tattribute vec2 aClipSpacePosition;\n\n\tvoid main() {\n\tgl_Position = vec4(aClipSpacePosition, 1.0, 1.0);\n\t}\n\t",f:"\n\t#define SHADER_NAME FXAA3Shader-fragment-shader\n\tprecision highp float;\n\n\t"+(0,o.getFxaaFunPart)(t)+"\n\n\n\tuniform vec2 uResolution;\n\tuniform sampler2D uSampler;\n\tuniform bool uEnabled;\n\n\tconst float fxaaQualitySubpix = 0.5;\n\tconst float fxaaQualityEdgeThreshold = 0.125;\n\tconst float fxaaQualityEdgeThresholdMin = 0.0833;\n\n\tvoid main()\n\t{\n\t\tvec2 v_textureCoordinates = vec2(gl_FragCoord.xy / uResolution.xy);\n\t\tvec2 fxaaQualityRcpFrame = vec2(1.0) / uResolution.xy;\n\t\tvec4 color = texture2D(uSampler, v_textureCoordinates);\n\n\t\tcolor.rgb = mix(color.rgb,\n\t\tFxaaPixelShader(\n\t\t\tv_textureCoordinates,\n\t\t\tuSampler,\n\t\t\tfxaaQualityRcpFrame,\n\t\t\tfxaaQualitySubpix,\n\t\t\tfxaaQualityEdgeThreshold,\n\t\t\tfxaaQualityEdgeThresholdMin\n\t\t).rgb,\n\t\tfloat(uEnabled)\n\t\t);\n\t\tgl_FragColor = color;\n\t}",name:"fxaa3"}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var o=n(592)},function(t,e,n){"use strict";/**